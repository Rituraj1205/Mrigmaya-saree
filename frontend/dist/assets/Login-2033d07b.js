import{r as i,A as D,u as V,i as g,j as e,d as z,z as l,b as U}from"./index-2b1cb77c.js";import{B as $}from"./BrandLoader-39102ee5.js";const B=`${z}/auth/google`,F=(s,r="")=>U(s,r),d={OTP:"otp",PASSWORD:"password",REGISTER:"register"},M=({mode:s,setMode:r,tabs:f})=>e.jsx("div",{className:"flex flex-wrap gap-3",children:f.map(u=>e.jsx("button",{type:"button",onClick:()=>r(u.key),className:`px-4 py-2 rounded-full text-sm font-semibold transition-all border ${s===u.key?"bg-[var(--primary)] text-[var(--surface)] border-transparent shadow":"bg-[var(--surface)]/80 text-[var(--muted)] border-[var(--border)]"}`,children:u.label},u.key))}),x=s=>e.jsx("input",{...s,className:`w-full rounded-2xl border border-[var(--border)] bg-[var(--surface)]/80 px-4 py-3 text-[var(--ink)] placeholder-[var(--muted)] focus:outline-none focus:ring-2 focus:ring-[var(--primary)]/60 ${s.className||""}`}),O=({item:s})=>{const r=F((s==null?void 0:s.image)||"","");return!s||!r?null:e.jsxs("div",{className:"hidden md:block rounded-3xl overflow-hidden glass-panel border border-[var(--border)] shadow-2xl relative h-[320px] w-[220px] flex-shrink-0",style:{backgroundImage:`linear-gradient(160deg, rgba(0,0,0,0.5), rgba(0,0,0,0.25)), url(${r})`,backgroundSize:"cover",backgroundPosition:"center"},children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/65 via-transparent to-transparent"}),e.jsxs("div",{className:"absolute bottom-4 left-4 right-4 text-white space-y-1",children:[e.jsx("p",{className:"text-sm uppercase tracking-[0.3em] text-white/70",children:s.subtitle}),e.jsx("p",{className:"text-lg font-semibold",children:s.title})]})]})};function J(){const{login:s}=i.useContext(D),[r,f]=i.useState(d.OTP),[u,b]=i.useState(1),[h,j]=i.useState(""),[v,T]=i.useState(""),[N,S]=i.useState(""),[c,P]=i.useState(""),[k,C]=i.useState(""),[w,R]=i.useState([{title:"",subtitle:"",image:""},{title:"",subtitle:"",image:""}]),E=V();i.useEffect(()=>{b(1),S("")},[r]),i.useEffect(()=>{g.get("/home-sections").then(t=>{const n=(t.data||[]).filter(o=>{var a;return o.group==="custom"&&((a=o.meta)==null?void 0:a.loginSlot)!==void 0&&o.active!==!1}).sort((o,a)=>{var p,m;return(((p=o.meta)==null?void 0:p.loginSlot)??0)-(((m=a.meta)==null?void 0:m.loginSlot)??0)});if(n.length){const o=[0,1].map(a=>n.find(p=>{var m;return Number((m=p.meta)==null?void 0:m.loginSlot)===a})||{});R(a=>o.map((p,m)=>({...a[m],...p})))}}).catch(()=>{})},[]);const y=()=>{const t=h.trim();return!t||!t.includes("@")?(l.error("Please enter a valid email"),null):t},A=async()=>{var n,o;const t=y();if(t)try{if(r===d.REGISTER){if(!v.trim())return l.error("Please enter your name");if(!c)return l.error("Please set a password");if(c.length<6)return l.error("Password must be at least 6 characters");if(c!==k)return l.error("Passwords do not match");await g.post("/auth/register",{email:t,name:v.trim(),password:c})}else await g.post("/auth/send-otp",{email:t});l.success("OTP sent to your email (check inbox/spam)"),b(2)}catch(a){l.error(((o=(n=a.response)==null?void 0:n.data)==null?void 0:o.msg)||"Failed to send OTP")}},L=async()=>{var n,o;const t=y();if(t)try{const a=await g.post("/auth/verify-otp",{email:t,otp:N,name:v.trim()||void 0});s(a.data.token,a.data.user),l.success("Logged in"),E("/")}catch(a){l.error(((o=(n=a.response)==null?void 0:n.data)==null?void 0:o.msg)||"Invalid OTP")}},_=async()=>{var n,o;const t=y();if(t){if(!c)return l.error("Enter your password");try{const a=await g.post("/auth/login-password",{email:t,password:c});s(a.data.token,a.data.user),l.success("Logged in"),E("/")}catch(a){l.error(((o=(n=a.response)==null?void 0:n.data)==null?void 0:o.msg)||"Login failed")}}},G=[{key:d.OTP,label:"Login with OTP"},{key:d.PASSWORD,label:"Login with Password"},{key:d.REGISTER,label:"Create Account"}],I=w[0],W=w[1]||w[0];return e.jsxs("div",{className:"relative min-h-screen bg-gradient-to-br from-[var(--bg)] via-[var(--surface-muted)] to-[var(--bg)] text-[var(--ink)] overflow-hidden flex items-center justify-center px-4 py-12",children:[e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_15%_15%,rgba(127,31,109,0.16),transparent_40%)]"}),e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_80%_10%,rgba(43,140,127,0.14),transparent_45%)]"}),e.jsx("div",{className:"absolute -left-16 top-10 h-40 w-40 rounded-full bg-[var(--primary-soft)] blur-3xl opacity-70 brand-floating"}),e.jsx("div",{className:"absolute right-0 top-24 h-32 w-32 rounded-full bg-[var(--accent)] blur-3xl opacity-50 brand-floating"}),e.jsxs("div",{className:"relative w-full max-w-6xl flex items-center justify-center gap-6",children:[e.jsx(O,{item:I}),e.jsxs("div",{className:"relative w-full max-w-3xl glass-panel rounded-[32px] border border-[var(--border)] p-8 lg:p-10 shadow-2xl overflow-hidden",children:[e.jsx("div",{className:"absolute -right-16 -top-16 h-44 w-44 rounded-full bg-[var(--primary)]/18 blur-3xl brand-pulse"}),e.jsx("div",{className:"absolute left-6 top-8 h-20 w-20 rounded-full bg-[var(--accent)]/18 blur-3xl"}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center gap-6 text-center",children:[e.jsx($,{message:"Surat couture drapes"}),e.jsxs("div",{className:"w-full max-w-lg text-left",children:[e.jsx(M,{mode:r,setMode:f,tabs:G}),r===d.PASSWORD&&e.jsxs("div",{className:"space-y-3 mt-4",children:[e.jsx("p",{className:"text-sm text-[var(--muted)]",children:"Use your email and password."}),e.jsx(x,{type:"email",value:h,onChange:t=>j(t.target.value),placeholder:"you@example.com"}),e.jsx(x,{type:"password",value:c,onChange:t=>P(t.target.value),placeholder:"Password"}),e.jsx("button",{onClick:_,className:"w-full bg-gradient-to-r from-[var(--primary)] to-[var(--accent)] text-[var(--surface)] font-semibold rounded-2xl py-3 shadow-md hover:shadow-lg transition",children:"Login"})]}),r!==d.PASSWORD&&u===1&&e.jsxs("div",{className:"space-y-3 mt-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-[var(--ink)]",children:r===d.REGISTER?"Create account (Email OTP)":"Login with Email OTP"}),e.jsx("p",{className:"text-sm text-[var(--muted)]",children:"We will send a 6-digit code to your email."}),r===d.REGISTER&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(x,{type:"text",value:v,onChange:t=>T(t.target.value),placeholder:"Full name"}),e.jsx(x,{type:"password",value:c,onChange:t=>P(t.target.value),placeholder:"Create password"}),e.jsx(x,{type:"password",value:k,onChange:t=>C(t.target.value),placeholder:"Confirm password"})]}),e.jsx(x,{type:"email",value:h,onChange:t=>j(t.target.value),placeholder:"you@example.com"}),e.jsx("button",{onClick:A,className:"w-full bg-gradient-to-r from-[var(--primary)] to-[var(--accent)] text-[var(--surface)] font-semibold rounded-2xl py-3 shadow-md hover:shadow-lg transition",children:"Send OTP"})]}),r!==d.PASSWORD&&u===2&&e.jsxs("div",{className:"space-y-3 mt-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-[var(--ink)]",children:"Enter OTP"}),e.jsxs("p",{className:"text-sm text-[var(--muted)]",children:["OTP sent to ",h]}),e.jsx(x,{type:"text",value:N,onChange:t=>S(t.target.value),placeholder:"6-digit code"}),e.jsxs("button",{onClick:L,className:"w-full bg-gradient-to-r from-[var(--primary)] to-[var(--accent)] text-[var(--surface)] font-semibold rounded-2xl py-3 shadow-md hover:shadow-lg transition",children:["Verify & ",r===d.REGISTER?"Create account":"Login"]}),e.jsx("button",{onClick:()=>b(1),className:"text-sm text-[var(--primary)] mt-3 underline",type:"button",children:"Change email"})]}),e.jsxs("div",{className:"pt-4 border-t border-[var(--border)] space-y-2",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-[var(--muted)]",children:"Or"}),e.jsx("a",{href:B,className:"w-full inline-flex items-center justify-center gap-2 rounded-full border border-[var(--border)] bg-white/80 px-4 py-3 text-sm font-semibold text-gray-800 hover:shadow transition",children:"Sign in with Google"}),e.jsx("p",{className:"text-xs text-[var(--muted)]",children:"Use a Google account listed as a Test user on the OAuth consent screen."})]})]})]})]}),e.jsx(O,{item:W})]})]})}export{J as default};
