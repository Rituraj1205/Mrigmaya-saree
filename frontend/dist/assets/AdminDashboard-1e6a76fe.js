import{r as u,A as bt,u as vt,z as i,i as c,j as e,b as Nt}from"./index-2b1cb77c.js";const E=l=>Nt(l,""),Ae=(l="")=>{const f=l.split("?")[0].toLowerCase();return/\.(mp4|webm|ogg)$/.test(f)},xe={name:"",description:"",category:"",categoryRef:"",fabric:"",color:"",amazonLink:"",flipkartLink:"",price:"",discountPrice:"",stock:"",images:"",video:"",collectionIds:[]},De={title:"",slug:"",subtitle:"",description:"",ctaLabel:"",heroImage:"",accentColor:"#c1275a",displayOnHome:!0,priority:999},wt=[{value:"processing",label:"Processing"},{value:"packed",label:"Packed"},{value:"shipped",label:"Shipped"},{value:"delivered",label:"Delivered"},{value:"cancelled",label:"Cancelled"}],Ct=[{value:"cod_pending",label:"Awaiting COD"},{value:"awaiting_upi",label:"Awaiting UPI"},{value:"awaiting_gateway",label:"Awaiting gateway"},{value:"paid",label:"Paid"},{value:"cancelled",label:"Cancelled"}];function Dt(){const{token:l,user:f,logout:F}=u.useContext(bt),U=vt(),[k,y]=u.useState([]),[N,L]=u.useState([]),[A,$]=u.useState([]),[o,j]=u.useState(xe),[d,b]=u.useState([]),[C,D]=u.useState([]),[z,p]=u.useState(!1),[h,H]=u.useState(null),[w,M]=u.useState(De),[T,ee]=u.useState([]),[q,ue]=u.useState([{_id:null,title:"",subtitle:"",image:""},{_id:null,title:"",subtitle:"",image:""}]),[me,Pe]=u.useState([]),[v,B]=u.useState({code:"",discountType:"flat",value:"",maxDiscount:"",maxRedemptions:1,expiresAt:"",minOrderValue:"",active:!0}),[oe,pe]=u.useState(""),[Ue,te]=u.useState(!1),[$e,he]=u.useState(!1),[P,R]=u.useState({title:"",subtitle:"",tag:"",ctaLabel:"",ctaLink:"/products",image:"",order:1,active:!0,productIds:[]}),[Q,ge]=u.useState(null),[Me,se]=u.useState(!1),[ye,Re]=u.useState([]),[ae,Fe]=u.useState([]),fe=u.useMemo(()=>ae.filter(t=>t.returnRequested||t.returnStatus&&t.returnStatus!=="none"),[ae]),K=u.useMemo(()=>(o.images||"").split(/[\n,]/).map(t=>t.trim()).filter(Boolean),[o.images]),[V,Oe]=u.useState("collections"),He=[{id:"collections",label:"Collections"},{id:"products",label:"Products"},{id:"coupons",label:"Coupons"},{id:"homepage",label:"Homepage Slider"},{id:"orders",label:"Orders"},{id:"returns",label:"Returns"},{id:"login-visuals",label:"Login visuals"}],g=u.useMemo(()=>({headers:{Authorization:`Bearer ${l||localStorage.getItem("token")||""}`}}),[l]),W=t=>{Re(s=>[{message:t,ts:new Date().toISOString()},...s].slice(0,15))},je=(t,s=2)=>{var r;if(!t)return!1;if(!((r=t.type)!=null&&r.startsWith("image/")))return i.error("Please upload an image file"),!1;const a=s*1024*1024;return t.size>a?(i.error(`Image too large. Max ${s}MB allowed.`),!1):!0},Te=(t,s=20)=>{var x,m;if(!t)return!1;const a=(x=t.type)==null?void 0:x.startsWith("image/"),r=(m=t.type)==null?void 0:m.startsWith("video/");if(!a&&!r)return i.error("Upload an image or video"),!1;const n=s*1024*1024;return t.size>n?(i.error(`File too large. Max ${s}MB allowed.`),!1):!0},Be=t=>{const s=(t==null?void 0:t.shippingAddress)||{},a=[s.name,s.phone||t.customerContact,s.line1,s.line2,[s.city,s.state].filter(Boolean).join(", "),s.pincode].filter(Boolean);return a.length===0?"No address":a.join(" | ")};u.useEffect(()=>{if(!l){U("/admin/login");return}(f==null?void 0:f.role)!=="admin"&&(i.error("Admin access only"),U("/"))},[l,f,U]),u.useEffect(()=>{l&&(X(),J(),_(),Ee(),re(),le())},[l]),u.useEffect(()=>{_()},[]);const X=async()=>{try{const t=await c.get("/products?includeInactive=true");y(t.data)}catch(t){console.error(t)}},J=async()=>{try{const t=await c.get("/collections?includeProducts=true");L(t.data)}catch(t){console.error(t)}},Ee=async()=>{if(l)try{const t=await c.get("/categories/all",g);$(t.data||[])}catch(t){console.error(t)}},re=async()=>{if(l)try{const t=await c.get("/coupons",g);Pe(t.data||[])}catch(t){console.error(t)}},le=async()=>{if(l)try{const s=(await c.get("/orders",g)).data||{};Fe(Array.isArray(s.orders)?s.orders:Array.isArray(s)?s:[])}catch(t){console.error(t)}},Ve=async t=>{try{const s=await c.get(`/orders/${t}/invoice`,{...g,responseType:"blob"}),a=new Blob([s.data],{type:"application/pdf"}),r=window.URL.createObjectURL(a),n=document.createElement("a");n.href=r,n.download=`invoice-${t.slice(-6)}.pdf`,document.body.appendChild(n),n.click(),n.remove(),window.URL.revokeObjectURL(r)}catch(s){console.error(s),i.error("Could not download invoice")}},_=async()=>{var t;try{const s=await c.get("/home-sections?includeInactive=true");ee(s.data)}catch(s){console.error("Home sections fetch failed",((t=s==null?void 0:s.response)==null?void 0:t.data)||s.message),i.error("Could not load homepage cards")}},I=u.useMemo(()=>[...T.filter(t=>t.group==="hero")].sort((t,s)=>(t.order??0)-(s.order??0)),[T]),be=u.useMemo(()=>I.length?Math.max(...I.map(t=>t.order??0)):0,[I]);u.useEffect(()=>{const t=[...T.filter(a=>{var r;return a.group==="custom"&&((r=a.meta)==null?void 0:r.loginSlot)!==void 0})].sort((a,r)=>{var n,x;return(((n=a.meta)==null?void 0:n.loginSlot)??0)-(((x=r.meta)==null?void 0:x.loginSlot)??0)}),s=[0,1].map(a=>{const r=t.find(n=>{var x;return Number((x=n.meta)==null?void 0:x.loginSlot)===a});return{_id:(r==null?void 0:r._id)||null,title:(r==null?void 0:r.title)||"",subtitle:(r==null?void 0:r.subtitle)||"",image:(r==null?void 0:r.image)||""}});ue(s)},[T]);const ne=(t,s,a)=>{ue(r=>{const n=[...r];return n[t]={...n[t],[s]:a},n})},ze=async()=>{try{await Promise.all(q.map(async(s,a)=>{const r={group:"custom",title:s.title,subtitle:s.subtitle,image:s.image,order:a,active:!0,meta:{...s.meta||{},loginSlot:a}};if(s._id){if(!s.image){await c.delete(`/home-sections/${s._id}`,g);return}await c.put(`/home-sections/${s._id}`,r,g)}else s.image&&await c.post("/home-sections",r,g)}))&&(i.success("Login visuals saved"),_())}catch(t){console.error(t),i.error("Could not save visuals")}},Ge=async(t,s)=>{if(je(t)&&t){he(!0);try{const a=new FormData;a.append("file",t);const n=(await c.post("/uploads",a,{headers:{...g.headers,"Content-Type":"multipart/form-data"}})).data.url;ne(s,"image",n),i.success("Image uploaded")}catch(a){console.error(a),i.error("Upload failed")}finally{he(!1)}}},S=u.useMemo(()=>[...T.filter(t=>t.group==="category")].sort((t,s)=>(t.order??0)-(s.order??0)),[T]);u.useEffect(()=>{if(!h){b([]);return}const t=k.find(a=>a._id===h);if(!t)return;const s=S.filter(a=>{var n;return(((n=a.meta)==null?void 0:n.products)||a.productIds||[]).includes(t._id)}).map(a=>a._id);b(s)},[h,k,S]);const ve=async t=>{if(!je(t))return null;const s=new FormData;return s.append("file",t),(await c.post("/uploads",s,{headers:{Authorization:`Bearer ${l}`,"Content-Type":"multipart/form-data"}})).data.url},qe=async t=>{if(!Te(t,25))return null;const s=new FormData;return s.append("file",t),(await c.post("/uploads",s,{headers:{Authorization:`Bearer ${l}`,"Content-Type":"multipart/form-data"}})).data.url},ie=()=>{R({title:"",subtitle:"",tag:"",ctaLabel:"",ctaLink:"/products",image:"",order:1,active:!0,productIds:[]}),ge(null)},Ne=async(t,s)=>{await c.post("/home-sections",{group:"hero",...t,order:s,active:!0},g)},We=async()=>{if(!P.title.trim()){i.error("Enter a title");return}if(!P.image.trim()){i.error("Add an image");return}const t={...P,order:Number(P.order)||S.length+1,group:"category"};t.meta={...t.meta||{},products:P.productIds||[]};try{Q?(await c.put(`/home-sections/${Q}`,t,g),i.success("Card updated")):(await c.post("/home-sections",t,g),i.success("Card added")),ie(),_()}catch(s){console.error(s),i.error("Could not save card")}},Je=t=>{var s;ge(t._id),R({title:t.title||"",subtitle:t.subtitle||"",tag:t.tag||"",ctaLabel:t.ctaLabel||"",ctaLink:t.ctaLink||"/products",image:t.image||"",order:t.order??1,active:t.active!==!1,productIds:((s=t.meta)==null?void 0:s.products)||t.productIds||[]})},Qe=async t=>{if(window.confirm("Delete this card?"))try{await c.delete(`/home-sections/${t}`,g),i.success("Card deleted"),Q===t&&ie(),_()}catch(s){console.error(s),i.error("Could not delete card")}},we=async(t,s)=>{const a=S.findIndex(m=>m._id===t);if(a===-1)return;const r=s==="up"?a-1:a+1;if(r<0||r>=S.length)return;const n=S[a],x=S[r];try{await Promise.all([c.put(`/home-sections/${n._id}`,{order:x.order??r},g),c.put(`/home-sections/${x._id}`,{order:n.order??a},g)]),_()}catch(m){console.error(m),i.error("Could not reorder cards")}},Ke=async t=>{if(t)try{se(!0);const s=await ve(t);R(a=>({...a,image:s})),i.success("Image uploaded")}catch(s){console.error(s),i.error("Upload failed")}finally{se(!1)}},Xe=async(t,s)=>{var n;if(!s)return;const a=S.find(x=>x._id===t),r=((n=a==null?void 0:a.meta)==null?void 0:n.products)||(a==null?void 0:a.productIds)||[];if(!r.includes(s))try{await c.put(`/home-sections/${t}`,{meta:{...a.meta||{},products:[...r,s]}},g),_()}catch(x){console.error(x),i.error("Could not attach product")}},Ce=()=>{B({code:"",discountType:"flat",value:"",maxDiscount:"",maxRedemptions:1,expiresAt:"",active:!0})},Ye=async()=>{var t,s;if(!v.code.trim()||!v.value){i.error("Code and value are required");return}try{await c.post("/coupons",{...v,code:v.code.trim().toUpperCase(),value:Number(v.value),maxDiscount:v.maxDiscount?Number(v.maxDiscount):void 0,maxRedemptions:v.maxRedemptions?Number(v.maxRedemptions):1},g),i.success("Coupon saved"),Ce(),re()}catch(a){i.error(((s=(t=a.response)==null?void 0:t.data)==null?void 0:s.msg)||"Could not save coupon")}},Ze=async(t,s)=>{var _e,Se,Ie,Le;const a=S.find(O=>O._id===t),r=Array.isArray(s.images)&&s.images.length?s.images:[s.image||""],n=new FormData;n.append("name",s.name||"Custom item"),n.append("description",`Custom product for ${(a==null?void 0:a.title)||"edit"}`),n.append("category",(a==null?void 0:a.title)||"Custom"),n.append("price",Number(s.mrp||s.price||0));const x=Number(s.price||0),m=Number(s.mrp||0);m>x&&x>0&&(n.append("discountPrice",x),n.append("price",m)),n.append("stock",50),n.append("images",r.filter(Boolean).join(`
`));let G=s.productId;try{G=((_e=(await c.post("/products",n,{headers:{Authorization:`Bearer ${l}`,"Content-Type":"multipart/form-data"}})).data)==null?void 0:_e._id)||G,i.success("Product created & attached"),X()}catch(O){console.error("Custom product creation failed",O),i.error("Could not create product for this item");return}const de=((Se=a==null?void 0:a.meta)==null?void 0:Se.products)||(a==null?void 0:a.productIds)||[],jt=[...(((Ie=a==null?void 0:a.meta)==null?void 0:Ie.productsDetails)||[]).filter(O=>(O==null?void 0:O._id)!==G),{_id:G,name:s.name||"Custom item"}];try{await c.put(`/home-sections/${t}`,{meta:{...a.meta||{},products:[...new Set([...de,G])],productsDetails:jt,customProducts:((Le=a==null?void 0:a.meta)==null?void 0:Le.customProducts)||[]}},g),_()}catch(O){console.error(O),i.error("Could not attach product to this card")}},et=async(t,s)=>{var x;const a=S.find(m=>m._id===t),n=(((x=a==null?void 0:a.meta)==null?void 0:x.customProducts)||[]).filter((m,Z)=>Z!==s);try{await c.put(`/home-sections/${t}`,{meta:{...a.meta||{},customProducts:n}},g),_()}catch(m){console.error(m),i.error("Could not remove product")}},tt=async t=>{if(!t)return"";try{return se(!0),await ve(t)}catch(s){return console.error(s),i.error("Upload failed"),""}finally{se(!1)}},st=async(t,s)=>{var x;const a=S.find(m=>m._id===t),n=(((x=a==null?void 0:a.meta)==null?void 0:x.products)||(a==null?void 0:a.productIds)||[]).filter(m=>m!==s);try{await c.put(`/home-sections/${t}`,{meta:{...a.meta||{},products:n}},g),_()}catch(m){console.error(m),i.error("Could not remove product")}},at=async t=>{var s;if(t!=null&&t.length){te(!0);try{let a=be+1;for(const r of Array.from(t)){const n=await qe(r);if(!n)continue;const x=(s=r.type)!=null&&s.startsWith("video/")||Ae(n)?{video:n}:{image:n};await Ne(x,a),a+=1}i.success("Slides added"),W("Added hero slides via upload"),_()}catch(a){console.error(a),i.error("Could not upload slides")}finally{te(!1)}}},rt=async()=>{if(oe.trim()){te(!0);try{const t=oe.trim(),s=Ae(t)?{video:t}:{image:t};await Ne(s,be+1),pe(""),i.success("Slide added"),W("Added hero slide via link"),_()}catch(t){console.error(t),i.error("Could not save slide")}finally{te(!1)}}},lt=async(t,s)=>{try{await c.put(`/home-sections/${t}`,{active:s},g),W(`Slide ${s?"enabled":"disabled"}`),_()}catch(a){console.error(a),i.error("Could not update slide")}},nt=async t=>{if(window.confirm("Delete this slide?"))try{await c.delete(`/home-sections/${t}`,g),i.success("Slide removed"),W("Removed a hero slide"),_()}catch(s){console.error(s),i.error("Could not delete slide")}},ke=async(t,s)=>{const a=I.findIndex(m=>m._id===t);if(a===-1)return;const r=s==="up"?a-1:a+1;if(r<0||r>=I.length)return;const n=I[a],x=I[r];try{await Promise.all([c.put(`/home-sections/${n._id}`,{order:x.order??r},g),c.put(`/home-sections/${x._id}`,{order:n.order??a},g)]),W("Reordered hero slides"),_()}catch(m){console.error(m),i.error("Could not reorder slides")}},ot=async(t,s)=>{if(!t||!s||t===s)return;const a=I.findIndex(m=>m._id===t),r=I.findIndex(m=>m._id===s);if(a===-1||r===-1)return;const n=I[a],x=I[r];try{await Promise.all([c.put(`/home-sections/${n._id}`,{order:x.order??r},g),c.put(`/home-sections/${x._id}`,{order:n.order??a},g)]),W("Reordered hero slides (drag)"),_()}catch(m){console.error(m),i.error("Could not reorder slides")}},it=async(t,s=[])=>{const a=[];S.forEach(r=>{var Z;const n=((Z=r.meta)==null?void 0:Z.products)||r.productIds||[],x=n.includes(t),m=s.includes(r._id);if(m&&!x&&a.push(c.put(`/home-sections/${r._id}`,{meta:{...r.meta||{},products:[...n,t]}},g)),!m&&x){const G=n.filter(de=>de!==t);a.push(c.put(`/home-sections/${r._id}`,{meta:{...r.meta||{},products:G}},g))}}),a.length&&(await Promise.all(a),_())},ct=async()=>{var t,s,a;try{const r=new FormData;r.append("name",o.name),r.append("description",o.description),r.append("category",o.category),o.categoryRef&&r.append("categoryRef",o.categoryRef),r.append("fabric",o.fabric),r.append("color",o.color),r.append("price",o.price||0),o.discountPrice&&r.append("discountPrice",o.discountPrice),r.append("stock",o.stock||0),o.amazonLink&&r.append("amazonLink",o.amazonLink.trim()),o.flipkartLink&&r.append("flipkartLink",o.flipkartLink.trim()),r.append("images",o.images),o.video&&r.append("video",o.video),r.append("collections",o.collectionIds.join(",")),C.forEach(m=>r.append("images",m));const n={headers:{Authorization:`Bearer ${l}`,"Content-Type":"multipart/form-data"}};let x=h;h?(await c.put(`/products/${h}`,r,n),i.success("Product updated")):(x=((t=(await c.post("/products",r,n)).data)==null?void 0:t._id)||x,i.success("Product created")),x&&await it(x,d),j(xe),b([]),D([]),H(null),X(),J()}catch(r){console.error(r),i.error(((a=(s=r.response)==null?void 0:s.data)==null?void 0:a.msg)||"Failed to save product")}},dt=t=>{var a,r;H(t._id),D([]),j({name:t.name||"",description:t.description||"",category:t.category||"",categoryRef:((a=t.categoryRef)==null?void 0:a._id)||t.categoryRef||"",fabric:t.fabric||"",color:t.color||"",amazonLink:t.amazonLink||"",flipkartLink:t.flipkartLink||"",price:t.price||"",discountPrice:t.discountPrice||"",stock:t.stock||"",images:(t.images||[]).join(`
`),video:t.video||"",collectionIds:((r=t.collections)==null?void 0:r.map(n=>n._id||n))||[]});const s=S.filter(n=>{var m;return(((m=n.meta)==null?void 0:m.products)||n.productIds||[]).includes(t._id)}).map(n=>n._id);b(s)},xt=()=>{j(xe),b([]),D([]),H(null)},ut=async t=>{if(window.confirm("Delete this product?"))try{await c.delete(`/products/${t}`,g),i.success("Deleted"),X(),J()}catch{i.error("Failed to delete")}},mt=async()=>{var t,s;try{await c.post("/collections",w,g),i.success("Collection created"),M(De),J()}catch(a){i.error(((s=(t=a.response)==null?void 0:t.data)==null?void 0:s.msg)||"Failed to create collection")}},ce=async(t,s)=>{try{await c.put(`/collections/${t}`,s,g),i.success("Collection updated"),J()}catch{i.error("Update failed")}},pt=async t=>{if(window.confirm("Delete this collection?"))try{await c.delete(`/collections/${t}`,g),i.success("Collection removed"),J(),X()}catch{i.error("Could not delete")}},ht=async(t,s)=>{if(s)try{const a=new FormData;a.append("file",s);const r=await c.post("/uploads",a,{headers:{Authorization:`Bearer ${l}`,"Content-Type":"multipart/form-data"}});await ce(t,{heroImage:r.data.url}),i.success("Image uploaded")}catch(a){console.error(a),i.error("Upload failed")}},gt=async t=>{if(t)try{p(!0);const s=new FormData;s.append("file",t);const a=await c.post("/uploads",s,{headers:{Authorization:`Bearer ${l}`,"Content-Type":"multipart/form-data"}});j(r=>({...r,video:a.data.url})),i.success("Video uploaded")}catch(s){console.error(s),i.error("Video upload failed")}finally{p(!1)}},yt=async t=>{if(!t)return"";try{const s=new FormData;s.append("file",t);const a=await c.post("/uploads",s,{headers:{Authorization:`Bearer ${l}`,"Content-Type":"multipart/form-data"}});return i.success("Image uploaded"),a.data.url}catch(s){return console.error(s),i.error("Upload failed"),""}},Y=async(t,s)=>{var a,r;try{await c.patch(`/orders/${t}`,s,g),i.success("Order updated"),le()}catch(n){console.error(n),i.error(((r=(a=n.response)==null?void 0:a.data)==null?void 0:r.msg)||"Could not update order")}},ft=(t=[])=>t.map(s=>{var a;return(a=N.find(r=>r._id===s))==null?void 0:a.title}).filter(Boolean).join(", ");return!l||(f==null?void 0:f.role)!=="admin"?null:e.jsxs("div",{className:"admin-page min-h-screen bg-[var(--bg)]",children:[e.jsx("header",{className:"sticky top-0 z-30 bg-gradient-to-b from-[var(--surface)]/95 to-[var(--surface-muted)]/88 backdrop-blur border-b border-[var(--border)] shadow-[0_12px_40px_rgba(24,16,10,0.08)]",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-6 py-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-[var(--muted)]",children:"Admin"}),e.jsx("h1",{className:"text-xl font-semibold text-[var(--ink)]",children:"Mrigmaya Control Room"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-sm text-[var(--muted)]",children:["Logged in as ",f==null?void 0:f.mobile]}),e.jsx("button",{onClick:()=>{F(),U("/admin/login")},className:"pill-button secondary hover:-translate-y-0.5",children:"Logout"})]})]})}),e.jsxs("main",{className:"max-w-6xl mx-auto px-6 py-8 space-y-10 admin-main",children:[e.jsxs("section",{className:"card-shell p-6 admin-card admin-grid",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"Quick sections"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"What would you like to manage?"}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Pick a section below. Each panel only shows the tools needed for that part of the store."}),e.jsx("div",{className:"flex flex-wrap gap-3 mt-4",children:He.map(t=>e.jsx("button",{onClick:()=>Oe(t.id),className:`admin-tab px-4 py-2 rounded-full text-sm font-semibold border transition ${V===t.id?"bg-[var(--primary)] text-white border-[var(--primary)] shadow-sm":"border-[var(--border)] text-[var(--muted)] hover:border-[var(--primary)] hover:text-[var(--ink)]"}`,children:t.label},t.id))})]}),V==="coupons"&&e.jsxs("section",{className:"card-shell p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"Promotions"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Coupon generator"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Create one-time or limited-use coupon codes with flat or percent discounts."})]})}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Code"}),e.jsx("input",{value:v.code,onChange:t=>B({...v,code:t.target.value}),placeholder:"FIRST123",className:"border rounded-xl px-4 py-3 w-full"}),e.jsx("label",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Discount type"}),e.jsxs("select",{value:v.discountType,onChange:t=>B({...v,discountType:t.target.value}),className:"border rounded-xl px-4 py-3 w-full",children:[e.jsx("option",{value:"flat",children:"Flat amount (₹)"}),e.jsx("option",{value:"percent",children:"Percent (%)"})]}),e.jsx("label",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Value"}),e.jsx("input",{type:"number",min:"1",value:v.value,onChange:t=>B({...v,value:t.target.value}),placeholder:"e.g. 500 or 10",className:"border rounded-xl px-4 py-3 w-full"}),e.jsx("label",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Max discount (optional, for %)"}),e.jsx("input",{type:"number",min:"0",value:v.maxDiscount,onChange:t=>B({...v,maxDiscount:t.target.value}),placeholder:"Cap for percent coupons",className:"border rounded-xl px-4 py-3 w-full"}),e.jsx("label",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Min order value (optional)"}),e.jsx("input",{type:"number",min:"0",value:v.minOrderValue,onChange:t=>B({...v,minOrderValue:t.target.value}),placeholder:"Apply only above this amount",className:"border rounded-xl px-4 py-3 w-full"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Max redemptions (overall)"}),e.jsx("input",{type:"number",min:"1",value:v.maxRedemptions,onChange:t=>B({...v,maxRedemptions:t.target.value}),className:"border rounded-xl px-4 py-3 w-full"}),e.jsx("label",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Expires at (optional)"}),e.jsx("input",{type:"datetime-local",value:v.expiresAt,onChange:t=>B({...v,expiresAt:t.target.value}),className:"border rounded-xl px-4 py-3 w-full"}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx("input",{type:"checkbox",checked:v.active,onChange:t=>B({...v,active:t.target.checked})}),"Active"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:Ye,className:"bg-pink-600 text-white px-6 py-3 rounded-full",children:"Save coupon"}),e.jsx("button",{onClick:Ce,className:"border border-gray-200 text-gray-600 px-4 py-3 rounded-full",children:"Clear"})]})]})]}),e.jsx("div",{className:"mt-8 overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-500",children:[e.jsx("th",{className:"py-2",children:"Code"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Value"}),e.jsx("th",{children:"Min"}),e.jsx("th",{children:"Used"}),e.jsx("th",{children:"Expires"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsxs("tbody",{children:[me.map(t=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"py-2 font-semibold text-gray-900",children:t.code}),e.jsx("td",{children:t.discountType}),e.jsxs("td",{children:[t.discountType==="percent"?`${t.value}%`:`₹${t.value}`,t.maxDiscount?` (cap ₹${t.maxDiscount})`:""]}),e.jsxs("td",{children:["₹",t.minOrderValue||0]}),e.jsxs("td",{children:[t.redemptions||0," / ",t.maxRedemptions||1]}),e.jsx("td",{children:t.expiresAt?new Date(t.expiresAt).toLocaleString():"No expiry"}),e.jsx("td",{children:t.active?"Active":"Inactive"}),e.jsxs("td",{className:"space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>c.patch(`/coupons/${t._id}`,{active:!t.active},g).then(re).catch(()=>i.error("Update failed")),className:"text-xs text-pink-600",children:t.active?"Disable":"Enable"}),e.jsx("button",{type:"button",onClick:()=>window.confirm("Delete coupon?")&&c.delete(`/coupons/${t._id}`,g).then(re).catch(()=>i.error("Delete failed")),className:"text-xs text-red-500",children:"Delete"})]})]},t._id)),me.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"py-4 text-center text-gray-400",children:"No coupons yet"})})]})]})})]}),V==="orders"&&e.jsxs("section",{className:"bg-white rounded-3xl shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"Orders"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Recent orders"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Update payment or delivery status from one place."})]}),e.jsx("button",{onClick:le,className:"text-sm text-gray-500 underline",children:"Refresh"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-500",children:[e.jsx("th",{className:"py-2",children:"Order"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Shipping"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Payment"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Tracking"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[ae.map(t=>{var s,a;return e.jsxs("tr",{className:"border-t",children:[e.jsxs("td",{className:"py-2",children:[e.jsxs("p",{className:"font-semibold text-gray-900",children:["#",t._id.slice(-6).toUpperCase()]}),e.jsx("p",{className:"text-xs text-gray-400",children:new Date(t.createdAt).toLocaleString()}),e.jsxs("p",{className:"text-xs text-gray-500",children:[t.items.length," item(s)"]})]}),e.jsx("td",{className:"text-xs text-gray-600",children:((s=t.user)==null?void 0:s.mobile)||t.customerContact||"NA"}),e.jsxs("td",{className:"text-xs text-gray-600 max-w-xs",children:[e.jsx("p",{className:"font-semibold text-gray-900",children:((a=t.shippingAddress)==null?void 0:a.name)||"—"}),e.jsx("p",{className:"text-gray-500",children:Be(t)}),t.customerNote&&e.jsxs("p",{className:"text-[11px] text-gray-400 mt-1",children:["Note: ",t.customerNote]})]}),e.jsxs("td",{className:"font-semibold text-gray-900",children:["₹",new Intl.NumberFormat("en-IN").format(t.amount||0)]}),e.jsx("td",{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("span",{className:"text-xs uppercase tracking-wide text-gray-500",children:t.paymentMethod}),e.jsx("select",{className:"border rounded-lg px-2 py-1 text-xs",value:t.paymentStatus,onChange:r=>Y(t._id,{paymentStatus:r.target.value}),children:Ct.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))})]})}),e.jsx("td",{children:e.jsx("select",{className:"border rounded-lg px-2 py-1 text-xs",value:t.status,onChange:r=>Y(t._id,{status:r.target.value}),children:wt.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))})}),e.jsx("td",{className:"text-xs text-gray-600",children:e.jsxs("div",{className:"space-y-1",children:[(t.trackingLink||t.trackingNumber)&&e.jsx("a",{href:(t.trackingLink||t.trackingNumber||"").startsWith("http")?t.trackingLink||t.trackingNumber:void 0,target:"_blank",rel:"noreferrer",className:"text-[11px] text-pink-600 underline",children:"Open tracking"}),e.jsx("input",{type:"text",className:"border rounded-lg px-2 py-1 w-full",placeholder:"Paste tracking URL",defaultValue:t.trackingLink||"",onBlur:r=>Y(t._id,{trackingLink:r.target.value.trim()})}),!t.trackingLink&&t.trackingNumber&&e.jsxs("p",{className:"text-[11px] text-gray-500",children:["Current: ",t.trackingNumber]})]})}),e.jsxs("td",{className:"text-right space-y-2",children:[t.paymentMethod==="UPI"&&t.upiIntent&&e.jsx("a",{href:t.upiIntent,target:"_blank",rel:"noreferrer",className:"text-xs text-pink-600",children:"UPI link"}),e.jsx("button",{type:"button",onClick:()=>Ve(t._id),className:"block text-xs text-pink-600 underline",children:"Download bill"})]})]},t._id)}),ae.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"py-6 text-center text-gray-400",children:"No orders yet"})})]})]})})]}),V==="returns"&&e.jsxs("section",{className:"bg-white rounded-3xl shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"Returns"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Return requests"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Approve/reject and view photos sent by customers."})]}),e.jsx("button",{onClick:le,className:"text-sm text-gray-500 underline",children:"Refresh"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-500",children:[e.jsx("th",{className:"py-2",children:"Order"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Reason"}),e.jsx("th",{children:"Photos"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Note"})]})}),e.jsxs("tbody",{children:[fe.map(t=>{var s,a,r;return e.jsxs("tr",{className:"border-t",children:[e.jsxs("td",{className:"py-2",children:[e.jsxs("p",{className:"font-semibold text-gray-900",children:["#",t._id.slice(-6).toUpperCase()]}),e.jsx("p",{className:"text-xs text-gray-400",children:new Date(t.createdAt).toLocaleString()}),e.jsxs("p",{className:"text-xs text-gray-500",children:[t.items.length," item(s)"]})]}),e.jsxs("td",{className:"text-xs text-gray-600",children:[((s=t.user)==null?void 0:s.mobile)||t.customerContact||"NA",e.jsxs("div",{className:"text-gray-500",children:[(a=t.shippingAddress)==null?void 0:a.name," ",(r=t.shippingAddress)==null?void 0:r.phone]})]}),e.jsxs("td",{className:"text-xs text-gray-600 max-w-xs",children:[e.jsx("p",{className:"font-semibold text-gray-900",children:t.returnReason||"No reason"}),t.returnNote&&e.jsxs("p",{className:"text-gray-500",children:["Note: ",t.returnNote]})]}),e.jsx("td",{className:"text-xs text-gray-600",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[(t.returnImages||[]).map((n,x)=>{const m=E(n);return e.jsx("a",{href:m,target:"_blank",rel:"noreferrer",className:"block w-16 h-16 rounded-lg overflow-hidden border border-gray-200",children:e.jsx("img",{src:m,alt:"return",className:"w-full h-full object-cover"})},x)}),(t.returnImages||[]).length===0&&e.jsx("span",{children:"None"})]})}),e.jsx("td",{children:e.jsx("select",{className:"border rounded-lg px-2 py-1 text-xs",value:t.returnStatus||"none",onChange:n=>Y(t._id,{returnStatus:n.target.value}),children:["requested","approved","rejected","received","refunded"].map(n=>e.jsx("option",{value:n,children:n},n))})}),e.jsx("td",{className:"text-xs",children:e.jsx("textarea",{className:"border rounded-lg px-2 py-1 text-xs w-full",placeholder:"Return note",defaultValue:t.returnNote||"",onBlur:n=>Y(t._id,{returnNote:n.target.value})})})]},t._id)}),fe.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"py-6 text-center text-gray-400",children:"No return requests yet"})})]})]})})]}),V==="products"&&e.jsxs(e.Fragment,{children:[e.jsxs("section",{className:"bg-white rounded-3xl shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"Catalog"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:h?"Edit product":"Create product"})]}),h&&e.jsx("button",{onClick:xt,className:"text-sm text-gray-500 underline",children:"Cancel edit"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mt-6",children:[e.jsx("input",{value:o.name,onChange:t=>j({...o,name:t.target.value}),placeholder:"Product name",className:"border rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-pink-100"}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500",children:"Assign category"}),e.jsxs("select",{value:o.categoryRef,onChange:t=>j({...o,categoryRef:t.target.value}),className:"border rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-pink-100 w-full",children:[e.jsx("option",{value:"",children:"Select category"}),A.map(t=>e.jsx("option",{value:t._id,children:t.name},t._id))]})]}),e.jsx("input",{value:o.category,onChange:t=>j({...o,category:t.target.value}),placeholder:"Display label (ex. Banarasi, Poshaak)",className:"border rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-pink-100"}),e.jsx("input",{value:o.fabric,onChange:t=>j({...o,fabric:t.target.value}),placeholder:"Fabric",className:"border rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-pink-100"}),e.jsx("input",{value:o.color,onChange:t=>j({...o,color:t.target.value}),placeholder:"Color tone",className:"border rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-pink-100"}),e.jsx("input",{value:o.amazonLink,onChange:t=>j({...o,amazonLink:t.target.value}),placeholder:"Amazon product link (optional)",className:"border rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-pink-100",type:"url"}),e.jsx("input",{value:o.flipkartLink,onChange:t=>j({...o,flipkartLink:t.target.value}),placeholder:"Flipkart product link (optional)",className:"border rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-pink-100",type:"url"}),e.jsx("input",{value:o.price,onChange:t=>j({...o,price:t.target.value}),placeholder:"Price (MRP)",className:"border rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-pink-100",type:"number"}),e.jsx("input",{value:o.discountPrice,onChange:t=>j({...o,discountPrice:t.target.value}),placeholder:"Selling price",className:"border rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-pink-100",type:"number"}),e.jsx("input",{value:o.stock,onChange:t=>j({...o,stock:t.target.value}),placeholder:"Stock",className:"border rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-pink-100",type:"number"})]}),e.jsx("textarea",{value:o.description,onChange:t=>j({...o,description:t.target.value}),placeholder:"Description / story",className:"border rounded-2xl px-4 py-3 w-full mt-4 focus:outline-none focus:ring-2 focus:ring-pink-100",rows:3}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mt-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500",children:"Existing image URLs (one per line)"}),e.jsx("textarea",{value:o.images,onChange:t=>j({...o,images:t.target.value}),className:"border rounded-2xl px-4 py-3 w-full focus:outline-none focus:ring-2 focus:ring-pink-100",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500",children:"Upload new images (select multiple)"}),e.jsx("input",{type:"file",multiple:!0,onChange:t=>D(Array.from(t.target.files)),className:"border rounded-xl px-4 py-3 w-full"}),C.length>0&&e.jsxs("div",{className:"text-xs text-gray-500 mt-2 space-y-1",children:[e.jsxs("p",{children:[C.length," new file(s) selected"]}),e.jsxs("ul",{className:"list-disc list-inside space-y-0.5",children:[C.slice(0,4).map(t=>e.jsx("li",{children:t.name},t.name)),C.length>4&&e.jsxs("li",{children:["+",C.length-4," more"]})]})]}),K.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsxs("p",{className:"text-xs text-gray-500",children:["Currently attached (",K.length,")"]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[K.slice(0,8).map((t,s)=>e.jsx("div",{className:"w-12 h-12 rounded-lg overflow-hidden border border-gray-200 bg-gray-50",children:e.jsx("img",{src:E(t),alt:"",className:"w-full h-full object-cover"})},`${t}-${s}`)),K.length>8&&e.jsxs("span",{className:"text-xs text-gray-400",children:["+",K.length-8," more"]})]})]})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"text-sm text-gray-500",children:"Attach to homepage collections (Sarees / Suits / Gold / Best Seller)"}),e.jsx("select",{multiple:!0,value:o.collectionIds,onChange:t=>j({...o,collectionIds:Array.from(t.target.selectedOptions,s=>s.value)}),className:"border rounded-xl px-4 py-3 w-full focus:outline-none focus:ring-2 focus:ring-pink-100 h-40",children:N.map(t=>e.jsx("option",{value:t._id,children:t.title},t._id))}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2 text-xs",children:[N.map(t=>e.jsxs("button",{type:"button",className:"px-3 py-1 border border-gray-200 rounded-full",onClick:()=>j(s=>s.collectionIds.includes(t._id)?s:{...s,collectionIds:[...s.collectionIds,t._id]}),children:["Add to ",t.title]},`quick-${t._id}`)),o.collectionIds.length>0&&e.jsx("button",{type:"button",className:"px-3 py-1 border border-gray-200 rounded-full text-gray-500",onClick:()=>j(t=>({...t,collectionIds:[]})),children:"Clear selections"})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"text-sm text-gray-500",children:"Attach to mood cards (home tiles)"}),e.jsx("select",{multiple:!0,value:d,onChange:t=>b(Array.from(t.target.selectedOptions,s=>s.value)),className:"border rounded-xl px-4 py-3 w-full focus:outline-none focus:ring-2 focus:ring-pink-100 h-32",children:S.map(t=>e.jsxs("option",{value:t._id,children:[t.title||"Untitled"," ",t.tag?`(${t.tag})`:""]},t._id))}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2 text-xs",children:[S.map(t=>e.jsxs("button",{type:"button",className:"px-3 py-1 border border-gray-200 rounded-full",onClick:()=>b(s=>s.includes(t._id)?s:[...s,t._id]),children:["Add to ",t.title||"Mood"]},`quick-mood-${t._id}`)),d.length>0&&e.jsx("button",{type:"button",className:"px-3 py-1 border border-gray-200 rounded-full text-gray-500",onClick:()=>b([]),children:"Clear mood selection"})]})]}),e.jsx("div",{className:"grid md:grid-cols-2 gap-4 mt-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500",children:"Product video URL (optional)"}),e.jsx("input",{value:o.video,onChange:t=>j({...o,video:t.target.value}),placeholder:"https://... (mp4 / hosted link)",className:"border rounded-xl px-4 py-3 w-full focus:outline-none focus:ring-2 focus:ring-pink-100"}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("input",{type:"file",accept:"video/*",className:"text-sm",onChange:t=>{var s;return gt((s=t.target.files)==null?void 0:s[0])}}),z&&e.jsx("span",{className:"text-xs text-gray-400",children:"Uploading..."})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Paste a hosted link or upload to store on server."})]})}),e.jsx("button",{onClick:ct,className:"mt-6 bg-pink-600 text-white px-6 py-3 rounded-full",children:h?"Update product":"Create product"})]}),e.jsxs("section",{className:"bg-white rounded-3xl shadow p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"Live catalog"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Products"})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-500",children:[e.jsx("th",{className:"py-2",children:"Name"}),e.jsx("th",{children:"Price"}),e.jsx("th",{children:"Collections"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:k.map(t=>{var s;return e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"py-2",children:t.name}),e.jsx("td",{children:t.discountPrice||t.price}),e.jsx("td",{className:"text-xs text-gray-500",children:ft((s=t.collections)==null?void 0:s.map(a=>a._id||a))}),e.jsxs("td",{className:"text-right space-x-3",children:[e.jsx("button",{className:"text-pink-600",onClick:()=>dt(t),children:"Edit"}),e.jsx("button",{className:"text-gray-400",onClick:()=>ut(t._id),children:"Delete"})]})]},t._id)})})]})})]})]}),V==="collections"&&e.jsxs("section",{className:"bg-white rounded-3xl shadow p-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"Homepage sections"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Collection studio"})]})}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mt-6",children:[e.jsx("input",{value:w.title,onChange:t=>M({...w,title:t.target.value}),placeholder:"Title",className:"border rounded-xl px-4 py-3"}),e.jsx("input",{value:w.slug,onChange:t=>M({...w,slug:t.target.value}),placeholder:"Slug (unique)",className:"border rounded-xl px-4 py-3"}),e.jsx("input",{value:w.subtitle,onChange:t=>M({...w,subtitle:t.target.value}),placeholder:"Subtitle",className:"border rounded-xl px-4 py-3"}),e.jsx("input",{value:w.ctaLabel,onChange:t=>M({...w,ctaLabel:t.target.value}),placeholder:"CTA Label",className:"border rounded-xl px-4 py-3"}),e.jsx("input",{value:w.heroImage,onChange:t=>M({...w,heroImage:t.target.value}),placeholder:"Hero image URL",className:"border rounded-xl px-4 py-3"}),e.jsx("input",{value:w.accentColor,onChange:t=>M({...w,accentColor:t.target.value}),placeholder:"Accent color",className:"border rounded-xl px-4 py-3"}),e.jsx("input",{value:w.priority,type:"number",onChange:t=>M({...w,priority:Number(t.target.value)}),placeholder:"Priority (lower first)",className:"border rounded-xl px-4 py-3"}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx("input",{type:"checkbox",checked:w.displayOnHome,onChange:t=>M({...w,displayOnHome:t.target.checked})}),"Display on homepage"]})]}),e.jsx("textarea",{value:w.description,onChange:t=>M({...w,description:t.target.value}),placeholder:"Description",className:"border rounded-2xl px-4 py-3 w-full mt-4",rows:3}),e.jsx("button",{onClick:mt,className:"mt-4 bg-gray-900 text-white px-6 py-3 rounded-full",children:"Create collection"}),e.jsxs("div",{className:"mt-10 space-y-10 admin-collections",children:[N.length===0&&e.jsx("p",{className:"text-sm text-gray-500",children:"Create a collection to start building your home tiles."}),N.map(t=>e.jsxs("div",{className:"admin-collection-row",children:[e.jsx(St,{collection:t,onSave:s=>ce(t._id,s),onDelete:()=>pt(t._id),onHeroUpload:s=>ht(t._id,s),onGalleryUpload:s=>yt(s)}),e.jsx(It,{collection:t,products:k,onUpdate:s=>ce(t._id,{products:s})})]},t._id))]})]}),V==="homepage"&&e.jsxs("section",{className:"bg-white rounded-3xl shadow p-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"Homepage slider"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Hero image manager"}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Upload multiple hero images at once and they will rotate on the storefront automatically."})]}),e.jsxs("div",{className:"mt-6 border border-gray-100 rounded-2xl p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:"Upload photos / videos"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Select one or more images or MP4/WebM clips."}),e.jsx("input",{type:"file",multiple:!0,accept:"image/*,video/*",className:"mt-3 text-sm",onChange:t=>{at(t.target.files),t.target.value=""}})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:"Or paste an image / video link"}),e.jsxs("div",{className:"flex flex-col gap-2 md:flex-row mt-2",children:[e.jsx("input",{value:oe,onChange:t=>pe(t.target.value),placeholder:"https://example.com/hero.jpg or https://example.com/hero.mp4",className:"border rounded-xl px-4 py-2 text-sm flex-1"}),e.jsx("button",{onClick:rt,className:"px-4 py-2 rounded-xl bg-gray-900 text-white text-sm",children:"Add slide"})]})]}),Ue&&e.jsx("p",{className:"text-xs text-gray-400",children:"Uploading..."})]}),e.jsxs("div",{className:"mt-8",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"Slides"}),e.jsxs("h3",{className:"text-xl font-semibold text-gray-900",children:[I.length," slide",I.length===1?"":"s"]})]})}),I.length===0?e.jsx("p",{className:"text-sm text-gray-500 mt-4",children:"No slides yet. Upload images to get started."}):e.jsx("div",{className:"grid md:grid-cols-2 gap-4 mt-4",children:I.map((t,s)=>e.jsx(kt,{slide:t,index:s,isLast:s===I.length-1,onToggle:a=>lt(t._id,a),onDelete:()=>nt(t._id),onMoveUp:()=>ke(t._id,"up"),onMoveDown:()=>ke(t._id,"down"),onReorder:a=>ot(a,t._id)},t._id))})]}),ye.length>0&&e.jsxs("div",{className:"mt-6 bg-white border border-gray-100 rounded-2xl p-4 space-y-2",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Recent changes"}),e.jsx("ul",{className:"space-y-1 text-sm text-gray-700",children:ye.map((t,s)=>e.jsxs("li",{children:[e.jsx("span",{className:"text-gray-500 text-xs",children:new Date(t.ts).toLocaleTimeString()})," ",t.message]},`${t.ts}-${s}`))})]}),e.jsxs("div",{className:"mt-10 border-t pt-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"Featured edits"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Mood cards (home tiles)"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Add tiles like Saree / Suit / Jewellery. Set title, badge, link, and image."})]}),Q&&e.jsx("button",{onClick:ie,className:"text-sm text-gray-500 underline",children:"Cancel edit"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mt-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Title"}),e.jsx("input",{value:P.title,onChange:t=>R(s=>({...s,title:t.target.value})),className:"border rounded-xl px-3 py-2 w-full",placeholder:"Saree"}),e.jsx("label",{className:"text-sm text-gray-600",children:"Subtitle"}),e.jsx("input",{value:P.subtitle,onChange:t=>R(s=>({...s,subtitle:t.target.value})),className:"border rounded-xl px-3 py-2 w-full",placeholder:"Pure zari woven"}),e.jsx("label",{className:"text-sm text-gray-600",children:"Badge / tag"}),e.jsx("input",{value:P.tag,onChange:t=>R(s=>({...s,tag:t.target.value})),className:"border rounded-xl px-3 py-2 w-full",placeholder:"Bestseller / New"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm text-gray-600",children:"CTA label"}),e.jsx("input",{value:P.ctaLabel,onChange:t=>R(s=>({...s,ctaLabel:t.target.value})),className:"border rounded-xl px-3 py-2 w-full",placeholder:"Shop sarees >"}),e.jsx("label",{className:"text-sm text-gray-600",children:"CTA link"}),e.jsx("input",{value:P.ctaLink,onChange:t=>R(s=>({...s,ctaLink:t.target.value})),className:"border rounded-xl px-3 py-2 w-full",placeholder:"/products or /collection/sarees"}),e.jsx("label",{className:"text-sm text-gray-600",children:"Display order"}),e.jsx("input",{type:"number",value:P.order,onChange:t=>R(s=>({...s,order:Number(t.target.value)})),className:"border rounded-xl px-3 py-2 w-full"})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mt-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Image URL"}),e.jsx("input",{value:P.image,onChange:t=>R(s=>({...s,image:t.target.value})),className:"border rounded-xl px-3 py-2 w-full",placeholder:"https://..."}),e.jsx("input",{type:"file",accept:"image/*",className:"mt-2 text-sm",onChange:t=>{var s;return Ke((s=t.target.files)==null?void 0:s[0])}}),Me&&e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Uploading..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Attach products"}),e.jsxs("div",{className:"flex gap-2 mt-1",children:[e.jsxs("select",{className:"border rounded-xl px-3 py-2 text-sm flex-1",value:"",onChange:t=>{const s=t.target.value;s&&R(a=>a.productIds.includes(s)?a:{...a,productIds:[...a.productIds,s]})},children:[e.jsx("option",{value:"",children:"Choose product"}),k.map(t=>e.jsx("option",{value:t._id,children:t.name},t._id))]}),e.jsx("span",{className:"text-xs text-gray-500 self-center",children:"Pick items to show when opening this edit."})]}),P.productIds.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:P.productIds.map(t=>{const s=k.find(a=>a._id===t);return e.jsxs("span",{className:"px-3 py-1 rounded-full bg-gray-100 text-xs text-gray-700 flex items-center gap-2",children:[(s==null?void 0:s.name)||"Product",e.jsx("button",{type:"button",className:"text-gray-500",onClick:()=>R(a=>({...a,productIds:a.productIds.filter(r=>r!==t)})),children:"×"})]},t)})})]})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-6",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-700",children:[e.jsx("input",{type:"checkbox",checked:P.active,onChange:t=>R(s=>({...s,active:t.target.checked}))}),"Active"]}),e.jsx("button",{onClick:We,className:"px-5 py-3 bg-pink-600 text-white rounded-full text-sm font-semibold",children:Q?"Update card":"Save card"})]}),e.jsxs("div",{className:"mt-6 grid md:grid-cols-3 gap-3",children:[S.map((t,s)=>e.jsx(_t,{card:{...t,allProducts:k},index:s,isLast:s===S.length-1,onEdit:()=>Je(t),onDelete:()=>Qe(t._id),onToggle:a=>c.put(`/home-sections/${t._id}`,{active:a},g).then(_).catch(()=>i.error("Could not update card")),onMoveUp:()=>we(t._id,"up"),onMoveDown:()=>we(t._id,"down"),onAddProduct:a=>Xe(t._id,a),onDeleteProduct:a=>st(t._id,a),allProducts:k,onAddCustom:a=>Ze(t._id,a),onDeleteCustom:a=>et(t._id,a),onUploadCustom:tt},t._id)),S.length===0&&e.jsx("p",{className:"text-sm text-gray-500",children:"No mood cards yet. Add up to 3 tiles."})]})]})]}),V==="login-visuals"&&e.jsxs("section",{className:"bg-white rounded-3xl shadow p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"Login page"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Side visuals"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Update the left and right images shown on the login screen. Leave blank to hide."})]})}),e.jsx("div",{className:"grid md:grid-cols-2 gap-4 mt-4",children:q.map((t,s)=>e.jsxs("div",{className:"border border-gray-100 rounded-2xl p-4 space-y-3",children:[e.jsxs("p",{className:"text-sm font-semibold text-gray-800",children:["Visual ",s===0?"Left":"Right"]}),e.jsx("label",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Title"}),e.jsx("input",{value:t.title,onChange:a=>ne(s,"title",a.target.value),className:"border rounded-xl px-3 py-2 w-full",placeholder:"Sequin night"}),e.jsx("label",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Subtitle"}),e.jsx("input",{value:t.subtitle,onChange:a=>ne(s,"subtitle",a.target.value),className:"border rounded-xl px-3 py-2 w-full",placeholder:"Cocktail sarees"}),e.jsx("label",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Image URL"}),e.jsx("input",{value:t.image,onChange:a=>ne(s,"image",a.target.value),className:"border rounded-xl px-3 py-2 w-full",placeholder:"https://..."}),e.jsx("input",{type:"file",accept:"image/*",className:"text-sm",onChange:a=>{var n;const r=(n=a.target.files)==null?void 0:n[0];Ge(r,s),a.target.value=""}}),$e&&e.jsx("p",{className:"text-xs text-gray-400",children:"Uploading..."}),t.image&&e.jsx("div",{className:"mt-2 rounded-xl overflow-hidden h-32 bg-gray-100",children:e.jsx("img",{src:E(t.image),alt:t.title,className:"w-full h-full object-cover"})})]},s))}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx("button",{onClick:ze,className:"px-5 py-3 bg-pink-600 text-white rounded-full text-sm font-semibold",children:"Save visuals"})})]})]})]})}function kt({slide:l,index:f,isLast:F,onToggle:U,onDelete:k,onMoveUp:y,onMoveDown:N,onReorder:L}){var b;const A=E(l.video||l.heroVideo||((b=l.meta)==null?void 0:b.video)||""),$=E(l.image||l.heroImage||(Array.isArray(l.images)?l.images[0]:"")),o=A||$,j=l.active!==!1,d=!!A;return e.jsxs("div",{className:"border border-gray-200 rounded-2xl p-4 space-y-3 bg-white",draggable:!0,onDragStart:C=>C.dataTransfer.setData("text/plain",l._id),onDragOver:C=>C.preventDefault(),onDrop:C=>{C.preventDefault();const D=C.dataTransfer.getData("text/plain");D&&(L==null||L(D,l._id))},children:[e.jsx("div",{className:"rounded-xl overflow-hidden bg-gray-100 aspect-[16/9]",children:o?d?e.jsx("video",{src:o,poster:$||void 0,className:"w-full h-full object-cover",muted:!0,loop:!0,playsInline:!0,preload:"metadata"}):e.jsx("img",{src:o,alt:l.title||`Slide ${f+1}`,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-xs text-gray-400",children:"No media"})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:["Slide ",f+1]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Order ",l.order??f+1]})]}),o&&e.jsx("a",{href:o,target:"_blank",rel:"noreferrer",className:"text-xs text-pink-600",children:"View"})]}),d&&e.jsx("span",{className:"inline-block text-[11px] text-indigo-600 font-semibold",children:"Video slide"}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx("input",{type:"checkbox",checked:j,onChange:C=>U(C.target.checked)}),"Show on homepage"]}),(l.title||l.description)&&e.jsxs("div",{className:"text-xs text-gray-500",children:[l.title&&e.jsx("p",{className:"font-semibold",children:l.title}),l.description&&e.jsx("p",{children:l.description})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 text-sm",children:[e.jsx("button",{type:"button",onClick:y,disabled:f===0,className:`px-3 py-2 rounded-xl border ${f===0?"text-gray-300 border-gray-200 cursor-not-allowed":"text-gray-700 border-gray-300"}`,children:"Move up"}),e.jsx("button",{type:"button",onClick:N,disabled:F,className:`px-3 py-2 rounded-xl border ${F?"text-gray-300 border-gray-200 cursor-not-allowed":"text-gray-700 border-gray-300"}`,children:"Move down"}),e.jsx("button",{type:"button",onClick:k,className:"px-3 py-2 rounded-xl border border-red-200 text-red-600",children:"Delete"})]})]})}function _t({card:l,index:f,isLast:F,onEdit:U,onDelete:k,onToggle:y,onMoveUp:N,onMoveDown:L,onAddProduct:A,onDeleteProduct:$,onAddCustom:o,onDeleteCustom:j,onUploadCustom:d,allProducts:b}){var z,p;u.useState({name:"",price:"",mrp:"",image:"",images:[]});const C=l.active!==!1,D=((z=l.meta)==null?void 0:z.products)||l.productIds||[];return(p=l.meta)!=null&&p.customProducts,e.jsxs("div",{className:"border border-gray-200 rounded-2xl p-3 space-y-2 bg-white shadow-sm",children:[e.jsx("div",{className:"rounded-xl overflow-hidden bg-gray-100 aspect-[4/5]",children:l.image?e.jsx("img",{src:E(l.image),alt:l.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-xs text-gray-400",children:"No image"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs uppercase tracking-[0.3em] text-gray-400 flex items-center gap-2",children:[l.tag||"Mood"," ",e.jsx("span",{className:"text-gray-300",children:"·"})," Order ",l.order??f+1]}),e.jsx("p",{className:"text-base font-semibold text-gray-900",children:l.title||"Untitled"}),l.subtitle&&e.jsx("p",{className:"text-sm text-gray-500",children:l.subtitle}),D.length>0&&e.jsxs("p",{className:"text-[11px] text-gray-500",children:[D.length," product",D.length===1?"":"s"]}),l.ctaLabel&&e.jsxs("p",{className:"text-[11px] text-pink-600 mt-1",children:[l.ctaLabel," → ",l.ctaLink||"/products"]})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx("input",{type:"checkbox",checked:C,onChange:h=>y(h.target.checked)}),"Active"]}),e.jsxs("div",{className:"flex flex-wrap gap-2 text-sm",children:[e.jsx("button",{onClick:U,className:"px-3 py-2 rounded-xl border border-gray-300 text-gray-700",children:"Edit"}),e.jsx("button",{onClick:N,disabled:f===0,className:`px-3 py-2 rounded-xl border ${f===0?"text-gray-300 border-gray-200 cursor-not-allowed":"text-gray-700 border-gray-300"}`,children:"Up"}),e.jsx("button",{onClick:L,disabled:F,className:`px-3 py-2 rounded-xl border ${F?"text-gray-300 border-gray-200 cursor-not-allowed":"text-gray-700 border-gray-300"}`,children:"Down"}),e.jsx("button",{onClick:k,className:"px-3 py-2 rounded-xl border border-red-200 text-red-600",children:"Delete"})]}),e.jsxs("div",{className:"space-y-2 text-xs text-gray-600",children:[e.jsx("p",{className:"font-semibold",children:"Attached products"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[D.length===0&&e.jsx("span",{className:"text-gray-400",children:"None"}),D.map(h=>{var H,w,M,T,ee;return e.jsxs("span",{className:"px-3 py-1 rounded-full bg-gray-100 text-gray-700 flex items-center gap-2",children:[((w=(H=l.products)==null?void 0:H.find(q=>q._id===h))==null?void 0:w.name)||((ee=(T=(M=l.meta)==null?void 0:M.productsDetails)==null?void 0:T.find(q=>q._id===h))==null?void 0:ee.name)||h,e.jsx("button",{type:"button",className:"text-gray-500",onClick:()=>$(h),children:"×"})]},h)})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("select",{className:"border rounded-xl px-2 py-1 flex-1",value:"",onChange:h=>A(h.target.value),children:[e.jsx("option",{value:"",children:"Add product"}),(b||[]).map(h=>e.jsx("option",{value:h._id,children:h.name},h._id))]})})]})]})}function St({collection:l,onSave:f,onDelete:F,onHeroUpload:U,onGalleryUpload:k}){var z;const[y,N]=u.useState({title:l.title,subtitle:l.subtitle||"",description:l.description||"",ctaLabel:l.ctaLabel||"",heroImage:l.heroImage||"",accentColor:l.accentColor||"#c1275a",displayOnHome:l.displayOnHome,priority:l.priority}),[L,A]=u.useState(l.heroImages||[]),[$,o]=u.useState(""),[j,d]=u.useState(!1);u.useEffect(()=>{N({title:l.title,subtitle:l.subtitle||"",description:l.description||"",ctaLabel:l.ctaLabel||"",heroImage:l.heroImage||"",accentColor:l.accentColor||"#c1275a",displayOnHome:l.displayOnHome,priority:l.priority}),A(l.heroImages||[])},[l]);const b=()=>{$.trim()&&(A(p=>[...p,$.trim()]),o(""))},C=p=>{A(h=>h.filter((H,w)=>w!==p))},D=async p=>{if(p){d(!0);try{const h=await k(p);h&&A(H=>[...H,h])}finally{d(!1)}}};return e.jsx("div",{className:"border border-gray-200 rounded-2xl p-4",children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:l.title}),e.jsxs("span",{className:"text-xs text-gray-500",children:[((z=l.products)==null?void 0:z.length)||0," items linked"]})]}),e.jsx("input",{value:y.title,onChange:p=>N({...y,title:p.target.value}),placeholder:"Collection title",className:"border rounded-xl px-3 py-2 text-sm"}),e.jsx("input",{value:y.subtitle,onChange:p=>N({...y,subtitle:p.target.value}),placeholder:"Subtitle",className:"border rounded-xl px-3 py-2 text-sm"}),e.jsx("textarea",{value:y.description,onChange:p=>N({...y,description:p.target.value}),placeholder:"Description",className:"border rounded-xl px-3 py-2 text-sm",rows:2}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[e.jsx("input",{value:y.ctaLabel,onChange:p=>N({...y,ctaLabel:p.target.value}),placeholder:"CTA label",className:"border rounded-xl px-3 py-2 text-sm"}),e.jsxs("div",{children:[e.jsx("input",{value:y.heroImage,onChange:p=>N({...y,heroImage:p.target.value}),placeholder:"Hero image URL",className:"border rounded-xl px-3 py-2 text-sm w-full"}),e.jsx("input",{type:"file",className:"mt-2 text-sm",onChange:p=>{var h;return U((h=p.target.files)==null?void 0:h[0])}}),e.jsxs("div",{className:"flex gap-2 items-center mt-2",children:[e.jsx("button",{type:"button",onClick:()=>N(p=>({...p,heroImage:""})),className:"text-xs text-gray-500 underline",children:"Remove hero image"}),y.heroImage&&e.jsx("a",{href:y.heroImage,target:"_blank",rel:"noreferrer",className:"text-xs text-pink-600",children:"View"})]}),y.heroImage&&e.jsx("div",{className:"mt-2 rounded-xl overflow-hidden border bg-gray-50",children:e.jsx("img",{src:E(y.heroImage),alt:"Hero preview",className:"w-full h-48 object-cover"})})]})]}),e.jsxs("div",{className:"border border-gray-100 rounded-2xl p-3",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"Hero gallery"}),e.jsxs("div",{className:"flex flex-wrap gap-3 mt-3",children:[L.map((p,h)=>e.jsxs("div",{className:"w-16 h-16 rounded-xl overflow-hidden relative",children:[e.jsx("img",{src:E(p),alt:"gallery",className:"w-full h-full object-cover"}),e.jsx("button",{type:"button",onClick:()=>C(h),className:"absolute top-1 right-1 bg-black/60 text-white text-[10px] px-1 rounded",children:"✕"})]},`${p}-${h}`)),L.length===0&&e.jsx("p",{className:"text-xs text-gray-400",children:"No gallery images yet"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-3 mt-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{value:$,onChange:p=>o(p.target.value),placeholder:"Image URL",className:"border rounded-xl px-3 py-2 text-sm flex-1"}),e.jsx("button",{type:"button",onClick:b,className:"px-3 py-2 rounded-xl bg-gray-900 text-white text-sm",children:"Add"})]}),e.jsxs("div",{children:[e.jsx("input",{type:"file",className:"text-sm",onChange:p=>{var h;return D((h=p.target.files)==null?void 0:h[0])}}),j&&e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Uploading image..."})]})]})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-3",children:[e.jsx("input",{value:y.accentColor,onChange:p=>N({...y,accentColor:p.target.value}),placeholder:"#c1275a",className:"border rounded-xl px-3 py-2 text-sm"}),e.jsx("input",{type:"number",value:y.priority,onChange:p=>N({...y,priority:Number(p.target.value)}),placeholder:"Priority",className:"border rounded-xl px-3 py-2 text-sm"}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx("input",{type:"checkbox",checked:y.displayOnHome,onChange:p=>N({...y,displayOnHome:p.target.checked})}),"Show on home"]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("button",{onClick:()=>f({...y,heroImages:L}),className:"px-4 py-2 bg-gray-900 text-white rounded-full",children:"Save collection"}),e.jsx("button",{onClick:F,className:"text-gray-400",children:"Delete"})]})]})})}function It({collection:l,products:f,onUpdate:F}){const[U,k]=u.useState(""),[y,N]=u.useState(""),L=(l.products||[]).map(d=>typeof d=="string"?f.find(b=>b._id===d):d).filter(Boolean),A=L.map(d=>d._id),$=f.filter(d=>!A.includes(d._id)).filter(d=>{var b;return(b=d.name)==null?void 0:b.toLowerCase().includes(U.toLowerCase())});u.useEffect(()=>{k(""),N("")},[l==null?void 0:l._id]);const o=d=>{const b=A.filter(C=>C!==d);F(b)},j=()=>{if(!y)return;const d=[...A,y];F(d),N(""),k("")};return e.jsxs("div",{className:"border border-gray-100 rounded-3xl p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Linked products"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Attach items to this collection. They will appear on the homepage rail exactly in this order."}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"Add product"}),e.jsxs("div",{className:"flex flex-col gap-2 mt-2",children:[e.jsx("input",{value:U,onChange:d=>k(d.target.value),placeholder:"Search products",className:"border rounded-xl px-3 py-2 text-sm"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:y,onChange:d=>N(d.target.value),className:"border rounded-xl px-3 py-2 text-sm flex-1",children:[e.jsx("option",{value:"",children:"Choose product"}),$.slice(0,30).map(d=>e.jsx("option",{value:d._id,children:d.name},d._id))]}),e.jsx("button",{onClick:j,className:"px-4 py-2 rounded-xl bg-gray-900 text-white text-sm",children:"Add"})]}),$.length===0&&e.jsx("p",{className:"text-xs text-gray-400",children:"No more products match this search."})]})]}),e.jsxs("div",{className:"mt-6 space-y-3 max-h-[420px] overflow-y-auto pr-2",children:[L.length===0&&e.jsx("p",{className:"text-sm text-gray-400",children:"No products linked yet."}),L.map(d=>{var b;return e.jsxs("div",{className:"border border-gray-100 rounded-2xl p-3 flex items-center gap-3 bg-white",children:[e.jsx("div",{className:"w-16 h-16 rounded-xl overflow-hidden bg-gray-100 flex-shrink-0",children:e.jsx("img",{src:E((b=d.images)==null?void 0:b[0]),alt:d.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:d.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[(d.color||d.category)&&e.jsxs("span",{children:[d.color||d.category," • "]}),"Rs."," ",new Intl.NumberFormat("en-IN").format(d.discountPrice||d.price||0)]})]}),e.jsx("button",{onClick:()=>o(d._id),className:"text-xs text-gray-500",children:"Remove"})]},d._id)})]})]})}export{Dt as default};
