import{c as Q,r as n,C as q,A as J,u as X,i as L,j as e,b as E,z as ee}from"./index-1ccc8524.js";import{s as te}from"./seo-4fb2e452.js";const se="data:image/gif;base64,R0lGODlhAQABAAD/ACw=",f=i=>`Rs. ${new Intl.NumberFormat("en-IN",{maximumFractionDigits:0}).format(i||0)}`,j=i=>E(i,""),R=i=>{var m;const d=(m=i==null?void 0:i.images)==null?void 0:m[0];return d?j(d):se},ae=i=>E(i,"");function ie(){var _;const{id:i}=Q(),{addToCart:d}=n.useContext(q),{token:m}=n.useContext(J),x=X(),[s,w]=n.useState(null),[N,h]=n.useState(0),[u,v]=n.useState(!1),[B,O]=n.useState([]),[k,W]=n.useState([]),[T,C]=n.useState(!0),[P,A]=n.useState(""),[Z,p]=n.useState(!1),[S,c]=n.useState(1.2),[z,M]=n.useState("");if(n.useEffect(()=>{let t=!0;return C(!0),A(""),L.get(`/products/${i}`).then(a=>{var r;if(!t)return;w(a.data),h(0);const l=Array.isArray((r=a.data)==null?void 0:r.reviews)?a.data.reviews:[];W(l)}).catch(a=>{var l;console.error("Product fetch failed",((l=a==null?void 0:a.response)==null?void 0:l.data)||(a==null?void 0:a.message)),t&&(A("Product not found or unavailable right now."),w(null))}).finally(()=>t&&C(!1)),()=>{t=!1}},[i]),n.useEffect(()=>{L.get("/products").then(t=>{var l;const a=Array.isArray(t.data)?t.data:((l=t.data)==null?void 0:l.products)||[];O(a)}).catch(()=>{})},[]),n.useEffect(()=>{if(!s)return;const t=s.name||"Product",a=s.description||s.subtitle||"Discover handcrafted sarees and curated edits from Mrigmaya.";te({title:`${t} | Mrigmaya`,description:a,image:R(s)})},[s]),T)return e.jsx("div",{className:"p-6",children:"Loading..."});if(P)return e.jsxs("div",{className:"p-6 space-y-3",children:[e.jsx("p",{className:"text-red-600 font-semibold",children:P}),e.jsx("button",{className:"px-4 py-2 bg-gray-900 text-white rounded-full",onClick:()=>x("/products"),children:"Back to products"})]});if(!s)return e.jsxs("div",{className:"p-6 space-y-3",children:[e.jsx("p",{className:"text-gray-600",children:"Product not found."}),e.jsx("button",{className:"px-4 py-2 bg-gray-900 text-white rounded-full",onClick:()=>x("/products"),children:"Back to products"})]});const o=Array.isArray(s.images)&&s.images.length?s.images.map(t=>j(t)):[],b=o[N]||j((_=s.images)==null?void 0:_[0])||"",U=()=>h(t=>o.length?(t-1+o.length)%o.length:0),H=()=>h(t=>o.length?(t+1)%o.length:0),V=s.discountPrice||s.price,D=s.discountPrice&&s.price,$=D?Math.round((s.price-s.discountPrice)/s.price*100):null,g=k.length>0?k:[{author:"Happy customer",rating:5,comment:"Loved the drape and finish. Would buy again.",date:new Date().toISOString()}],Y=g.reduce((t,a)=>t+(Number(a.rating)||0),0)/(g.length||1),G="data:image/svg+xml;utf8,"+encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200" aria-label="Flipkart logo"><rect x="24" y="28" width="152" height="144" rx="16" fill="#ffd426"/><path d="M46 52h108c5 0 9 4 9 9v13H37V61c0-5 4-9 9-9z" fill="#fbc02d"/><path d="M62 64c12 16 32 16 44 0" fill="none" stroke="#e53935" stroke-width="6" stroke-linecap="round"/><path d="M106 64c12 16 32 16 44 0" fill="none" stroke="#00897b" stroke-width="6" stroke-linecap="round"/><circle cx="64" cy="54" r="4" fill="#6d4c41"/><circle cx="136" cy="54" r="4" fill="#6d4c41"/><path d="M82 96h25c10 0 14 6 12 16l-2 10c-1 6-5 10-10 12l9 30h-20l-7-26h-6l-6 26H58z" fill="#1976d2"/><path d="M105 110h9c2 0 3 2 3 4l-1 6c0 2-2 4-4 4h-9z" fill="#bbdefb"/></svg>'),I=[{label:"Amazon",href:s.amazonLink,bg:"#232f3e",text:"#ffffff",logo:"https://upload.wikimedia.org/wikipedia/commons/a/a9/Amazon_logo.svg"},{label:"Flipkart",href:s.flipkartLink,bg:"#2874f0",text:"#ffffff",logo:G}].filter(t=>t.href),y=B.filter(t=>t._id!==s._id).filter(t=>{if(s.category&&t.category===s.category)return!0;const a=(s.collections||[]).map(r=>r._id||r),l=(t.collections||[]).map(r=>r._id||r);return a.some(r=>l.includes(r))}).slice(0,6),F=async t=>{v(!0);try{await d(s._id,1),t&&x("/checkout")}finally{v(!1)}},K=async()=>{var r;const t=typeof window<"u"?window.location.href:"",a=(s==null?void 0:s.name)||"Mrigmaya",l=`${a} | Mrigmaya`;if(navigator.share)try{await navigator.share({title:a,text:l,url:t});return}catch{}(r=navigator.clipboard)!=null&&r.writeText?(await navigator.clipboard.writeText(t),ee.success("Link copied")):window.prompt("Copy this product link",t)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-[#fefbfe] min-h-screen",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 lg:px-0 py-10 space-y-12",children:[e.jsxs("div",{className:"grid lg:grid-cols-[1.1fr,0.9fr] gap-10 items-start",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"relative rounded-3xl overflow-hidden bg-white shadow",children:[b?e.jsx("img",{src:b,alt:s.name,className:"w-full h-[520px] object-cover cursor-zoom-in",loading:"eager",fetchpriority:"high",decoding:"async",onClick:()=>{M(b),c(1.4),p(!0)}}):e.jsx("div",{className:"w-full h-[520px] flex items-center justify-center text-gray-400",children:"No image"}),o.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:U,className:"absolute left-3 top-1/2 -translate-y-1/2 bg-white/90 text-gray-800 rounded-full w-10 h-10 flex items-center justify-center shadow",children:"‹"}),e.jsx("button",{onClick:H,className:"absolute right-3 top-1/2 -translate-y-1/2 bg-white/90 text-gray-800 rounded-full w-10 h-10 flex items-center justify-center shadow",children:"›"})]})]}),o.length>1&&e.jsx("div",{className:"flex gap-3 mt-4 overflow-x-auto",children:o.map((t,a)=>e.jsx("button",{onClick:()=>h(a),className:`w-20 h-20 rounded-2xl overflow-hidden border ${N===a?"border-pink-500":"border-gray-200"}`,children:e.jsx("img",{src:t,alt:s.name,className:"w-full h-full object-cover cursor-zoom-in",loading:"lazy",decoding:"async",onClick:()=>{M(t),c(1.4),p(!0)}})},`${t}-${a}`))}),s.video&&e.jsx("div",{className:"mt-4 bg-white rounded-2xl shadow border border-gray-100 overflow-hidden",children:e.jsx("video",{src:ae(s.video),controls:!0,className:"w-full h-[320px] object-cover bg-black",playsInline:!0})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:s.category}),e.jsx("h1",{className:"text-3xl font-semibold text-gray-900",children:s.name}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-3xl font-semibold text-gray-900",children:f(V)}),D&&e.jsx("span",{className:"text-gray-400 line-through",children:f(s.price)}),$&&e.jsxs("span",{className:"text-sm px-3 py-1 bg-red-100 text-red-600 rounded-full",children:["-",$,"%"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 text-xs text-gray-600",children:[e.jsx("span",{className:"px-3 py-1 rounded-full bg-emerald-50 text-emerald-700 border border-emerald-100",children:"Delivery in 4-7 days"}),e.jsx("span",{className:"px-3 py-1 rounded-full bg-indigo-50 text-indigo-700 border border-indigo-100",children:"Free returns within 7 days"}),e.jsx("span",{className:"px-3 py-1 rounded-full bg-amber-50 text-amber-700 border border-amber-100",children:"COD & UPI available"})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:K,className:"px-4 py-2 rounded-full border border-[var(--border)] bg-white text-[var(--ink)] text-sm font-semibold shadow-sm hover:-translate-y-0.5 transition",children:"Share link"}),e.jsx("a",{href:`https://wa.me/?text=${encodeURIComponent(`${s.name||"Check this saree"} - ${typeof window<"u"?window.location.href:""}`)}`,target:"_blank",rel:"noreferrer",className:"px-4 py-2 rounded-full bg-[#25D366] text-white text-sm font-semibold shadow-sm hover:-translate-y-0.5 transition",children:"Share on WhatsApp"})]}),I.length>0&&e.jsx("div",{className:"flex flex-wrap gap-3 pt-2",children:I.map(t=>e.jsxs("a",{href:t.href,target:"_blank",rel:"noreferrer",className:"flex items-center gap-2 px-3 py-2 rounded-full text-sm font-semibold shadow-sm hover:-translate-y-0.5 transition",style:{background:t.bg,color:t.text},children:[e.jsx("img",{src:t.logo,alt:`${t.label} logo`,className:"h-6 w-auto object-contain",loading:"lazy",onError:a=>{a.currentTarget.style.display="none"}}),e.jsx("span",{className:"text-white tracking-tight",children:t.label})]},t.label))})]}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-700 bg-white rounded-3xl p-4 shadow",children:[s.description&&e.jsx("p",{className:"text-gray-600",children:s.description}),s.fabric&&e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Fabric:"})," ",s.fabric]}),s.color&&e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Color:"})," ",s.color]}),s.stock&&e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Stock:"})," ",s.stock]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:()=>F(!1),className:"w-full bg-gray-900 text-white py-3 rounded-full font-semibold disabled:opacity-60",disabled:u,children:u?"Adding...":"Add to cart"}),e.jsx("button",{onClick:()=>F(!0),className:"w-full bg-gradient-to-r from-[var(--primary)] to-[var(--accent)] text-white py-3 rounded-full font-semibold disabled:opacity-60",disabled:u,children:u?"Please wait...":"Buy now"}),!m&&e.jsx("p",{className:"text-xs text-gray-500 text-center",children:"You will be asked to log in before checkout."})]})]})]}),e.jsxs("div",{className:"bg-white rounded-3xl shadow p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"Customer reviews"}),e.jsxs("div",{className:"flex items-center gap-2 text-lg font-semibold text-gray-900",children:[e.jsxs("span",{children:["★ ",Y.toFixed(1)]}),e.jsxs("span",{className:"text-sm text-gray-500",children:["(",g.length,")"]})]})]}),e.jsx("button",{className:"px-4 py-2 rounded-full border border-gray-200 text-sm text-gray-700",children:"Write a review"})]}),e.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:g.slice(0,4).map((t,a)=>e.jsxs("div",{className:"border border-gray-100 rounded-2xl p-4 shadow-sm bg-[#fefbfe]",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-1 text-amber-500 text-sm",children:["★★★★★".slice(0,Math.max(1,Math.min(5,t.rating||5)))," "]}),e.jsx("span",{className:"text-xs text-gray-400",children:t.date?new Date(t.date).toLocaleDateString():""})]}),e.jsx("p",{className:"font-semibold text-gray-900 mt-2",children:t.author||"Customer"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t.comment})]},a))})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"You may also like"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Similar sarees"})]}),y.length>4&&e.jsx("button",{className:"text-sm text-pink-600 font-semibold",onClick:()=>x("/products"),children:"View all"})]}),y.length===0?e.jsx("p",{className:"text-sm text-gray-500",children:"More sarees will appear here soon."}):e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:y.map(t=>{const a=t.discountPrice||t.price,l=t.discountPrice&&t.price?Math.round((t.price-t.discountPrice)/t.price*100):null;return e.jsxs("article",{className:"bg-white border border-gray-100 rounded-2xl shadow hover:-translate-y-1 transition cursor-pointer",onClick:()=>x(`/product/${t._id}`),children:[e.jsxs("div",{className:"relative h-56 rounded-t-2xl overflow-hidden bg-white",children:[e.jsx("img",{src:R(t),alt:t.name,className:"w-full h-full object-contain",loading:"lazy",decoding:"async"}),l?e.jsxs("span",{className:"absolute top-3 left-3 bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:["-",l,"%"]}):null]}),e.jsxs("div",{className:"p-4 space-y-2",children:[e.jsx("p",{className:"text-[11px] uppercase tracking-[0.3em] text-gray-400",children:t.category||s.category}),e.jsx("h3",{className:"text-base font-semibold text-gray-900 line-clamp-2",children:t.name}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"text-lg font-semibold text-gray-900",children:f(a)}),t.discountPrice&&e.jsx("span",{className:"text-gray-400 line-through",children:f(t.price)})]}),e.jsx("button",{type:"button",onClick:r=>{r.stopPropagation(),d(t._id)},className:"inline-flex items-center justify-center w-full mt-1 bg-gray-900 text-white text-sm font-semibold rounded-full px-4 py-2",children:"Add to cart"})]})]},t._id)})})]})]})}),Z&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black/70 backdrop-blur-sm flex items-center justify-center px-4 py-6",onClick:()=>p(!1),children:e.jsxs("div",{className:"bg-white/5 border border-white/15 shadow-2xl rounded-2xl max-w-6xl w-full max-h-[90vh] flex flex-col",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-3 text-white/80 text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Zoom preview"}),e.jsx("span",{className:"text-xs opacity-80",children:"Click - / + or scroll to zoom"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"px-3 py-2 rounded-full bg-white/10 text-white hover:bg-white/20",onClick:()=>c(t=>Math.max(1,Number((t-.2).toFixed(1)))),children:"−"}),e.jsx("button",{className:"px-3 py-2 rounded-full bg-white/10 text-white hover:bg-white/20",onClick:()=>c(t=>Math.min(4,Number((t+.2).toFixed(1)))),children:"+"}),e.jsx("button",{className:"ml-2 px-3 py-2 rounded-full bg-white/15 text-white hover:bg-white/25",onClick:()=>{c(1.4),p(!1)},children:"Close"})]})]}),e.jsx("div",{className:"flex-1 overflow-auto px-4 py-4 bg-[#0b0a0a]/30",onWheel:t=>{t.preventDefault();const a=t.deltaY<0?.2:-.2;c(l=>{const r=l+a;return Math.min(4,Math.max(1,Number(r.toFixed(1))))})},children:z?e.jsx("img",{src:z,alt:"Zoomed",className:"block mx-auto rounded-xl shadow-2xl",style:{width:`${S*100}%`,maxWidth:`${S*100}%`,minWidth:"60%",transformOrigin:"center center"},onDoubleClick:()=>c(1.4),loading:"lazy",decoding:"async"}):null})]})})]})}export{ie as default};
