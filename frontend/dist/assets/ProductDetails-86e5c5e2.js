import{c as ne,r as i,C as ie,A as oe,u as ce,i as Y,j as e,b as V,z}from"./index-99c83c38.js";import{s as de}from"./seo-4fb2e452.js";const xe="data:image/gif;base64,R0lGODlhAQABAAD/ACw=",w=a=>`Rs. ${new Intl.NumberFormat("en-IN",{maximumFractionDigits:0}).format(a||0)}`,P=a=>V(a,""),H=a=>{var c;const o=(c=a==null?void 0:a.images)==null?void 0:c[0];return o?P(o):xe},he=a=>V(a,"");function pe(){var U;const{id:a}=ne(),{addToCart:o}=i.useContext(ie),{token:c}=i.useContext(oe),x=ce(),[s,A]=i.useState(null),[M,u]=i.useState(0),[b,D]=i.useState(!1),[X,K]=i.useState([]),[L,Q]=i.useState([]),[q,$]=i.useState(!0),[I,B]=i.useState(""),[J,p]=i.useState(!1),[R,h]=i.useState(1.2),[F,O]=i.useState(""),[_,v]=i.useState(""),[W,k]=i.useState(""),m=((s==null?void 0:s.stock)||0)>0;if(i.useEffect(()=>{let t=!0;return $(!0),B(""),Y.get(`/products/${a}`).then(l=>{var g;if(!t)return;A(l.data);const r=j(l.data),n=N(l.data);v(r[0]||""),k(n[0]||""),u(0);const f=Array.isArray((g=l.data)==null?void 0:g.reviews)?l.data.reviews:[];Q(f)}).catch(l=>{var r;console.error("Product fetch failed",((r=l==null?void 0:l.response)==null?void 0:r.data)||(l==null?void 0:l.message)),t&&(B("Product not found or unavailable right now."),A(null))}).finally(()=>t&&$(!1)),()=>{t=!1}},[a]),i.useEffect(()=>{Y.get("/products?includeInactive=true").then(t=>{var r;const l=Array.isArray(t.data)?t.data:((r=t.data)==null?void 0:r.products)||[];K(l)}).catch(()=>{})},[]),i.useEffect(()=>{if(!s)return;const t=s.name||"Product",l=s.description||s.subtitle||"Discover handcrafted sarees and curated edits from Mrigmaya.";de({title:`${t} | Mrigmaya`,description:l,image:H(s)})},[s]),q)return e.jsx("div",{className:"p-6",children:"Loading..."});if(I)return e.jsxs("div",{className:"p-6 space-y-3",children:[e.jsx("p",{className:"text-red-600 font-semibold",children:I}),e.jsx("button",{className:"px-4 py-2 bg-gray-900 text-white rounded-full",onClick:()=>x("/products"),children:"Back to products"})]});if(!s)return e.jsxs("div",{className:"p-6 space-y-3",children:[e.jsx("p",{className:"text-gray-600",children:"Product not found."}),e.jsx("button",{className:"px-4 py-2 bg-gray-900 text-white rounded-full",onClick:()=>x("/products"),children:"Back to products"})]});const d=Array.isArray(s.images)&&s.images.length?s.images.map(t=>P(t)):[],C=d[M]||P((U=s.images)==null?void 0:U[0])||"",ee=()=>u(t=>d.length?(t-1+d.length)%d.length:0),te=()=>u(t=>d.length?(t+1)%d.length:0),se=s.discountPrice||s.price,E=s.discountPrice&&s.price,T=E?Math.round((s.price-s.discountPrice)/s.price*100):null,y=L.length>0?L:[{author:"Happy customer",rating:5,comment:"Loved the drape and finish. Would buy again.",date:new Date().toISOString()}],ae=y.reduce((t,l)=>t+(Number(l.rating)||0),0)/(y.length||1),le="data:image/svg+xml;utf8,"+encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200" aria-label="Flipkart logo"><rect x="24" y="28" width="152" height="144" rx="16" fill="#ffd426"/><path d="M46 52h108c5 0 9 4 9 9v13H37V61c0-5 4-9 9-9z" fill="#fbc02d"/><path d="M62 64c12 16 32 16 44 0" fill="none" stroke="#e53935" stroke-width="6" stroke-linecap="round"/><path d="M106 64c12 16 32 16 44 0" fill="none" stroke="#00897b" stroke-width="6" stroke-linecap="round"/><circle cx="64" cy="54" r="4" fill="#6d4c41"/><circle cx="136" cy="54" r="4" fill="#6d4c41"/><path d="M82 96h25c10 0 14 6 12 16l-2 10c-1 6-5 10-10 12l9 30h-20l-7-26h-6l-6 26H58z" fill="#1976d2"/><path d="M105 110h9c2 0 3 2 3 4l-1 6c0 2-2 4-4 4h-9z" fill="#bbdefb"/></svg>'),G=[{label:"Amazon",href:s.amazonLink,bg:"#232f3e",text:"#ffffff",logo:"https://upload.wikimedia.org/wikipedia/commons/a/a9/Amazon_logo.svg"},{label:"Flipkart",href:s.flipkartLink,bg:"#2874f0",text:"#ffffff",logo:le}].filter(t=>t.href),S=X.filter(t=>t._id!==s._id).filter(t=>{if(s.category&&t.category===s.category)return!0;const l=(s.collections||[]).map(n=>n._id||n),r=(t.collections||[]).map(n=>n._id||n);return l.some(n=>r.includes(n))}).slice(0,6),Z=async t=>{const l=j(s),r=N(s),n=r.length>0,f=_||l[0]||"",g=W||(n?r[0]:"");if(n&&!g){z.error("Select a size");return}if(!m){z.error("This item is out of stock");return}v(f),k(g),D(!0);try{await o(s._id,f,g),t&&x("/checkout")}finally{D(!1)}},re=async()=>{var n;const t=typeof window<"u"?window.location.href:"",l=(s==null?void 0:s.name)||"Mrigmaya",r=`${l} | Mrigmaya`;if(navigator.share)try{await navigator.share({title:l,text:r,url:t});return}catch{}(n=navigator.clipboard)!=null&&n.writeText?(await navigator.clipboard.writeText(t),z.success("Link copied")):window.prompt("Copy this product link",t)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-[#fefbfe] min-h-screen",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 lg:px-0 py-10 space-y-12",children:[e.jsxs("div",{className:"grid lg:grid-cols-[1.1fr,0.9fr] gap-10 items-start",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"relative rounded-3xl overflow-hidden bg-white shadow",children:[C?e.jsx("img",{src:C,alt:s.name,className:"w-full max-h-[520px] object-contain bg-white cursor-zoom-in",loading:"eager",fetchpriority:"high",decoding:"async",onClick:()=>{O(C),h(1.4),p(!0)}}):e.jsx("div",{className:"w-full h-[520px] flex items-center justify-center text-gray-400",children:"No image"}),d.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:ee,className:"absolute left-3 top-1/2 -translate-y-1/2 bg-white/90 text-gray-800 rounded-full w-10 h-10 flex items-center justify-center shadow",children:"‹"}),e.jsx("button",{onClick:te,className:"absolute right-3 top-1/2 -translate-y-1/2 bg-white/90 text-gray-800 rounded-full w-10 h-10 flex items-center justify-center shadow",children:"›"})]})]}),d.length>1&&e.jsx("div",{className:"flex gap-3 mt-4 overflow-x-auto",children:d.map((t,l)=>e.jsx("button",{onClick:()=>u(l),className:`w-20 h-20 rounded-2xl overflow-hidden border ${M===l?"border-pink-500":"border-gray-200"}`,children:e.jsx("img",{src:t,alt:s.name,className:"w-full h-full object-contain bg-white cursor-zoom-in",loading:"lazy",decoding:"async",onClick:()=>{O(t),h(1.4),p(!0)}})},`${t}-${l}`))}),s.video&&e.jsx("div",{className:"mt-4 bg-white rounded-2xl shadow border border-gray-100 overflow-hidden",children:e.jsx("video",{src:he(s.video),controls:!0,className:"w-full h-[320px] object-cover bg-black",playsInline:!0})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:s.category}),e.jsx("h1",{className:"text-3xl font-semibold text-gray-900",children:s.name}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-3xl font-semibold text-gray-900",children:w(se)}),E&&e.jsx("span",{className:"text-gray-400 line-through",children:w(s.price)}),T&&e.jsxs("span",{className:"text-sm px-3 py-1 bg-red-100 text-red-600 rounded-full",children:["-",T,"%"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 text-xs text-gray-600",children:[e.jsx("span",{className:"px-3 py-1 rounded-full bg-emerald-50 text-emerald-700 border border-emerald-100",children:"Delivery in 4-7 days"}),e.jsx("span",{className:"px-3 py-1 rounded-full bg-indigo-50 text-indigo-700 border border-indigo-100",children:"Free returns within 7 days"}),e.jsx("span",{className:"px-3 py-1 rounded-full bg-amber-50 text-amber-700 border border-amber-100",children:"COD & UPI available"})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:re,className:"px-4 py-2 rounded-full border border-[var(--border)] bg-white text-[var(--ink)] text-sm font-semibold shadow-sm hover:-translate-y-0.5 transition",children:"Share link"}),e.jsx("a",{href:`https://wa.me/?text=${encodeURIComponent(`${s.name||"Check this saree"} - ${typeof window<"u"?window.location.href:""}`)}`,target:"_blank",rel:"noreferrer",className:"px-4 py-2 rounded-full bg-[#25D366] text-white text-sm font-semibold shadow-sm hover:-translate-y-0.5 transition",children:"Share on WhatsApp"})]}),G.length>0&&e.jsx("div",{className:"flex flex-wrap gap-3 pt-2",children:G.map(t=>e.jsxs("a",{href:t.href,target:"_blank",rel:"noreferrer",className:"flex items-center gap-2 px-3 py-2 rounded-full text-sm font-semibold shadow-sm hover:-translate-y-0.5 transition",style:{background:t.bg,color:t.text},children:[e.jsx("img",{src:t.logo,alt:`${t.label} logo`,className:"h-6 w-auto object-contain",loading:"lazy",onError:l=>{l.currentTarget.style.display="none"}}),e.jsx("span",{className:"text-white tracking-tight",children:t.label})]},t.label))})]}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-700 bg-white rounded-3xl p-4 shadow",children:[s.description&&e.jsx("p",{className:"text-gray-600",children:s.description}),s.fabric&&e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Fabric:"})," ",s.fabric]}),e.jsx("p",{className:"font-semibold",children:"Colors:"}),j(s).length>0&&e.jsx("div",{className:"space-y-1",children:e.jsx("div",{className:"flex flex-wrap gap-3",children:j(s).map(t=>e.jsxs("button",{type:"button",onClick:()=>v(t),className:`px-3 py-2 rounded-full border text-sm flex items-center gap-2 shadow-sm transition ${_===t?"border-[var(--primary)] ring-2 ring-[var(--primary)]/20 bg-white":"border-gray-200 bg-[#fdfbf8]"}`,style:{minWidth:88},children:[e.jsx("span",{className:"inline-block w-5 h-5 rounded-full border",style:{background:ge(t),borderColor:"rgba(0,0,0,0.2)",boxShadow:"inset 0 0 0 1px rgba(255,255,255,0.45)"},title:t}),e.jsx("span",{className:"font-semibold capitalize truncate",children:t})]},t))})}),N(s).length>0&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"font-semibold",children:"Sizes:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:N(s).map(t=>e.jsx("button",{type:"button",onClick:()=>k(t),className:`px-3 py-1 rounded-full border text-xs font-semibold transition ${W===t?"bg-indigo-600 text-white border-indigo-600":"bg-indigo-50 text-indigo-800 border-indigo-100"}`,children:t},t))})]}),e.jsxs("p",{className:"font-semibold",children:["Stock:"," ",e.jsx("span",{className:m?"text-gray-700 font-normal":"text-red-600 font-semibold",children:m?s.stock:"Out of stock"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:()=>Z(!1),className:"w-full bg-gray-900 text-white py-3 rounded-full font-semibold disabled:opacity-60",disabled:b||!m,children:b?"Adding...":m?"Add to cart":"Out of stock"}),e.jsx("button",{onClick:()=>Z(!0),className:"w-full bg-gradient-to-r from-[var(--primary)] to-[var(--accent)] text-white py-3 rounded-full font-semibold disabled:opacity-60",disabled:b||!m,children:b?"Please wait...":m?"Buy now":"Out of stock"}),!c&&e.jsx("p",{className:"text-xs text-gray-500 text-center",children:"You will be asked to log in before checkout."})]})]})]}),e.jsxs("div",{className:"bg-white rounded-3xl shadow p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"Customer reviews"}),e.jsxs("div",{className:"flex items-center gap-2 text-lg font-semibold text-gray-900",children:[e.jsxs("span",{children:["★ ",ae.toFixed(1)]}),e.jsxs("span",{className:"text-sm text-gray-500",children:["(",y.length,")"]})]})]}),e.jsx("button",{className:"px-4 py-2 rounded-full border border-gray-200 text-sm text-gray-700",children:"Write a review"})]}),e.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:y.slice(0,4).map((t,l)=>e.jsxs("div",{className:"border border-gray-100 rounded-2xl p-4 shadow-sm bg-[#fefbfe]",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-1 text-amber-500 text-sm",children:["★★★★★".slice(0,Math.max(1,Math.min(5,t.rating||5)))," "]}),e.jsx("span",{className:"text-xs text-gray-400",children:t.date?new Date(t.date).toLocaleDateString():""})]}),e.jsx("p",{className:"font-semibold text-gray-900 mt-2",children:t.author||"Customer"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t.comment})]},l))})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"You may also like"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Similar sarees"})]}),S.length>4&&e.jsx("button",{className:"text-sm text-pink-600 font-semibold",onClick:()=>x("/products"),children:"View all"})]}),S.length===0?e.jsx("p",{className:"text-sm text-gray-500",children:"More sarees will appear here soon."}):e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:S.map(t=>{const l=t.discountPrice||t.price,r=t.discountPrice&&t.price?Math.round((t.price-t.discountPrice)/t.price*100):null;return e.jsxs("article",{className:"bg-white border border-gray-100 rounded-2xl shadow hover:-translate-y-1 transition cursor-pointer",onClick:()=>x(`/product/${t._id}`),children:[e.jsxs("div",{className:"relative h-56 rounded-t-2xl overflow-hidden bg-white",children:[e.jsx("img",{src:H(t),alt:t.name,className:"w-full h-full object-contain",loading:"lazy",decoding:"async"}),r?e.jsxs("span",{className:"absolute top-3 left-3 bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:["-",r,"%"]}):null]}),e.jsxs("div",{className:"p-4 space-y-2",children:[e.jsx("p",{className:"text-[11px] uppercase tracking-[0.3em] text-gray-400",children:t.category||s.category}),e.jsx("h3",{className:"text-base font-semibold text-gray-900 line-clamp-2",children:t.name}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"text-lg font-semibold text-gray-900",children:w(l)}),t.discountPrice&&e.jsx("span",{className:"text-gray-400 line-through",children:w(t.price)})]}),e.jsx("button",{type:"button",onClick:n=>{n.stopPropagation(),o(t._id)},className:"inline-flex items-center justify-center w-full mt-1 bg-gray-900 text-white text-sm font-semibold rounded-full px-4 py-2",children:"Add to cart"})]})]},t._id)})})]})]})}),J&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black/70 backdrop-blur-sm flex items-center justify-center px-4 py-6",onClick:()=>p(!1),children:e.jsxs("div",{className:"bg-white/5 border border-white/15 shadow-2xl rounded-2xl max-w-6xl w-full max-h-[90vh] flex flex-col",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-3 text-white/80 text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Zoom preview"}),e.jsx("span",{className:"text-xs opacity-80",children:"Click - / + or scroll to zoom"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"px-3 py-2 rounded-full bg-white/10 text-white hover:bg-white/20",onClick:()=>h(t=>Math.max(1,Number((t-.2).toFixed(1)))),children:"−"}),e.jsx("button",{className:"px-3 py-2 rounded-full bg-white/10 text-white hover:bg-white/20",onClick:()=>h(t=>Math.min(4,Number((t+.2).toFixed(1)))),children:"+"}),e.jsx("button",{className:"ml-2 px-3 py-2 rounded-full bg-white/15 text-white hover:bg-white/25",onClick:()=>{h(1.4),p(!1)},children:"Close"})]})]}),e.jsx("div",{className:"flex-1 overflow-auto px-4 py-4 bg-[#0b0a0a]/30",onWheel:t=>{t.preventDefault();const l=t.deltaY<0?.2:-.2;h(r=>{const n=r+l;return Math.min(4,Math.max(1,Number(n.toFixed(1))))})},children:F?e.jsx("img",{src:F,alt:"Zoomed",className:"block mx-auto rounded-xl shadow-2xl",style:{width:`${R*100}%`,maxWidth:`${R*100}%`,minWidth:"60%",transformOrigin:"center center"},onDoubleClick:()=>h(1.4),loading:"lazy",decoding:"async"}):null})]})})]})}const me=[{label:"Red",swatch:"#e53935"},{label:"Pink",swatch:"#f06292"},{label:"Magenta",swatch:"#d81b60"},{label:"Maroon",swatch:"#7b1fa2"},{label:"Yellow",swatch:"#fbc02d"},{label:"Mustard",swatch:"#d3a518"},{label:"Orange",swatch:"#ff7043"},{label:"Peach",swatch:"#f8b195"},{label:"Green",swatch:"#43a047"},{label:"Olive",swatch:"#708238"},{label:"Mint",swatch:"#7bdcb5"},{label:"Sea Green",swatch:"#2e8b57"},{label:"Teal",swatch:"#009688"},{label:"Blue",swatch:"#1e88e5"},{label:"Navy",swatch:"#1b3b6f"},{label:"Purple",swatch:"#9c27b0"},{label:"Lavender",swatch:"#c6a5d8"},{label:"Brown",swatch:"#8d6e63"},{label:"Beige",swatch:"#d9c4a1"},{label:"Cream",swatch:"#f6e7c1"},{label:"Grey",swatch:"#9e9e9e"},{label:"Black",swatch:"#212121"},{label:"White",swatch:"#f5f5f5"},{label:"Gold",swatch:"#d4af37"},{label:"Silver",swatch:"#c0c0c0"},{label:"Multi",swatch:"linear-gradient(120deg, #e53935, #fbc02d, #43a047, #1e88e5, #9c27b0)"}],ge=a=>{const o=me.find(c=>c.label.toLowerCase()===(a||"").toLowerCase());return(o==null?void 0:o.swatch)||"linear-gradient(135deg, #fdfcfb, #e2d1c3)"},fe=a=>{var c,x;return[(a==null?void 0:a.name)||"",(a==null?void 0:a.category)||"",((c=a==null?void 0:a.categoryRef)==null?void 0:c.name)||"",((x=a==null?void 0:a.categoryRef)==null?void 0:x.slug)||"",...((a==null?void 0:a.collections)||[]).map(s=>(s==null?void 0:s.title)||(s==null?void 0:s.slug)||"")].join(" ").toLowerCase().includes("suit")},j=a=>a?Array.isArray(a.colors)&&a.colors.length?a.colors.filter(Boolean):a.color?a.color.split(/[,\\n]/).map(o=>o.trim()).filter(Boolean):[]:[],N=a=>a?Array.isArray(a.sizes)&&a.sizes.length?a.sizes.filter(Boolean):fe(a)?["XS","S","M","L","XL"]:[]:[];export{pe as default};
