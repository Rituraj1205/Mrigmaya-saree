import{r as p,A as qt,u as Wt,z as c,i as m,j as e,N as Gt,b as Jt}from"./index-9b45da5b.js";const q=n=>Jt(n,""),He=(n="")=>{const f=n.split("?")[0].toLowerCase();return/\.(mp4|webm|ogg)$/.test(f)},Ve=n=>n?Array.isArray(n.colors)&&n.colors.length?n.colors.join(", "):n.color||"":"",qe=n=>{const f=Ge.find(w=>w.label.toLowerCase()===(n||"").toLowerCase());return(f==null?void 0:f.swatch)||"linear-gradient(135deg, #fdfcfb, #e2d1c3)"},Xt=n=>{if(!(n!=null&&n.startsWith("#"))||n.length!==7&&n.length!==4)return!1;const f=n.length===4?`#${n[1]}${n[1]}${n[2]}${n[2]}${n[3]}${n[3]}`:n,w=parseInt(f.slice(1),16),k=w>>16&255,h=w>>8&255,b=w&255;return(k*299+h*587+b*114)/1e3>180},be={name:"",productCode:"",description:"",category:"",categoryRef:"",fabric:"",color:"",colors:[],sizes:[],amazonLink:"",flipkartLink:"",price:"",discountPrice:"",stock:"",images:"",colorImages:[],video:"",collectionIds:[]},We={title:"",slug:"",subtitle:"",description:"",ctaLabel:"",heroImage:"",accentColor:"#c1275a",displayOnHome:!0,priority:999},Kt=[{value:"processing",label:"Processing"},{value:"packed",label:"Packed"},{value:"shipped",label:"Shipped"},{value:"delivered",label:"Delivered"},{value:"cancelled",label:"Cancelled"}],Ge=[{label:"Red",swatch:"#e53935"},{label:"Pink",swatch:"#f06292"},{label:"Magenta",swatch:"#d81b60"},{label:"Maroon",swatch:"#7b1fa2"},{label:"Yellow",swatch:"#fbc02d"},{label:"Mustard",swatch:"#d3a518"},{label:"Orange",swatch:"#ff7043"},{label:"Peach",swatch:"#f8b195"},{label:"Green",swatch:"#43a047"},{label:"Olive",swatch:"#708238"},{label:"Mint",swatch:"#7bdcb5"},{label:"Sea Green",swatch:"#2e8b57"},{label:"Teal",swatch:"#009688"},{label:"Blue",swatch:"#1e88e5"},{label:"Navy",swatch:"#1b3b6f"},{label:"Purple",swatch:"#9c27b0"},{label:"Lavender",swatch:"#c6a5d8"},{label:"Brown",swatch:"#8d6e63"},{label:"Beige",swatch:"#d9c4a1"},{label:"Cream",swatch:"#f6e7c1"},{label:"Grey",swatch:"#9e9e9e"},{label:"Black",swatch:"#212121"},{label:"White",swatch:"#f5f5f5"},{label:"Gold",swatch:"#d4af37"},{label:"Silver",swatch:"#c0c0c0"},{label:"Multi",swatch:"linear-gradient(120deg, #e53935, #fbc02d, #43a047, #1e88e5, #9c27b0)"}],Qt=["XS","S","M","L","XL"],Yt=[{value:"cod_pending",label:"Awaiting COD"},{value:"awaiting_upi",label:"Awaiting UPI"},{value:"awaiting_gateway",label:"Awaiting gateway"},{value:"paid",label:"Paid"},{value:"cancelled",label:"Cancelled"}];function os(){const{token:n,user:f,logout:w}=p.useContext(qt),k=Wt(),[h,b]=p.useState([]),[y,L]=p.useState([]),[N,D]=p.useState([]),[o,i]=p.useState(be),u=p.useRef(null),[I,P]=p.useState(""),[O,z]=p.useState([]),[B,_]=p.useState([]),[ee,X]=p.useState(""),[K,G]=p.useState(!1),[ne,Q]=p.useState(!1),[E,pe]=p.useState(null),[S,F]=p.useState(We),[W,Je]=p.useState([]),[je,Ne]=p.useState([{_id:null,title:"",subtitle:"",image:""},{_id:null,title:"",subtitle:"",image:""}]),[ve,Xe]=p.useState([]),[j,H]=p.useState({code:"",discountType:"flat",value:"",maxDiscount:"",maxRedemptions:1,expiresAt:"",minOrderValue:"",active:!0}),[me,we]=p.useState(""),[Ke,oe]=p.useState(!1),[Qe,Ce]=p.useState(!1),[U,M]=p.useState({title:"",subtitle:"",tag:"",ctaLabel:"",ctaLink:"/products",image:"",order:1,active:!0,productIds:[]}),[te,ke]=p.useState(null),[Ye,ie]=p.useState(!1),[Se,Ze]=p.useState([]),[ce,et]=p.useState([]),_e=p.useMemo(()=>ce.filter(t=>t.returnRequested||t.returnStatus&&t.returnStatus!=="none"),[ce]),se=p.useMemo(()=>(o.images||"").split(/[\n,]/).map(t=>t.trim()).filter(Boolean),[o.images]),J=p.useMemo(()=>N.find(t=>t._id===o.categoryRef),[N,o.categoryRef]),he=p.useMemo(()=>`${(J==null?void 0:J.name)||""} ${(J==null?void 0:J.slug)||""} ${o.category||""}`.toLowerCase().trim(),[o.category,J]).includes("suit"),[V,tt]=p.useState("collections"),st=[{id:"collections",label:"Collections"},{id:"products",label:"Products"},{id:"coupons",label:"Coupons"},{id:"homepage",label:"Homepage Slider"},{id:"usp",label:"Offers Rail"},{id:"orders",label:"Orders"},{id:"returns",label:"Returns"},{id:"login-visuals",label:"Login visuals"}],g=p.useMemo(()=>({headers:{Authorization:`Bearer ${n||localStorage.getItem("token")||""}`}}),[n]),Y=t=>{Ze(s=>[{message:t,ts:new Date().toISOString()},...s].slice(0,15))},Le=(t,s=2)=>{var r;if(!t)return!1;if(!((r=t.type)!=null&&r.startsWith("image/")))return c.error("Please upload an image file"),!1;const a=s*1024*1024;return t.size>a?(c.error(`Image too large. Max ${s}MB allowed.`),!1):!0},at=(t,s=20)=>{var d,x;if(!t)return!1;const a=(d=t.type)==null?void 0:d.startsWith("image/"),r=(x=t.type)==null?void 0:x.startsWith("video/");if(!a&&!r)return c.error("Upload an image or video"),!1;const l=s*1024*1024;return t.size>l?(c.error(`File too large. Max ${s}MB allowed.`),!1):!0},ge=t=>{i(s=>{const a=s.colors||[],l=a.includes(t)?a.filter(d=>d!==t):[...a,t];return{...s,colors:l,color:l[0]||""}}),setTimeout(()=>{var s;P(t),(s=u.current)==null||s.click()},0)},rt=(t,s=[])=>{!t||!s.length||i(a=>{const r=[...a.colorImages||[]],l=r.findIndex(d=>(d.color||"").toLowerCase()===t.toLowerCase());if(l>=0){const d=r[l].images||[];r[l]={...r[l],color:t,images:[...d,...s]}}else r.push({color:t,images:s});return{...a,colorImages:r}})},lt=async t=>{if(!I||!(t!=null&&t.length))return;const s=[];for(const a of Array.from(t)){const r=await ze(a);r&&s.push(r)}s.length&&rt(I,s),P(""),u.current&&(u.current.value="")},Ie=()=>{const t=ee.trim();t&&(ge(t),X(""))},nt=t=>{i(s=>{const a=s.sizes||[],l=a.includes(t)?a.filter(d=>d!==t):[...a,t];return{...s,sizes:l}})},Ae=he||K||(o.sizes||[]).length>0,ot=t=>{const s=(t==null?void 0:t.shippingAddress)||{},a=[s.name,s.phone||t.customerContact,s.line1,s.line2,[s.city,s.state].filter(Boolean).join(", "),s.pincode].filter(Boolean);return a.length===0?"No address":a.join(" | ")};p.useEffect(()=>{if(!n){k("/admin/login");return}(f==null?void 0:f.role)!=="admin"&&(c.error("Admin access only"),k("/"))},[n,f,k]),p.useEffect(()=>{n&&(ae(),Z(),v(),it(),de(),xe())},[n]),p.useEffect(()=>{v()},[]);const ae=async()=>{try{const t=await m.get("/products?includeInactive=true");b(t.data)}catch(t){console.error(t)}},Z=async()=>{try{const t=await m.get("/collections?includeProducts=true");L(t.data)}catch(t){console.error(t)}},it=async()=>{if(n)try{const t=await m.get("/categories/all",g);D(t.data||[])}catch(t){console.error(t)}},de=async()=>{if(n)try{const t=await m.get("/coupons",g);Xe(t.data||[])}catch(t){console.error(t)}},xe=async()=>{if(n)try{const s=(await m.get("/orders",g)).data||{};et(Array.isArray(s.orders)?s.orders:Array.isArray(s)?s:[])}catch(t){console.error(t)}},ct=async t=>{try{const s=await m.get(`/orders/${t}/invoice`,{...g,responseType:"blob"}),a=new Blob([s.data],{type:"application/pdf"}),r=window.URL.createObjectURL(a),l=document.createElement("a");l.href=r,l.download=`invoice-${t.slice(-6)}.pdf`,document.body.appendChild(l),l.click(),l.remove(),window.URL.revokeObjectURL(r)}catch(s){console.error(s),c.error("Could not download invoice")}},v=async()=>{var t;try{const s=await m.get("/home-sections?includeInactive=true");Je(s.data)}catch(s){console.error("Home sections fetch failed",((t=s==null?void 0:s.response)==null?void 0:t.data)||s.message),c.error("Could not load homepage cards")}},A=p.useMemo(()=>[...W.filter(t=>t.group==="hero")].sort((t,s)=>(t.order??0)-(s.order??0)),[W]),De=p.useMemo(()=>A.length?Math.max(...A.map(t=>t.order??0)):0,[A]);p.useEffect(()=>{const t=[...W.filter(a=>{var r;return a.group==="custom"&&((r=a.meta)==null?void 0:r.loginSlot)!==void 0})].sort((a,r)=>{var l,d;return(((l=a.meta)==null?void 0:l.loginSlot)??0)-(((d=r.meta)==null?void 0:d.loginSlot)??0)}),s=[0,1].map(a=>{const r=t.find(l=>{var d;return Number((d=l.meta)==null?void 0:d.loginSlot)===a});return{_id:(r==null?void 0:r._id)||null,title:(r==null?void 0:r.title)||"",subtitle:(r==null?void 0:r.subtitle)||"",image:(r==null?void 0:r.image)||""}});Ne(s)},[W]);const ue=(t,s,a)=>{Ne(r=>{const l=[...r];return l[t]={...l[t],[s]:a},l})},dt=async()=>{try{await Promise.all(je.map(async(s,a)=>{const r={group:"custom",title:s.title,subtitle:s.subtitle,image:s.image,order:a,active:!0,meta:{...s.meta||{},loginSlot:a}};if(s._id){if(!s.image){await m.delete(`/home-sections/${s._id}`,g);return}await m.put(`/home-sections/${s._id}`,r,g)}else s.image&&await m.post("/home-sections",r,g)}))&&(c.success("Login visuals saved"),v())}catch(t){console.error(t),c.error("Could not save visuals")}},xt=async(t,s)=>{var r;if(!((r=t.title)!=null&&r.trim())){c.error("Enter a title for the offer");return}const a={...t,group:"usp",order:Number(t.order)||Pe.length+1};try{s?(await m.put(`/home-sections/${s}`,a,g),c.success("Offer updated")):(await m.post("/home-sections",a,g),c.success("Offer added")),v()}catch(l){console.error(l),c.error("Could not save offer")}},ut=async t=>{if(window.confirm("Delete this offer?"))try{await m.delete(`/home-sections/${t}`,g),c.success("Deleted"),v()}catch(s){console.error(s),c.error("Could not delete offer")}},pt=async(t,s)=>{if(Le(t)&&t){Ce(!0);try{const a=new FormData;a.append("file",t);const l=(await m.post("/uploads",a,{headers:{...g.headers,"Content-Type":"multipart/form-data"}})).data.url;ue(s,"image",l),c.success("Image uploaded")}catch(a){console.error(a),c.error("Upload failed")}finally{Ce(!1)}}},C=p.useMemo(()=>[...W.filter(t=>t.group==="category")].sort((t,s)=>(t.order??0)-(s.order??0)),[W]),Pe=p.useMemo(()=>[...W.filter(t=>t.group==="usp")].sort((t,s)=>(t.order??0)-(s.order??0)),[W]);p.useEffect(()=>{if(!E){z([]);return}const t=h.find(a=>a._id===E);if(!t)return;const s=C.filter(a=>{var l;return(((l=a.meta)==null?void 0:l.products)||a.productIds||[]).includes(t._id)}).map(a=>a._id);z(s)},[E,h,C]);const Ue=async t=>{if(!Le(t))return null;const s=new FormData;return s.append("file",t),(await m.post("/uploads",s,{headers:{Authorization:`Bearer ${n}`,"Content-Type":"multipart/form-data"}})).data.url},mt=async t=>{if(!at(t,25))return null;const s=new FormData;return s.append("file",t),(await m.post("/uploads",s,{headers:{Authorization:`Bearer ${n}`,"Content-Type":"multipart/form-data"}})).data.url},fe=()=>{M({title:"",subtitle:"",tag:"",ctaLabel:"",ctaLink:"/products",image:"",order:1,active:!0,productIds:[]}),ke(null)},$e=async(t,s)=>{await m.post("/home-sections",{group:"hero",...t,order:s,active:!0},g)},ht=async()=>{if(!U.title.trim()){c.error("Enter a title");return}if(!U.image.trim()){c.error("Add an image");return}const t={...U,order:Number(U.order)||C.length+1,group:"category"};t.meta={...t.meta||{},products:U.productIds||[]};try{te?(await m.put(`/home-sections/${te}`,t,g),c.success("Card updated")):(await m.post("/home-sections",t,g),c.success("Card added")),fe(),v()}catch(s){console.error(s),c.error("Could not save card")}},gt=t=>{var s;ke(t._id),M({title:t.title||"",subtitle:t.subtitle||"",tag:t.tag||"",ctaLabel:t.ctaLabel||"",ctaLink:t.ctaLink||"/products",image:t.image||"",order:t.order??1,active:t.active!==!1,productIds:((s=t.meta)==null?void 0:s.products)||t.productIds||[]})},ft=async t=>{if(window.confirm("Delete this card?"))try{await m.delete(`/home-sections/${t}`,g),c.success("Card deleted"),te===t&&fe(),v()}catch(s){console.error(s),c.error("Could not delete card")}},Me=async(t,s)=>{const a=C.findIndex(x=>x._id===t);if(a===-1)return;const r=s==="up"?a-1:a+1;if(r<0||r>=C.length)return;const l=C[a],d=C[r];try{await Promise.all([m.put(`/home-sections/${l._id}`,{order:d.order??r},g),m.put(`/home-sections/${d._id}`,{order:l.order??a},g)]),v()}catch(x){console.error(x),c.error("Could not reorder cards")}},yt=async t=>{if(t)try{ie(!0);const s=await Ue(t);M(a=>({...a,image:s})),c.success("Image uploaded")}catch(s){console.error(s),c.error("Upload failed")}finally{ie(!1)}},bt=async(t,s)=>{var l;if(!s)return;const a=C.find(d=>d._id===t),r=((l=a==null?void 0:a.meta)==null?void 0:l.products)||(a==null?void 0:a.productIds)||[];if(!r.includes(s))try{await m.put(`/home-sections/${t}`,{meta:{...a.meta||{},products:[...r,s]}},g),v()}catch(d){console.error(d),c.error("Could not attach product")}},Re=()=>{H({code:"",discountType:"flat",value:"",maxDiscount:"",maxRedemptions:1,expiresAt:"",active:!0})},jt=async()=>{var t,s;if(!j.code.trim()||!j.value){c.error("Code and value are required");return}try{await m.post("/coupons",{...j,code:j.code.trim().toUpperCase(),value:Number(j.value),maxDiscount:j.maxDiscount?Number(j.maxDiscount):void 0,maxRedemptions:j.maxRedemptions?Number(j.maxRedemptions):1},g),c.success("Coupon saved"),Re(),de()}catch(a){c.error(((s=(t=a.response)==null?void 0:t.data)==null?void 0:s.msg)||"Could not save coupon")}},Nt=async(t,s)=>{var Fe,Te,Be,Ee;const a=C.find(T=>T._id===t),r=Array.isArray(s.images)&&s.images.length?s.images:[s.image||""],l=new FormData;l.append("name",s.name||"Custom item"),l.append("description",`Custom product for ${(a==null?void 0:a.title)||"edit"}`),l.append("category",(a==null?void 0:a.title)||"Custom"),l.append("price",Number(s.mrp||s.price||0));const d=Number(s.price||0),x=Number(s.mrp||0);x>d&&d>0&&(l.append("discountPrice",d),l.append("price",x)),l.append("stock",50),l.append("images",r.filter(Boolean).join(`
`));let R=s.productId;try{R=((Fe=(await m.post("/products",l,{headers:{Authorization:`Bearer ${n}`,"Content-Type":"multipart/form-data"}})).data)==null?void 0:Fe._id)||R,c.success("Product created & attached"),ae()}catch(T){console.error("Custom product creation failed",T),c.error("Could not create product for this item");return}const ye=((Te=a==null?void 0:a.meta)==null?void 0:Te.products)||(a==null?void 0:a.productIds)||[],Vt=[...(((Be=a==null?void 0:a.meta)==null?void 0:Be.productsDetails)||[]).filter(T=>(T==null?void 0:T._id)!==R),{_id:R,name:s.name||"Custom item"}];try{await m.put(`/home-sections/${t}`,{meta:{...a.meta||{},products:[...new Set([...ye,R])],productsDetails:Vt,customProducts:((Ee=a==null?void 0:a.meta)==null?void 0:Ee.customProducts)||[]}},g),v()}catch(T){console.error(T),c.error("Could not attach product to this card")}},vt=async(t,s)=>{var d;const a=C.find(x=>x._id===t),l=(((d=a==null?void 0:a.meta)==null?void 0:d.customProducts)||[]).filter((x,$)=>$!==s);try{await m.put(`/home-sections/${t}`,{meta:{...a.meta||{},customProducts:l}},g),v()}catch(x){console.error(x),c.error("Could not remove product")}},wt=async t=>{if(!t)return"";try{return ie(!0),await Ue(t)}catch(s){return console.error(s),c.error("Upload failed"),""}finally{ie(!1)}},Ct=async(t,s)=>{var d;const a=C.find(x=>x._id===t),l=(((d=a==null?void 0:a.meta)==null?void 0:d.products)||(a==null?void 0:a.productIds)||[]).filter(x=>x!==s);try{await m.put(`/home-sections/${t}`,{meta:{...a.meta||{},products:l}},g),v()}catch(x){console.error(x),c.error("Could not remove product")}},kt=async t=>{var s;if(t!=null&&t.length){oe(!0);try{let a=De+1;for(const r of Array.from(t)){const l=await mt(r);if(!l)continue;const d=(s=r.type)!=null&&s.startsWith("video/")||He(l)?{video:l}:{image:l};await $e(d,a),a+=1}c.success("Slides added"),Y("Added hero slides via upload"),v()}catch(a){console.error(a),c.error("Could not upload slides")}finally{oe(!1)}}},St=async()=>{if(me.trim()){oe(!0);try{const t=me.trim(),s=He(t)?{video:t}:{image:t};await $e(s,De+1),we(""),c.success("Slide added"),Y("Added hero slide via link"),v()}catch(t){console.error(t),c.error("Could not save slide")}finally{oe(!1)}}},_t=async(t,s)=>{try{await m.put(`/home-sections/${t}`,{active:s},g),Y(`Slide ${s?"enabled":"disabled"}`),v()}catch(a){console.error(a),c.error("Could not update slide")}},Lt=async t=>{if(window.confirm("Delete this slide?"))try{await m.delete(`/home-sections/${t}`,g),c.success("Slide removed"),Y("Removed a hero slide"),v()}catch(s){console.error(s),c.error("Could not delete slide")}},Oe=async(t,s)=>{const a=A.findIndex(x=>x._id===t);if(a===-1)return;const r=s==="up"?a-1:a+1;if(r<0||r>=A.length)return;const l=A[a],d=A[r];try{await Promise.all([m.put(`/home-sections/${l._id}`,{order:d.order??r},g),m.put(`/home-sections/${d._id}`,{order:l.order??a},g)]),Y("Reordered hero slides"),v()}catch(x){console.error(x),c.error("Could not reorder slides")}},It=async(t,s)=>{if(!t||!s||t===s)return;const a=A.findIndex(x=>x._id===t),r=A.findIndex(x=>x._id===s);if(a===-1||r===-1)return;const l=A[a],d=A[r];try{await Promise.all([m.put(`/home-sections/${l._id}`,{order:d.order??r},g),m.put(`/home-sections/${d._id}`,{order:l.order??a},g)]),Y("Reordered hero slides (drag)"),v()}catch(x){console.error(x),c.error("Could not reorder slides")}},At=async(t,s=[])=>{const a=[];C.forEach(r=>{var $;const l=(($=r.meta)==null?void 0:$.products)||r.productIds||[],d=l.includes(t),x=s.includes(r._id);if(x&&!d&&a.push(m.put(`/home-sections/${r._id}`,{meta:{...r.meta||{},products:[...l,t]}},g)),!x&&d){const R=l.filter(ye=>ye!==t);a.push(m.put(`/home-sections/${r._id}`,{meta:{...r.meta||{},products:R}},g))}}),a.length&&(await Promise.all(a),v())},Dt=async()=>{var t,s,a,r;try{if(Ae&&(o.sizes||[]).length===0){c.error("Select at least one size for suits");return}const l=new FormData;l.append("name",o.name),o.productCode&&l.append("productCode",o.productCode.trim()),l.append("description",o.description),l.append("category",o.category),o.categoryRef&&l.append("categoryRef",o.categoryRef),l.append("fabric",o.fabric);const d=(o.colors||[]).join(",").trim();l.append("color",d||o.color||""),l.append("colors",(o.colors||[]).join(",")),l.append("sizes",(o.sizes||[]).join(",")),l.append("price",o.price||0),o.discountPrice&&l.append("discountPrice",o.discountPrice),l.append("stock",o.stock||0),o.amazonLink&&l.append("amazonLink",o.amazonLink.trim()),o.flipkartLink&&l.append("flipkartLink",o.flipkartLink.trim()),l.append("images",o.images),(t=o.colorImages)!=null&&t.length&&l.append("colorImages",JSON.stringify(o.colorImages)),o.video&&l.append("video",o.video),l.append("collections",o.collectionIds.join(",")),B.forEach(R=>l.append("images",R));const x={headers:{Authorization:`Bearer ${n}`,"Content-Type":"multipart/form-data"}};let $=E;E?(await m.put(`/products/${E}`,l,x),c.success("Product updated")):($=((s=(await m.post("/products",l,x)).data)==null?void 0:s._id)||$,c.success("Product created")),$&&await At($,O),i(be),z([]),_([]),pe(null),ae(),Z()}catch(l){console.error(l),c.error(((r=(a=l.response)==null?void 0:a.data)==null?void 0:r.msg)||"Failed to save product")}},Pt=t=>{var a,r,l,d;pe(t._id),_([]),G(((a=t.sizes)==null?void 0:a.length)>0),i({name:t.name||"",productCode:t.productCode||"",description:t.description||"",category:t.category||"",categoryRef:((r=t.categoryRef)==null?void 0:r._id)||t.categoryRef||"",fabric:t.fabric||"",color:t.color||((l=t.colors)==null?void 0:l[0])||"",colors:Array.isArray(t.colors)&&t.colors.length?t.colors:t.color?t.color.split(/[,\\n]/).map(x=>x.trim()).filter(Boolean):[],sizes:t.sizes||[],amazonLink:t.amazonLink||"",flipkartLink:t.flipkartLink||"",price:t.price||"",discountPrice:t.discountPrice||"",stock:t.stock||"",images:(t.images||[]).join(`
`),colorImages:t.colorImages||[],video:t.video||"",collectionIds:((d=t.collections)==null?void 0:d.map(x=>x._id||x))||[]});const s=C.filter(x=>{var R;return(((R=x.meta)==null?void 0:R.products)||x.productIds||[]).includes(t._id)}).map(x=>x._id);z(s)},Ut=()=>{i(be),z([]),_([]),X(""),G(!1),pe(null)},$t=async t=>{if(window.confirm("Delete this product?"))try{await m.delete(`/products/${t}`,g),c.success("Deleted"),ae(),Z()}catch{c.error("Failed to delete")}},Mt=async()=>{var t,s;try{await m.post("/collections",S,g),c.success("Collection created"),F(We),Z()}catch(a){c.error(((s=(t=a.response)==null?void 0:t.data)==null?void 0:s.msg)||"Failed to create collection")}},re=async(t,s)=>{try{await m.put(`/collections/${t}`,s,g),c.success("Collection updated"),Z()}catch{c.error("Update failed")}},Rt=async t=>{if(window.confirm("Delete this collection?"))try{await m.delete(`/collections/${t}`,g),c.success("Collection removed"),Z(),ae()}catch{c.error("Could not delete")}},Ot=async(t,s)=>{if(s)try{const a=new FormData;a.append("file",s);const r=await m.post("/uploads",a,{headers:{Authorization:`Bearer ${n}`,"Content-Type":"multipart/form-data"}});await re(t,{heroImage:r.data.url}),c.success("Image uploaded")}catch(a){console.error(a),c.error("Upload failed")}},zt=async(t,s)=>{var l,d;if(!s)return;const a=await ze(s);if(!a)return;const r=((d=(l=y.find(x=>x._id===t))==null?void 0:l.heroImages)==null?void 0:d.filter(Boolean))||[];await re(t,{heroImages:[...r,a]})},Ft=async(t,s)=>{var l,d;const r=(((d=(l=y.find(x=>x._id===t))==null?void 0:l.heroImages)==null?void 0:d.filter(Boolean))||[]).filter(x=>x!==s);await re(t,{heroImages:r})},Tt=async t=>{if(t)try{Q(!0);const s=new FormData;s.append("file",t);const a=await m.post("/uploads",s,{headers:{Authorization:`Bearer ${n}`,"Content-Type":"multipart/form-data"}});i(r=>({...r,video:a.data.url})),c.success("Video uploaded")}catch(s){console.error(s),c.error("Video upload failed")}finally{Q(!1)}},ze=async t=>{var s,a;if(!t)return"";try{const r=new FormData;r.append("file",t);const l=await m.post("/uploads",r,{headers:{Authorization:`Bearer ${n}`,"Content-Type":"multipart/form-data"}});return c.success("Image uploaded"),l.data.url}catch(r){console.error(r);const l=((a=(s=r==null?void 0:r.response)==null?void 0:s.data)==null?void 0:a.msg)||"Upload failed";return c.error(l),""}},le=async(t,s)=>{var a,r;try{await m.patch(`/orders/${t}`,s,g),c.success("Order updated"),xe()}catch(l){console.error(l),c.error(((r=(a=l.response)==null?void 0:a.data)==null?void 0:r.msg)||"Could not update order")}},Bt=(t=[])=>t.map(s=>{var a;return(a=y.find(r=>r._id===s))==null?void 0:a.title}).filter(Boolean).join(", "),Et=p.useMemo(()=>{const t={};return C.forEach(s=>{var r;(((r=s.meta)==null?void 0:r.products)||s.productIds||[]).forEach(l=>{t[l]||(t[l]=[]),t[l].push(s.title||"Mood")})}),t},[C]),Ht=t=>(Et[t]||[]).join(", ");return!n||(f==null?void 0:f.role)!=="admin"?e.jsx(Gt,{to:"/admin/login",replace:!0}):e.jsxs("div",{className:"admin-page min-h-screen bg-[var(--bg)]",children:[e.jsx("header",{className:"sticky top-0 z-30 bg-gradient-to-b from-[var(--surface)]/95 to-[var(--surface-muted)]/88 backdrop-blur border-b border-[var(--border)] shadow-[0_12px_40px_rgba(24,16,10,0.08)]",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-6 py-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-[var(--muted)]",children:"Admin"}),e.jsx("h1",{className:"text-xl font-semibold text-[var(--ink)]",children:"Mrigmaya Control Room"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-sm text-[var(--muted)]",children:["Logged in as ",f==null?void 0:f.mobile]}),e.jsx("button",{onClick:()=>{w(),k("/admin/login")},className:"pill-button secondary hover:-translate-y-0.5",children:"Logout"})]})]})}),e.jsxs("main",{className:"max-w-6xl mx-auto px-6 py-8 space-y-10 admin-main",children:[e.jsxs("section",{className:"card-shell p-6 admin-card admin-grid",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"Quick sections"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"What would you like to manage?"}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Pick a section below. Each panel only shows the tools needed for that part of the store."}),e.jsx("div",{className:"flex flex-wrap gap-3 mt-4",children:st.map(t=>e.jsx("button",{onClick:()=>tt(t.id),className:`admin-tab px-4 py-2 rounded-full text-sm font-semibold border transition ${V===t.id?"bg-[var(--primary)] text-white border-[var(--primary)] shadow-sm":"border-[var(--border)] text-[var(--muted)] hover:border-[var(--primary)] hover:text-[var(--ink)]"}`,children:t.label},t.id))})]}),V==="coupons"&&e.jsxs("section",{className:"card-shell p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"Promotions"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Coupon generator"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Create one-time or limited-use coupon codes with flat or percent discounts."})]})}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Code"}),e.jsx("input",{value:j.code,onChange:t=>H({...j,code:t.target.value}),placeholder:"FIRST123",className:"border rounded-xl px-4 py-3 w-full"}),e.jsx("label",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Discount type"}),e.jsxs("select",{value:j.discountType,onChange:t=>H({...j,discountType:t.target.value}),className:"border rounded-xl px-4 py-3 w-full",children:[e.jsx("option",{value:"flat",children:"Flat amount (₹)"}),e.jsx("option",{value:"percent",children:"Percent (%)"})]}),e.jsx("label",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Value"}),e.jsx("input",{type:"number",min:"1",value:j.value,onChange:t=>H({...j,value:t.target.value}),placeholder:"e.g. 500 or 10",className:"border rounded-xl px-4 py-3 w-full"}),e.jsx("label",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Max discount (optional, for %)"}),e.jsx("input",{type:"number",min:"0",value:j.maxDiscount,onChange:t=>H({...j,maxDiscount:t.target.value}),placeholder:"Cap for percent coupons",className:"border rounded-xl px-4 py-3 w-full"}),e.jsx("label",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Min order value (optional)"}),e.jsx("input",{type:"number",min:"0",value:j.minOrderValue,onChange:t=>H({...j,minOrderValue:t.target.value}),placeholder:"Apply only above this amount",className:"border rounded-xl px-4 py-3 w-full"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Max redemptions (overall)"}),e.jsx("input",{type:"number",min:"1",value:j.maxRedemptions,onChange:t=>H({...j,maxRedemptions:t.target.value}),className:"border rounded-xl px-4 py-3 w-full"}),e.jsx("label",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Expires at (optional)"}),e.jsx("input",{type:"datetime-local",value:j.expiresAt,onChange:t=>H({...j,expiresAt:t.target.value}),className:"border rounded-xl px-4 py-3 w-full"}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx("input",{type:"checkbox",checked:j.active,onChange:t=>H({...j,active:t.target.checked})}),"Active"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:jt,className:"bg-pink-600 text-white px-6 py-3 rounded-full",children:"Save coupon"}),e.jsx("button",{onClick:Re,className:"border border-gray-200 text-gray-600 px-4 py-3 rounded-full",children:"Clear"})]})]})]}),e.jsx("div",{className:"mt-8 overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-500",children:[e.jsx("th",{className:"py-2",children:"Code"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Value"}),e.jsx("th",{children:"Min"}),e.jsx("th",{children:"Used"}),e.jsx("th",{children:"Expires"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsxs("tbody",{children:[ve.map(t=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"py-2 font-semibold text-gray-900",children:t.code}),e.jsx("td",{children:t.discountType}),e.jsxs("td",{children:[t.discountType==="percent"?`${t.value}%`:`₹${t.value}`,t.maxDiscount?` (cap ₹${t.maxDiscount})`:""]}),e.jsxs("td",{children:["₹",t.minOrderValue||0]}),e.jsxs("td",{children:[t.redemptions||0," / ",t.maxRedemptions||1]}),e.jsx("td",{children:t.expiresAt?new Date(t.expiresAt).toLocaleString():"No expiry"}),e.jsx("td",{children:t.active?"Active":"Inactive"}),e.jsxs("td",{className:"space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>m.patch(`/coupons/${t._id}`,{active:!t.active},g).then(de).catch(()=>c.error("Update failed")),className:"text-xs text-pink-600",children:t.active?"Disable":"Enable"}),e.jsx("button",{type:"button",onClick:()=>window.confirm("Delete coupon?")&&m.delete(`/coupons/${t._id}`,g).then(de).catch(()=>c.error("Delete failed")),className:"text-xs text-red-500",children:"Delete"})]})]},t._id)),ve.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"py-4 text-center text-gray-400",children:"No coupons yet"})})]})]})})]}),V==="orders"&&e.jsxs("section",{className:"bg-white rounded-3xl shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"Orders"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Recent orders"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Update payment or delivery status from one place."})]}),e.jsx("button",{onClick:xe,className:"text-sm text-gray-500 underline",children:"Refresh"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-500",children:[e.jsx("th",{className:"py-2",children:"Order"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Shipping"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Payment"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Tracking"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[ce.map(t=>{var s,a;return e.jsxs("tr",{className:"border-t",children:[e.jsxs("td",{className:"py-2",children:[e.jsxs("p",{className:"font-semibold text-gray-900",children:["#",t._id.slice(-6).toUpperCase()]}),e.jsx("p",{className:"text-xs text-gray-400",children:new Date(t.createdAt).toLocaleString()}),e.jsxs("p",{className:"text-xs text-gray-500",children:[t.items.length," item(s)"]}),e.jsx("div",{className:"text-[11px] text-gray-500 space-y-1 mt-1",children:t.items.map((r,l)=>{var d,x,$;return e.jsxs("div",{className:"flex flex-wrap gap-1 items-center",children:[e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-gray-100 text-gray-800 border border-gray-200",children:((d=r.product)==null?void 0:d.name)||"Item"}),(((x=r.product)==null?void 0:x.productCode)||r.productCode)&&e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-blue-50 text-blue-800 border border-blue-100",children:(($=r.product)==null?void 0:$.productCode)||r.productCode}),r.selectedColor&&e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-amber-50 text-amber-800 border border-amber-100",children:r.selectedColor}),r.selectedSize&&e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-indigo-50 text-indigo-800 border border-indigo-100",children:r.selectedSize}),e.jsxs("span",{className:"text-gray-400",children:["×",r.quantity]})]},`${r.product}-${l}`)})})]}),e.jsx("td",{className:"text-xs text-gray-600",children:((s=t.user)==null?void 0:s.mobile)||t.customerContact||"NA"}),e.jsxs("td",{className:"text-xs text-gray-600 max-w-xs",children:[e.jsx("p",{className:"font-semibold text-gray-900",children:((a=t.shippingAddress)==null?void 0:a.name)||"—"}),e.jsx("p",{className:"text-gray-500",children:ot(t)}),t.customerNote&&e.jsxs("p",{className:"text-[11px] text-gray-400 mt-1",children:["Note: ",t.customerNote]})]}),e.jsxs("td",{className:"font-semibold text-gray-900",children:["₹",new Intl.NumberFormat("en-IN").format(t.amount||0)]}),e.jsx("td",{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("span",{className:"text-xs uppercase tracking-wide text-gray-500",children:t.paymentMethod}),e.jsx("select",{className:"border rounded-lg px-2 py-1 text-xs",value:t.paymentStatus,onChange:r=>le(t._id,{paymentStatus:r.target.value}),children:Yt.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))})]})}),e.jsx("td",{children:e.jsx("select",{className:"border rounded-lg px-2 py-1 text-xs",value:t.status,onChange:r=>le(t._id,{status:r.target.value}),children:Kt.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))})}),e.jsx("td",{className:"text-xs text-gray-600",children:e.jsxs("div",{className:"space-y-1",children:[(t.trackingLink||t.trackingNumber)&&e.jsx("a",{href:(t.trackingLink||t.trackingNumber||"").startsWith("http")?t.trackingLink||t.trackingNumber:void 0,target:"_blank",rel:"noreferrer",className:"text-[11px] text-pink-600 underline",children:"Open tracking"}),e.jsx("input",{type:"text",className:"border rounded-lg px-2 py-1 w-full",placeholder:"Paste tracking URL",defaultValue:t.trackingLink||"",onBlur:r=>le(t._id,{trackingLink:r.target.value.trim()})}),!t.trackingLink&&t.trackingNumber&&e.jsxs("p",{className:"text-[11px] text-gray-500",children:["Current: ",t.trackingNumber]})]})}),e.jsxs("td",{className:"text-right space-y-2",children:[t.paymentMethod==="UPI"&&t.upiIntent&&e.jsx("a",{href:t.upiIntent,target:"_blank",rel:"noreferrer",className:"text-xs text-pink-600",children:"UPI link"}),e.jsx("button",{type:"button",onClick:()=>ct(t._id),className:"block text-xs text-pink-600 underline",children:"Download bill"})]})]},t._id)}),ce.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"py-6 text-center text-gray-400",children:"No orders yet"})})]})]})})]}),V==="returns"&&e.jsxs("section",{className:"bg-white rounded-3xl shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"Returns"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Return requests"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Approve/reject and view photos sent by customers."})]}),e.jsx("button",{onClick:xe,className:"text-sm text-gray-500 underline",children:"Refresh"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-500",children:[e.jsx("th",{className:"py-2",children:"Order"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Reason"}),e.jsx("th",{children:"Photos"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Note"})]})}),e.jsxs("tbody",{children:[_e.map(t=>{var s,a,r;return e.jsxs("tr",{className:"border-t",children:[e.jsxs("td",{className:"py-2",children:[e.jsxs("p",{className:"font-semibold text-gray-900",children:["#",t._id.slice(-6).toUpperCase()]}),e.jsx("p",{className:"text-xs text-gray-400",children:new Date(t.createdAt).toLocaleString()}),e.jsxs("p",{className:"text-xs text-gray-500",children:[t.items.length," item(s)"]})]}),e.jsxs("td",{className:"text-xs text-gray-600",children:[((s=t.user)==null?void 0:s.mobile)||t.customerContact||"NA",e.jsxs("div",{className:"text-gray-500",children:[(a=t.shippingAddress)==null?void 0:a.name," ",(r=t.shippingAddress)==null?void 0:r.phone]})]}),e.jsxs("td",{className:"text-xs text-gray-600 max-w-xs",children:[e.jsx("p",{className:"font-semibold text-gray-900",children:t.returnReason||"No reason"}),t.returnNote&&e.jsxs("p",{className:"text-gray-500",children:["Note: ",t.returnNote]})]}),e.jsx("td",{className:"text-xs text-gray-600",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[(t.returnImages||[]).map((l,d)=>{const x=q(l);return e.jsx("a",{href:x,target:"_blank",rel:"noreferrer",className:"block w-16 h-16 rounded-lg overflow-hidden border border-gray-200",children:e.jsx("img",{src:x,alt:"return",className:"w-full h-full object-cover"})},d)}),(t.returnImages||[]).length===0&&e.jsx("span",{children:"None"})]})}),e.jsx("td",{children:e.jsx("select",{className:"border rounded-lg px-2 py-1 text-xs",value:t.returnStatus||"none",onChange:l=>le(t._id,{returnStatus:l.target.value}),children:["requested","approved","rejected","received","refunded"].map(l=>e.jsx("option",{value:l,children:l},l))})}),e.jsx("td",{className:"text-xs",children:e.jsx("textarea",{className:"border rounded-lg px-2 py-1 text-xs w-full",placeholder:"Return note",defaultValue:t.returnNote||"",onBlur:l=>le(t._id,{returnNote:l.target.value})})})]},t._id)}),_e.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"py-6 text-center text-gray-400",children:"No return requests yet"})})]})]})})]}),V==="products"&&e.jsxs(e.Fragment,{children:[e.jsxs("section",{className:"bg-white rounded-3xl shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"Catalog"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:E?"Edit product":"Create product"})]}),E&&e.jsx("button",{onClick:Ut,className:"text-sm text-gray-500 underline",children:"Cancel edit"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mt-6",children:[e.jsx("input",{value:o.name,onChange:t=>i({...o,name:t.target.value}),placeholder:"Product name",className:"border rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-pink-100"}),e.jsx("input",{value:o.productCode,onChange:t=>i({...o,productCode:t.target.value}),placeholder:"Internal product ID (for stock)",className:"border rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-pink-100"}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500",children:"Assign category"}),e.jsxs("select",{value:o.categoryRef,onChange:t=>i({...o,categoryRef:t.target.value}),className:"border rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-pink-100 w-full",children:[e.jsx("option",{value:"",children:"Select category"}),N.map(t=>e.jsx("option",{value:t._id,children:t.name},t._id))]})]}),e.jsx("input",{value:o.category,onChange:t=>i({...o,category:t.target.value}),placeholder:"Display label (ex. Banarasi, Poshaak)",className:"border rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-pink-100"}),e.jsx("input",{value:o.fabric,onChange:t=>i({...o,fabric:t.target.value}),placeholder:"Fabric",className:"border rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-pink-100"}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm text-gray-500",children:"Available colors (Saree / Suit)"}),o.colors.length>0&&e.jsxs("span",{className:"text-xs text-gray-400",children:[o.colors.length," selected"]})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-500 mt-2",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:K,onChange:t=>G(t.target.checked)}),"Suit product? Show size picker"]}),e.jsxs("span",{className:"text-[11px]",children:["Detected category: ",he?"Suit":"Other"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:Ge.map(t=>{const s=o.colors.includes(t.label),a=qe(t.label),r=typeof a=="string"&&a.startsWith("#")&&Xt(a)?"#1f2937":"#ffffff";return e.jsx("button",{type:"button",onClick:()=>ge(t.label),title:t.label,className:`px-3 py-2 rounded-full text-xs border transition shadow-sm ${s?"ring-2 ring-pink-200 border-pink-200":"border-gray-200"}`,style:{background:a,color:s?r:"#ffffff",minWidth:64,boxShadow:s?"0 4px 12px rgba(0,0,0,0.12)":"0 2px 6px rgba(0,0,0,0.06)"},children:t.label},t.label)})}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsx("input",{value:ee,onChange:t=>X(t.target.value),onKeyDown:t=>{t.key==="Enter"&&(t.preventDefault(),Ie())},placeholder:"Add custom color (press Enter)",className:"border rounded-xl px-4 py-3 flex-1 focus:outline-none focus:ring-2 focus:ring-pink-100"}),e.jsx("button",{type:"button",onClick:Ie,className:"px-4 py-3 rounded-xl bg-gray-900 text-white text-sm",children:"Add"})]}),e.jsx("input",{type:"file",multiple:!0,accept:"image/*",ref:u,className:"hidden",onChange:t=>lt(t.target.files)}),o.colors.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-3",children:o.colors.map(t=>e.jsxs("span",{className:"px-3 py-1 rounded-full border text-xs text-gray-700 flex items-center gap-2 shadow-sm",style:{background:qe(t),borderColor:"rgba(0,0,0,0.08)",color:"#1f2937"},children:[t,e.jsx("button",{type:"button",className:"text-gray-400",onClick:()=>ge(t),children:"×"})]},t))})]}),Ae&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm text-gray-500",children:"Available sizes (Suit)"}),o.sizes.length===0&&e.jsx("span",{className:"text-xs text-red-500",children:"Select sizes for suits"})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-500 mb-2",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:K,onChange:t=>G(t.target.checked)}),"Force show sizes (for suit products without “suit” in category name)"]}),e.jsxs("span",{children:["Detected: ",he?"Suit category":"Other"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:Qt.map(t=>{const s=o.sizes.includes(t);return e.jsx("button",{type:"button",onClick:()=>nt(t),className:`px-3 py-2 rounded-full text-xs border transition ${s?"bg-indigo-100 border-indigo-300 text-indigo-700":"bg-white border-gray-200 text-gray-600 hover:border-indigo-200"}`,children:t},t)})})]}),e.jsx("input",{value:o.amazonLink,onChange:t=>i({...o,amazonLink:t.target.value}),placeholder:"Amazon product link (optional)",className:"border rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-pink-100",type:"url"}),e.jsx("input",{value:o.flipkartLink,onChange:t=>i({...o,flipkartLink:t.target.value}),placeholder:"Flipkart product link (optional)",className:"border rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-pink-100",type:"url"}),e.jsx("input",{value:o.price,onChange:t=>i({...o,price:t.target.value}),placeholder:"Price (MRP)",className:"border rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-pink-100",type:"number"}),e.jsx("input",{value:o.discountPrice,onChange:t=>i({...o,discountPrice:t.target.value}),placeholder:"Selling price",className:"border rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-pink-100",type:"number"}),e.jsx("input",{value:o.stock,onChange:t=>i({...o,stock:t.target.value}),placeholder:"Stock",className:"border rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-pink-100",type:"number"})]}),e.jsx("textarea",{value:o.description,onChange:t=>i({...o,description:t.target.value}),placeholder:"Description / story",className:"border rounded-2xl px-4 py-3 w-full mt-4 focus:outline-none focus:ring-2 focus:ring-pink-100",rows:3}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mt-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500",children:"Existing image URLs (one per line)"}),e.jsx("textarea",{value:o.images,onChange:t=>i({...o,images:t.target.value}),className:"border rounded-2xl px-4 py-3 w-full focus:outline-none focus:ring-2 focus:ring-pink-100",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500",children:"Upload new images (select multiple)"}),e.jsx("input",{type:"file",multiple:!0,onChange:t=>_(Array.from(t.target.files)),className:"border rounded-xl px-4 py-3 w-full"}),B.length>0&&e.jsxs("div",{className:"text-xs text-gray-500 mt-2 space-y-1",children:[e.jsxs("p",{children:[B.length," new file(s) selected"]}),e.jsxs("ul",{className:"list-disc list-inside space-y-0.5",children:[B.slice(0,4).map(t=>e.jsx("li",{children:t.name},t.name)),B.length>4&&e.jsxs("li",{children:["+",B.length-4," more"]})]})]}),se.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsxs("p",{className:"text-xs text-gray-500",children:["Currently attached (",se.length,")"]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[se.slice(0,8).map((t,s)=>e.jsx("div",{className:"w-12 h-12 rounded-lg overflow-hidden border border-gray-200 bg-gray-50",children:e.jsx("img",{src:q(t),alt:"",className:"w-full h-full object-cover"})},`${t}-${s}`)),se.length>8&&e.jsxs("span",{className:"text-xs text-gray-400",children:["+",se.length-8," more"]})]})]})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"text-sm text-gray-500",children:"Attach to homepage collections (Sarees / Suits / Gold / Best Seller)"}),e.jsx("select",{multiple:!0,value:o.collectionIds,onChange:t=>i({...o,collectionIds:Array.from(t.target.selectedOptions,s=>s.value)}),className:"border rounded-xl px-4 py-3 w-full focus:outline-none focus:ring-2 focus:ring-pink-100 h-40",children:y.map(t=>e.jsx("option",{value:t._id,children:t.title},t._id))}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2 text-xs",children:[y.map(t=>e.jsxs("button",{type:"button",className:"px-3 py-1 border border-gray-200 rounded-full",onClick:()=>i(s=>s.collectionIds.includes(t._id)?s:{...s,collectionIds:[...s.collectionIds,t._id]}),children:["Add to ",t.title]},`quick-${t._id}`)),o.collectionIds.length>0&&e.jsx("button",{type:"button",className:"px-3 py-1 border border-gray-200 rounded-full text-gray-500",onClick:()=>i(t=>({...t,collectionIds:[]})),children:"Clear selections"})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"text-sm text-gray-500",children:"Attach to mood cards (home tiles)"}),e.jsx("select",{multiple:!0,value:O,onChange:t=>z(Array.from(t.target.selectedOptions,s=>s.value)),className:"border rounded-xl px-4 py-3 w-full focus:outline-none focus:ring-2 focus:ring-pink-100 h-32",children:C.map(t=>e.jsxs("option",{value:t._id,children:[t.title||"Untitled"," ",t.tag?`(${t.tag})`:""]},t._id))}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2 text-xs",children:[C.map(t=>e.jsxs("button",{type:"button",className:"px-3 py-1 border border-gray-200 rounded-full",onClick:()=>z(s=>s.includes(t._id)?s:[...s,t._id]),children:["Add to ",t.title||"Mood"]},`quick-mood-${t._id}`)),O.length>0&&e.jsx("button",{type:"button",className:"px-3 py-1 border border-gray-200 rounded-full text-gray-500",onClick:()=>z([]),children:"Clear mood selection"})]})]}),e.jsx("div",{className:"grid md:grid-cols-2 gap-4 mt-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500",children:"Product video URL (optional)"}),e.jsx("input",{value:o.video,onChange:t=>i({...o,video:t.target.value}),placeholder:"https://... (mp4 / hosted link)",className:"border rounded-xl px-4 py-3 w-full focus:outline-none focus:ring-2 focus:ring-pink-100"}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("input",{type:"file",accept:"video/*",className:"text-sm",onChange:t=>{var s;return Tt((s=t.target.files)==null?void 0:s[0])}}),ne&&e.jsx("span",{className:"text-xs text-gray-400",children:"Uploading..."})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Paste a hosted link or upload to store on server."})]})}),e.jsx("button",{onClick:Dt,className:"mt-6 bg-pink-600 text-white px-6 py-3 rounded-full",children:E?"Update product":"Create product"})]}),e.jsxs("section",{className:"bg-white rounded-3xl shadow p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"Live catalog"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Products"})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-500",children:[e.jsx("th",{className:"py-2",children:"Name"}),e.jsx("th",{children:"Price"}),e.jsx("th",{children:"Collections"}),e.jsx("th",{children:"Moods"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:h.map(t=>{var s;return e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"py-2",children:t.name}),e.jsx("td",{children:t.discountPrice||t.price}),e.jsx("td",{className:"text-xs text-gray-500",children:Bt((s=t.collections)==null?void 0:s.map(a=>a._id||a))}),e.jsx("td",{className:"text-xs text-gray-500",children:Ht(t._id)||"—"}),e.jsxs("td",{className:"text-right space-x-3",children:[e.jsx("button",{className:"text-pink-600",onClick:()=>Pt(t),children:"Edit"}),e.jsx("button",{className:"text-gray-400",onClick:()=>$t(t._id),children:"Delete"})]})]},t._id)})})]})})]})]}),V==="usp"&&e.jsxs("section",{className:"bg-white rounded-3xl shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"Offers rail"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Homepage offers"}),e.jsx("p",{className:"text-sm text-gray-500",children:"These cards show in the scrolling rail. Set order to control their position."})]}),e.jsx("button",{onClick:v,className:"text-sm text-gray-500 underline",children:"Refresh"})]}),e.jsx(ts,{items:Pe,onSave:xt,onDelete:ut})]}),V==="collections"&&e.jsxs("section",{className:"bg-white rounded-3xl shadow p-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"Homepage sections"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Collection studio"})]})}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mt-6",children:[e.jsx("input",{value:S.title,onChange:t=>F({...S,title:t.target.value}),placeholder:"Title",className:"border rounded-xl px-4 py-3"}),e.jsx("input",{value:S.slug,onChange:t=>F({...S,slug:t.target.value}),placeholder:"Slug (unique)",className:"border rounded-xl px-4 py-3"}),e.jsx("input",{value:S.subtitle,onChange:t=>F({...S,subtitle:t.target.value}),placeholder:"Subtitle",className:"border rounded-xl px-4 py-3"}),e.jsx("input",{value:S.ctaLabel,onChange:t=>F({...S,ctaLabel:t.target.value}),placeholder:"CTA Label",className:"border rounded-xl px-4 py-3"}),e.jsx("input",{value:S.heroImage,onChange:t=>F({...S,heroImage:t.target.value}),placeholder:"Hero image URL",className:"border rounded-xl px-4 py-3"}),e.jsx("input",{value:S.accentColor,onChange:t=>F({...S,accentColor:t.target.value}),placeholder:"Accent color",className:"border rounded-xl px-4 py-3"}),e.jsx("input",{value:S.priority,type:"number",onChange:t=>F({...S,priority:Number(t.target.value)}),placeholder:"Priority (lower first)",className:"border rounded-xl px-4 py-3"}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx("input",{type:"checkbox",checked:S.displayOnHome,onChange:t=>F({...S,displayOnHome:t.target.checked})}),"Display on homepage"]})]}),e.jsx("textarea",{value:S.description,onChange:t=>F({...S,description:t.target.value}),placeholder:"Description",className:"border rounded-2xl px-4 py-3 w-full mt-4",rows:3}),e.jsx("button",{onClick:Mt,className:"mt-4 bg-gray-900 text-white px-6 py-3 rounded-full",children:"Create collection"}),e.jsxs("div",{className:"mt-10 space-y-10 admin-collections",children:[y.length===0&&e.jsx("p",{className:"text-sm text-gray-500",children:"Create a collection to start building your home tiles."}),y.map(t=>e.jsxs("div",{className:"admin-collection-row",children:[e.jsx(ss,{collection:t,onSave:s=>re(t._id,s),onDelete:()=>Rt(t._id),onHeroUpload:s=>Ot(t._id,s),onGalleryUpload:s=>zt(t._id,s),onGalleryDelete:s=>Ft(t._id,s)}),e.jsx(as,{collection:t,products:h,onUpdate:s=>re(t._id,{products:s})})]},t._id))]})]}),V==="homepage"&&e.jsxs("section",{className:"bg-white rounded-3xl shadow p-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"Homepage slider"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Hero image manager"}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Upload multiple hero images at once and they will rotate on the storefront automatically."})]}),e.jsxs("div",{className:"mt-6 border border-gray-100 rounded-2xl p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:"Upload photos / videos"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Select one or more images or MP4/WebM clips."}),e.jsx("input",{type:"file",multiple:!0,accept:"image/*,video/*",className:"mt-3 text-sm",onChange:t=>{kt(t.target.files),t.target.value=""}})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:"Or paste an image / video link"}),e.jsxs("div",{className:"flex flex-col gap-2 md:flex-row mt-2",children:[e.jsx("input",{value:me,onChange:t=>we(t.target.value),placeholder:"https://example.com/hero.jpg or https://example.com/hero.mp4",className:"border rounded-xl px-4 py-2 text-sm flex-1"}),e.jsx("button",{onClick:St,className:"px-4 py-2 rounded-xl bg-gray-900 text-white text-sm",children:"Add slide"})]})]}),Ke&&e.jsx("p",{className:"text-xs text-gray-400",children:"Uploading..."})]}),e.jsxs("div",{className:"mt-8",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"Slides"}),e.jsxs("h3",{className:"text-xl font-semibold text-gray-900",children:[A.length," slide",A.length===1?"":"s"]})]})}),A.length===0?e.jsx("p",{className:"text-sm text-gray-500 mt-4",children:"No slides yet. Upload images to get started."}):e.jsx("div",{className:"grid md:grid-cols-2 gap-4 mt-4",children:A.map((t,s)=>e.jsx(Zt,{slide:t,index:s,isLast:s===A.length-1,onToggle:a=>_t(t._id,a),onDelete:()=>Lt(t._id),onMoveUp:()=>Oe(t._id,"up"),onMoveDown:()=>Oe(t._id,"down"),onReorder:a=>It(a,t._id)},t._id))})]}),Se.length>0&&e.jsxs("div",{className:"mt-6 bg-white border border-gray-100 rounded-2xl p-4 space-y-2",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Recent changes"}),e.jsx("ul",{className:"space-y-1 text-sm text-gray-700",children:Se.map((t,s)=>e.jsxs("li",{children:[e.jsx("span",{className:"text-gray-500 text-xs",children:new Date(t.ts).toLocaleTimeString()})," ",t.message]},`${t.ts}-${s}`))})]}),e.jsxs("div",{className:"mt-10 border-t pt-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"Featured edits"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Mood cards (home tiles)"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Add tiles like Saree / Suit / Jewellery. Set title, badge, link, and image."})]}),te&&e.jsx("button",{onClick:fe,className:"text-sm text-gray-500 underline",children:"Cancel edit"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mt-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Title"}),e.jsx("input",{value:U.title,onChange:t=>M(s=>({...s,title:t.target.value})),className:"border rounded-xl px-3 py-2 w-full",placeholder:"Saree"}),e.jsx("label",{className:"text-sm text-gray-600",children:"Subtitle"}),e.jsx("input",{value:U.subtitle,onChange:t=>M(s=>({...s,subtitle:t.target.value})),className:"border rounded-xl px-3 py-2 w-full",placeholder:"Pure zari woven"}),e.jsx("label",{className:"text-sm text-gray-600",children:"Badge / tag"}),e.jsx("input",{value:U.tag,onChange:t=>M(s=>({...s,tag:t.target.value})),className:"border rounded-xl px-3 py-2 w-full",placeholder:"Bestseller / New"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm text-gray-600",children:"CTA label"}),e.jsx("input",{value:U.ctaLabel,onChange:t=>M(s=>({...s,ctaLabel:t.target.value})),className:"border rounded-xl px-3 py-2 w-full",placeholder:"Shop sarees >"}),e.jsx("label",{className:"text-sm text-gray-600",children:"CTA link"}),e.jsx("input",{value:U.ctaLink,onChange:t=>M(s=>({...s,ctaLink:t.target.value})),className:"border rounded-xl px-3 py-2 w-full",placeholder:"/products or /collection/sarees"}),e.jsx("label",{className:"text-sm text-gray-600",children:"Display order"}),e.jsx("input",{type:"number",value:U.order,onChange:t=>M(s=>({...s,order:Number(t.target.value)})),className:"border rounded-xl px-3 py-2 w-full"})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mt-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Image URL"}),e.jsx("input",{value:U.image,onChange:t=>M(s=>({...s,image:t.target.value})),className:"border rounded-xl px-3 py-2 w-full",placeholder:"https://..."}),e.jsx("input",{type:"file",accept:"image/*",className:"mt-2 text-sm",onChange:t=>{var s;return yt((s=t.target.files)==null?void 0:s[0])}}),Ye&&e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Uploading..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Attach products"}),e.jsxs("div",{className:"flex gap-2 mt-1",children:[e.jsxs("select",{className:"border rounded-xl px-3 py-2 text-sm flex-1",value:"",onChange:t=>{const s=t.target.value;s&&M(a=>a.productIds.includes(s)?a:{...a,productIds:[...a.productIds,s]})},children:[e.jsx("option",{value:"",children:"Choose product"}),h.map(t=>e.jsx("option",{value:t._id,children:t.name},t._id))]}),e.jsx("span",{className:"text-xs text-gray-500 self-center",children:"Pick items to show when opening this edit."})]}),U.productIds.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:U.productIds.map(t=>{const s=h.find(a=>a._id===t);return e.jsxs("span",{className:"px-3 py-1 rounded-full bg-gray-100 text-xs text-gray-700 flex items-center gap-2",children:[(s==null?void 0:s.name)||"Product",e.jsx("button",{type:"button",className:"text-gray-500",onClick:()=>M(a=>({...a,productIds:a.productIds.filter(r=>r!==t)})),children:"×"})]},t)})})]})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-6",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-700",children:[e.jsx("input",{type:"checkbox",checked:U.active,onChange:t=>M(s=>({...s,active:t.target.checked}))}),"Active"]}),e.jsx("button",{onClick:ht,className:"px-5 py-3 bg-pink-600 text-white rounded-full text-sm font-semibold",children:te?"Update card":"Save card"})]}),e.jsxs("div",{className:"mt-6 grid md:grid-cols-3 gap-3",children:[C.map((t,s)=>e.jsx(es,{card:{...t,allProducts:h},index:s,isLast:s===C.length-1,onEdit:()=>gt(t),onDelete:()=>ft(t._id),onToggle:a=>m.put(`/home-sections/${t._id}`,{active:a},g).then(v).catch(()=>c.error("Could not update card")),onMoveUp:()=>Me(t._id,"up"),onMoveDown:()=>Me(t._id,"down"),onAddProduct:a=>bt(t._id,a),onDeleteProduct:a=>Ct(t._id,a),allProducts:h,onAddCustom:a=>Nt(t._id,a),onDeleteCustom:a=>vt(t._id,a),onUploadCustom:wt},t._id)),C.length===0&&e.jsx("p",{className:"text-sm text-gray-500",children:"No mood cards yet. Add up to 3 tiles."})]})]})]}),V==="login-visuals"&&e.jsxs("section",{className:"bg-white rounded-3xl shadow p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"Login page"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Side visuals"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Update the left and right images shown on the login screen. Leave blank to hide."})]})}),e.jsx("div",{className:"grid md:grid-cols-2 gap-4 mt-4",children:je.map((t,s)=>e.jsxs("div",{className:"border border-gray-100 rounded-2xl p-4 space-y-3",children:[e.jsxs("p",{className:"text-sm font-semibold text-gray-800",children:["Visual ",s===0?"Left":"Right"]}),e.jsx("label",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Title"}),e.jsx("input",{value:t.title,onChange:a=>ue(s,"title",a.target.value),className:"border rounded-xl px-3 py-2 w-full",placeholder:"Sequin night"}),e.jsx("label",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Subtitle"}),e.jsx("input",{value:t.subtitle,onChange:a=>ue(s,"subtitle",a.target.value),className:"border rounded-xl px-3 py-2 w-full",placeholder:"Cocktail sarees"}),e.jsx("label",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Image URL"}),e.jsx("input",{value:t.image,onChange:a=>ue(s,"image",a.target.value),className:"border rounded-xl px-3 py-2 w-full",placeholder:"https://..."}),e.jsx("input",{type:"file",accept:"image/*",className:"text-sm",onChange:a=>{var l;const r=(l=a.target.files)==null?void 0:l[0];pt(r,s),a.target.value=""}}),Qe&&e.jsx("p",{className:"text-xs text-gray-400",children:"Uploading..."}),t.image&&e.jsx("div",{className:"mt-2 rounded-xl overflow-hidden h-32 bg-gray-100",children:e.jsx("img",{src:q(t.image),alt:t.title,className:"w-full h-full object-cover"})})]},s))}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx("button",{onClick:dt,className:"px-5 py-3 bg-pink-600 text-white rounded-full text-sm font-semibold",children:"Save visuals"})})]})]})]})}function Zt({slide:n,index:f,isLast:w,onToggle:k,onDelete:h,onMoveUp:b,onMoveDown:y,onReorder:L}){var I;const N=q(n.video||n.heroVideo||((I=n.meta)==null?void 0:I.video)||""),D=q(n.image||n.heroImage||(Array.isArray(n.images)?n.images[0]:"")),o=N||D,i=n.active!==!1,u=!!N;return e.jsxs("div",{className:"border border-gray-200 rounded-2xl p-4 space-y-3 bg-white",draggable:!0,onDragStart:P=>P.dataTransfer.setData("text/plain",n._id),onDragOver:P=>P.preventDefault(),onDrop:P=>{P.preventDefault();const O=P.dataTransfer.getData("text/plain");O&&(L==null||L(O,n._id))},children:[e.jsx("div",{className:"rounded-xl overflow-hidden bg-gray-100 aspect-[16/9]",children:o?u?e.jsx("video",{src:o,poster:D||void 0,className:"w-full h-full object-cover",muted:!0,loop:!0,playsInline:!0,preload:"metadata"}):e.jsx("img",{src:o,alt:n.title||`Slide ${f+1}`,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-xs text-gray-400",children:"No media"})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:["Slide ",f+1]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Order ",n.order??f+1]})]}),o&&e.jsx("a",{href:o,target:"_blank",rel:"noreferrer",className:"text-xs text-pink-600",children:"View"})]}),u&&e.jsx("span",{className:"inline-block text-[11px] text-indigo-600 font-semibold",children:"Video slide"}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx("input",{type:"checkbox",checked:i,onChange:P=>k(P.target.checked)}),"Show on homepage"]}),(n.title||n.description)&&e.jsxs("div",{className:"text-xs text-gray-500",children:[n.title&&e.jsx("p",{className:"font-semibold",children:n.title}),n.description&&e.jsx("p",{children:n.description})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 text-sm",children:[e.jsx("button",{type:"button",onClick:b,disabled:f===0,className:`px-3 py-2 rounded-xl border ${f===0?"text-gray-300 border-gray-200 cursor-not-allowed":"text-gray-700 border-gray-300"}`,children:"Move up"}),e.jsx("button",{type:"button",onClick:y,disabled:w,className:`px-3 py-2 rounded-xl border ${w?"text-gray-300 border-gray-200 cursor-not-allowed":"text-gray-700 border-gray-300"}`,children:"Move down"}),e.jsx("button",{type:"button",onClick:h,className:"px-3 py-2 rounded-xl border border-red-200 text-red-600",children:"Delete"})]})]})}function es({card:n,index:f,isLast:w,onEdit:k,onDelete:h,onToggle:b,onMoveUp:y,onMoveDown:L,onAddProduct:N,onDeleteProduct:D,onAddCustom:o,onDeleteCustom:i,onUploadCustom:u,allProducts:I}){var z,B;p.useState({name:"",price:"",mrp:"",image:"",images:[]});const P=n.active!==!1,O=((z=n.meta)==null?void 0:z.products)||n.productIds||[];return(B=n.meta)!=null&&B.customProducts,e.jsxs("div",{className:"border border-gray-200 rounded-2xl p-3 space-y-2 bg-white shadow-sm",children:[e.jsx("div",{className:"rounded-xl overflow-hidden bg-gray-100 aspect-[4/5]",children:n.image?e.jsx("img",{src:q(n.image),alt:n.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-xs text-gray-400",children:"No image"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs uppercase tracking-[0.3em] text-gray-400 flex items-center gap-2",children:[n.tag||"Mood"," ",e.jsx("span",{className:"text-gray-300",children:"·"})," Order ",n.order??f+1]}),e.jsx("p",{className:"text-base font-semibold text-gray-900",children:n.title||"Untitled"}),n.subtitle&&e.jsx("p",{className:"text-sm text-gray-500",children:n.subtitle}),O.length>0&&e.jsxs("p",{className:"text-[11px] text-gray-500",children:[O.length," product",O.length===1?"":"s"]}),n.ctaLabel&&e.jsxs("p",{className:"text-[11px] text-pink-600 mt-1",children:[n.ctaLabel," → ",n.ctaLink||"/products"]})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx("input",{type:"checkbox",checked:P,onChange:_=>b(_.target.checked)}),"Active"]}),e.jsxs("div",{className:"flex flex-wrap gap-2 text-sm",children:[e.jsx("button",{onClick:k,className:"px-3 py-2 rounded-xl border border-gray-300 text-gray-700",children:"Edit"}),e.jsx("button",{onClick:y,disabled:f===0,className:`px-3 py-2 rounded-xl border ${f===0?"text-gray-300 border-gray-200 cursor-not-allowed":"text-gray-700 border-gray-300"}`,children:"Up"}),e.jsx("button",{onClick:L,disabled:w,className:`px-3 py-2 rounded-xl border ${w?"text-gray-300 border-gray-200 cursor-not-allowed":"text-gray-700 border-gray-300"}`,children:"Down"}),e.jsx("button",{onClick:h,className:"px-3 py-2 rounded-xl border border-red-200 text-red-600",children:"Delete"})]}),e.jsxs("div",{className:"space-y-2 text-xs text-gray-600",children:[e.jsx("p",{className:"font-semibold",children:"Attached products"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[O.length===0&&e.jsx("span",{className:"text-gray-400",children:"None"}),O.map(_=>{var ee,X,K,G,ne;return e.jsxs("span",{className:"px-3 py-1 rounded-full bg-gray-100 text-gray-700 flex items-center gap-2",children:[((X=(ee=n.products)==null?void 0:ee.find(Q=>Q._id===_))==null?void 0:X.name)||((ne=(G=(K=n.meta)==null?void 0:K.productsDetails)==null?void 0:G.find(Q=>Q._id===_))==null?void 0:ne.name)||_,e.jsx("button",{type:"button",className:"text-gray-500",onClick:()=>D(_),children:"×"})]},_)})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("select",{className:"border rounded-xl px-2 py-1 flex-1",value:"",onChange:_=>N(_.target.value),children:[e.jsx("option",{value:"",children:"Add product"}),(I||[]).map(_=>e.jsx("option",{value:_._id,children:_.name},_._id))]})})]})]})}function ts({items:n,onSave:f,onDelete:w}){const k={title:"",subtitle:"",tag:"",badge:"",ctaLabel:"",ctaLink:"/products",order:1,active:!0},[h,b]=p.useState(k),[y,L]=p.useState(null),N=i=>{L(i._id),b({title:i.title||"",subtitle:i.subtitle||"",tag:i.tag||"",badge:i.badge||"",ctaLabel:i.ctaLabel||"",ctaLink:i.ctaLink||"/products",order:i.order??1,active:i.active!==!1})},D=()=>{L(null),b(k)},o=()=>{f(h,y),D()};return e.jsxs("div",{className:"grid md:grid-cols-[1.1fr,0.9fr] gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{value:h.title,onChange:i=>b({...h,title:i.target.value}),placeholder:"Title (e.g. Flat 10% off)",className:"border rounded-xl px-3 py-2 w-full"}),e.jsx("input",{value:h.subtitle,onChange:i=>b({...h,subtitle:i.target.value}),placeholder:"Subtitle (e.g. Use code FEST10)",className:"border rounded-xl px-3 py-2 w-full"}),e.jsxs("div",{className:"grid sm:grid-cols-2 gap-3",children:[e.jsx("input",{value:h.tag,onChange:i=>b({...h,tag:i.target.value}),placeholder:"Tag (e.g. Limited)",className:"border rounded-xl px-3 py-2 w-full"}),e.jsx("input",{value:h.badge,onChange:i=>b({...h,badge:i.target.value}),placeholder:"Badge (e.g. Ends Sunday)",className:"border rounded-xl px-3 py-2 w-full"})]}),e.jsxs("div",{className:"grid sm:grid-cols-2 gap-3",children:[e.jsx("input",{value:h.ctaLabel,onChange:i=>b({...h,ctaLabel:i.target.value}),placeholder:"CTA label (e.g. Shop now)",className:"border rounded-xl px-3 py-2 w-full"}),e.jsx("input",{value:h.ctaLink,onChange:i=>b({...h,ctaLink:i.target.value}),placeholder:"CTA link (e.g. /products)",className:"border rounded-xl px-3 py-2 w-full"})]}),e.jsxs("div",{className:"grid sm:grid-cols-2 gap-3",children:[e.jsx("input",{type:"number",value:h.order,onChange:i=>b({...h,order:Number(i.target.value)}),placeholder:"Order (lower shows first)",className:"border rounded-xl px-3 py-2 w-full"}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx("input",{type:"checkbox",checked:h.active,onChange:i=>b({...h,active:i.target.checked})}),"Active"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:o,className:"px-4 py-2 bg-gray-900 text-white rounded-full",children:y?"Update offer":"Add offer"}),y&&e.jsx("button",{onClick:D,className:"text-sm text-gray-500 underline",children:"Cancel edit"})]})]}),e.jsxs("div",{className:"space-y-3",children:[n.map(i=>e.jsxs("div",{className:"border border-gray-200 rounded-2xl p-3 bg-white shadow-sm flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:[i.title," ",i.tag&&e.jsxs("span",{className:"text-xs text-gray-500",children:["• ",i.tag]})]}),i.subtitle&&e.jsx("p",{className:"text-xs text-gray-600",children:i.subtitle}),e.jsxs("div",{className:"flex gap-2 text-[11px] text-gray-500",children:[e.jsxs("span",{children:["Order ",i.order??0]}),e.jsx("span",{children:"•"}),e.jsx("span",{children:i.active===!1?"Hidden":"Active"})]}),(i.ctaLabel||i.ctaLink)&&e.jsxs("p",{className:"text-xs text-pink-600",children:[i.ctaLabel||"CTA"," → ",i.ctaLink||"/products"]})]}),e.jsxs("div",{className:"flex flex-col gap-1 text-xs",children:[e.jsx("button",{onClick:()=>N(i),className:"text-pink-600",children:"Edit"}),e.jsx("button",{onClick:()=>w(i._id),className:"text-red-500",children:"Delete"})]})]},i._id)),n.length===0&&e.jsx("p",{className:"text-sm text-gray-400",children:"No offers yet."})]})]})}function ss({collection:n,onSave:f,onDelete:w,onHeroUpload:k,onGalleryUpload:h,onGalleryDelete:b}){var D;const[y,L]=p.useState({title:n.title||"",slug:n.slug||"",subtitle:n.subtitle||"",description:n.description||"",ctaLabel:n.ctaLabel||"",heroImage:n.heroImage||"",tag:n.tag||"",order:n.order||0,active:n.active!==!1,displayOnHome:n.displayOnHome!==!1});p.useEffect(()=>{L({title:n.title||"",slug:n.slug||"",subtitle:n.subtitle||"",description:n.description||"",ctaLabel:n.ctaLabel||"",heroImage:n.heroImage||"",tag:n.tag||"",order:n.order||0,active:n.active!==!1,displayOnHome:n.displayOnHome!==!1})},[n]);const N=(o,i)=>L(u=>({...u,[o]:i}));return e.jsxs("div",{className:"admin-card bg-white border border-gray-100 rounded-2xl p-4 space-y-3 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-gray-400",children:"Collection"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:y.title||"Untitled"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>f(y),className:"px-3 py-2 rounded-xl bg-gray-900 text-white text-xs font-semibold",children:"Save"}),e.jsx("button",{onClick:()=>window.confirm("Delete this collection?")&&w(),className:"px-3 py-2 rounded-xl border border-red-200 text-red-600 text-xs",children:"Delete"})]})]}),e.jsxs("div",{className:"grid md:grid-cols-[1.3fr,1fr] gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"rounded-xl overflow-hidden bg-gray-100 aspect-[16/9]",children:y.heroImage?e.jsx("img",{src:q(y.heroImage),alt:y.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-xs text-gray-400",children:"No hero image"})}),e.jsxs("div",{className:"flex gap-2 text-xs text-gray-600",children:[e.jsxs("label",{className:"px-3 py-2 rounded-xl border border-gray-200 cursor-pointer bg-white",children:["Upload hero",e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:o=>{var u;const i=(u=o.target.files)==null?void 0:u[0];i&&k&&k(i),o.target.value=""}})]}),e.jsxs("label",{className:"px-3 py-2 rounded-xl border border-gray-200 cursor-pointer bg-white",children:["Upload gallery",e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:o=>{var u;const i=(u=o.target.files)==null?void 0:u[0];i&&h&&h(i),o.target.value=""}})]})]}),((D=n.heroImages)==null?void 0:D.length)>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.28em] text-gray-400",children:"Gallery images"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:n.heroImages.map(o=>e.jsxs("div",{className:"relative w-20 h-14 rounded-lg overflow-hidden border border-gray-200 bg-gray-50",children:[e.jsx("img",{src:q(o),alt:"",className:"w-full h-full object-cover"}),b&&e.jsx("button",{type:"button",className:"absolute -top-2 -right-2 w-6 h-6 rounded-full bg-white border text-[10px] shadow",onClick:()=>b(o),"aria-label":"Remove gallery image",children:"×"})]},o))})]})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsx("input",{value:y.title,onChange:o=>N("title",o.target.value),placeholder:"Title",className:"border rounded-xl px-3 py-2 w-full"}),e.jsx("input",{value:y.slug,onChange:o=>N("slug",o.target.value),placeholder:"Slug (unique)",className:"border rounded-xl px-3 py-2 w-full"}),e.jsx("input",{value:y.subtitle,onChange:o=>N("subtitle",o.target.value),placeholder:"Subtitle",className:"border rounded-xl px-3 py-2 w-full"}),e.jsx("input",{value:y.ctaLabel,onChange:o=>N("ctaLabel",o.target.value),placeholder:"CTA label",className:"border rounded-xl px-3 py-2 w-full"}),e.jsx("textarea",{value:y.description,onChange:o=>N("description",o.target.value),placeholder:"Description",className:"border rounded-xl px-3 py-2 w-full",rows:3}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsxs("label",{className:"flex items-center gap-2 text-xs text-gray-600",children:[e.jsx("input",{type:"checkbox",checked:y.active,onChange:o=>N("active",o.target.checked)}),"Active"]}),e.jsxs("label",{className:"flex items-center gap-2 text-xs text-gray-600",children:[e.jsx("input",{type:"checkbox",checked:y.displayOnHome,onChange:o=>N("displayOnHome",o.target.checked)}),"Show on home"]}),e.jsx("input",{type:"number",value:y.order,onChange:o=>N("order",Number(o.target.value)||0),className:"border rounded-xl px-2 py-1 text-xs w-24",placeholder:"Order"})]})]})]})]})}function as({collection:n,products:f,onUpdate:w}){const[k,h]=p.useState(""),[b,y]=p.useState(""),L=(n.products||[]).map(u=>typeof u=="string"?f.find(I=>I._id===u):u).filter(Boolean),N=L.map(u=>u._id),D=f.filter(u=>!N.includes(u._id)).filter(u=>{var I;return(I=u.name)==null?void 0:I.toLowerCase().includes(k.toLowerCase())});p.useEffect(()=>{h(""),y("")},[n==null?void 0:n._id]);const o=u=>{const I=N.filter(P=>P!==u);w(I)},i=()=>{if(!b)return;const u=[...N,b];w(u),y(""),h("")};return e.jsxs("div",{className:"border border-gray-100 rounded-3xl p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Linked products"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Attach items to this collection. They will appear on the homepage rail exactly in this order."}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"Add product"}),e.jsxs("div",{className:"flex flex-col gap-2 mt-2",children:[e.jsx("input",{value:k,onChange:u=>h(u.target.value),placeholder:"Search products",className:"border rounded-xl px-3 py-2 text-sm"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:b,onChange:u=>y(u.target.value),className:"border rounded-xl px-3 py-2 text-sm flex-1",children:[e.jsx("option",{value:"",children:"Choose product"}),D.slice(0,30).map(u=>e.jsx("option",{value:u._id,children:u.name},u._id))]}),e.jsx("button",{onClick:i,className:"px-4 py-2 rounded-xl bg-gray-900 text-white text-sm",children:"Add"})]}),D.length===0&&e.jsx("p",{className:"text-xs text-gray-400",children:"No more products match this search."})]})]}),e.jsxs("div",{className:"mt-6 space-y-3 max-h-[420px] overflow-y-auto pr-2",children:[L.length===0&&e.jsx("p",{className:"text-sm text-gray-400",children:"No products linked yet."}),L.map(u=>{var I;return e.jsxs("div",{className:"border border-gray-100 rounded-2xl p-3 flex items-center gap-3 bg-white",children:[e.jsx("div",{className:"w-16 h-16 rounded-xl overflow-hidden bg-gray-100 flex-shrink-0",children:e.jsx("img",{src:q((I=u.images)==null?void 0:I[0]),alt:u.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:u.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[(Ve(u)||u.category)&&e.jsxs("span",{children:[Ve(u)||u.category," • "]}),"Rs."," ",new Intl.NumberFormat("en-IN").format(u.discountPrice||u.price||0)]})]}),e.jsx("button",{onClick:()=>o(u._id),className:"text-xs text-gray-500",children:"Remove"})]},u._id)})]})]})}export{os as default};
