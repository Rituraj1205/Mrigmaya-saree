import{d as oe,r as d,C as ce,A as de,u as me,i as H,j as e,b as K,z as M}from"./index-9b45da5b.js";import{s as he}from"./seo-4fb2e452.js";const xe="data:image/gif;base64,R0lGODlhAQABAAD/ACw=",N=s=>`Rs. ${new Intl.NumberFormat("en-IN",{maximumFractionDigits:0}).format(s||0)}`,C=s=>K(s,""),V=s=>{var n;const r=(n=s==null?void 0:s.images)==null?void 0:n[0];return r?C(r):xe},fe=s=>K(s,"");function ve(){var Y;const{id:s}=oe(),{addToCart:r}=d.useContext(ce),{token:n}=d.useContext(de),i=me(),[a,b]=d.useState(null),[I,g]=d.useState(0),[p,L]=d.useState(!1),[Q,q]=d.useState([]),[B,J]=d.useState([]),[ee,D]=d.useState(!0),[$,O]=d.useState(""),[te,y]=d.useState(!1),[R,h]=d.useState(1.2),[F,E]=d.useState(""),[w,S]=d.useState(""),[W,z]=d.useState(""),x=((a==null?void 0:a.stock)||0)>0;if(d.useEffect(()=>{let t=!0;return D(!0),O(""),H.get(`/products/${s}`).then(l=>{var f;if(!t)return;b(l.data);const o=v(l.data),c=k(l.data);S(o[0]||""),z(c[0]||""),g(0);const u=Array.isArray((f=l.data)==null?void 0:f.reviews)?l.data.reviews:[];J(u)}).catch(l=>{var o;console.error("Product fetch failed",((o=l==null?void 0:l.response)==null?void 0:o.data)||(l==null?void 0:l.message)),t&&(O("Product not found or unavailable right now."),b(null))}).finally(()=>t&&D(!1)),()=>{t=!1}},[s]),d.useEffect(()=>{H.get("/products?includeInactive=true").then(t=>{var o;const l=Array.isArray(t.data)?t.data:((o=t.data)==null?void 0:o.products)||[];q(l)}).catch(()=>{})},[]),d.useEffect(()=>{if(!a)return;const t=a.name||"Product",l=a.description||a.subtitle||"Discover handcrafted sarees and curated edits from Mrigmaya.";he({title:`${t} | Mrigmaya`,description:l,image:V(a)})},[a]),d.useEffect(()=>{g(0)},[w]),ee)return e.jsx("div",{className:"p-6",children:"Loading..."});if($)return e.jsxs("div",{className:"p-6 space-y-3",children:[e.jsx("p",{className:"text-red-600 font-semibold",children:$}),e.jsx("button",{className:"px-4 py-2 bg-gray-900 text-white rounded-full",onClick:()=>i("/products"),children:"Back to products"})]});if(!a)return e.jsxs("div",{className:"p-6 space-y-3",children:[e.jsx("p",{className:"text-gray-600",children:"Product not found."}),e.jsx("button",{className:"px-4 py-2 bg-gray-900 text-white rounded-full",onClick:()=>i("/products"),children:"Back to products"})]});const m=pe(a,w),A=m[I]||C((Y=a.images)==null?void 0:Y[0])||"",se=()=>g(t=>m.length?(t-1+m.length)%m.length:0),ae=()=>g(t=>m.length?(t+1)%m.length:0),le=a.discountPrice||a.price,G=a.discountPrice&&a.price,T=G?Math.round((a.price-a.discountPrice)/a.price*100):null,j=B.length>0?B:[{author:"Happy customer",rating:5,comment:"Loved the drape and finish. Would buy again.",date:new Date().toISOString()}],re=j.reduce((t,l)=>t+(Number(l.rating)||0),0)/(j.length||1),ne="data:image/svg+xml;utf8,"+encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200" aria-label="Flipkart logo"><rect x="24" y="28" width="152" height="144" rx="16" fill="#ffd426"/><path d="M46 52h108c5 0 9 4 9 9v13H37V61c0-5 4-9 9-9z" fill="#fbc02d"/><path d="M62 64c12 16 32 16 44 0" fill="none" stroke="#e53935" stroke-width="6" stroke-linecap="round"/><path d="M106 64c12 16 32 16 44 0" fill="none" stroke="#00897b" stroke-width="6" stroke-linecap="round"/><circle cx="64" cy="54" r="4" fill="#6d4c41"/><circle cx="136" cy="54" r="4" fill="#6d4c41"/><path d="M82 96h25c10 0 14 6 12 16l-2 10c-1 6-5 10-10 12l9 30h-20l-7-26h-6l-6 26H58z" fill="#1976d2"/><path d="M105 110h9c2 0 3 2 3 4l-1 6c0 2-2 4-4 4h-9z" fill="#bbdefb"/></svg>'),Z=[{label:"Amazon",href:a.amazonLink,bg:"#232f3e",text:"#ffffff",logo:"https://upload.wikimedia.org/wikipedia/commons/a/a9/Amazon_logo.svg"},{label:"Flipkart",href:a.flipkartLink,bg:"#2874f0",text:"#ffffff",logo:ne}].filter(t=>t.href),P=Q.filter(t=>t._id!==a._id).filter(t=>{if(a.category&&t.category===a.category)return!0;const l=_(a.collections).map(c=>c._id||c),o=_(t.collections).map(c=>c._id||c);return l.some(c=>o.includes(c))}).slice(0,6),U=async t=>{const l=v(a),o=k(a),c=o.length>0,u=w||l[0]||"",f=W||(c?o[0]:"");if(c&&!f){M.error("Select a size");return}if(!x){M.error("This item is out of stock");return}S(u),z(f),L(!0);try{await r(a._id,u,f),t&&i("/checkout")}finally{L(!1)}},ie=async()=>{var c;const t=typeof window<"u"?window.location.href:"",l=(a==null?void 0:a.name)||"Mrigmaya",o=`${l} | Mrigmaya`;if(navigator.share)try{await navigator.share({title:l,text:o,url:t});return}catch{}(c=navigator.clipboard)!=null&&c.writeText?(await navigator.clipboard.writeText(t),M.success("Link copied")):window.prompt("Copy this product link",t)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-[#fefbfe] min-h-screen",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 lg:px-0 py-10 space-y-12",children:[e.jsxs("div",{className:"grid lg:grid-cols-[1.1fr,0.9fr] gap-10 items-start",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"relative rounded-3xl overflow-hidden bg-white shadow aspect-[3/4] min-h-[320px]",children:[A?e.jsx("img",{src:A,alt:a.name,className:"absolute inset-0 w-full h-full object-cover bg-white cursor-zoom-in",loading:"eager",fetchpriority:"high",decoding:"async",onClick:()=>{E(A),h(1.4),y(!0)}}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400 bg-white",children:"No image"}),m.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:se,className:"absolute left-3 top-1/2 -translate-y-1/2 bg-white/90 text-gray-800 rounded-full w-10 h-10 flex items-center justify-center shadow",children:"‹"}),e.jsx("button",{onClick:ae,className:"absolute right-3 top-1/2 -translate-y-1/2 bg-white/90 text-gray-800 rounded-full w-10 h-10 flex items-center justify-center shadow",children:"›"})]})]}),m.length>1&&e.jsx("div",{className:"flex gap-3 mt-4 overflow-x-auto",children:m.map((t,l)=>e.jsx("button",{onClick:()=>g(l),className:`w-20 h-20 rounded-2xl overflow-hidden border ${I===l?"border-pink-500":"border-gray-200"}`,children:e.jsx("img",{src:t,alt:a.name,className:"w-full h-full object-contain bg-white cursor-zoom-in",loading:"lazy",decoding:"async",onClick:()=>{E(t),h(1.4),y(!0)}})},`${t}-${l}`))}),a.video&&e.jsx("div",{className:"mt-4 bg-white rounded-2xl shadow border border-gray-100 overflow-hidden",children:e.jsx("video",{src:fe(a.video),controls:!0,className:"w-full h-[320px] object-cover bg-black",playsInline:!0})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:a.category}),e.jsx("h1",{className:"text-3xl font-semibold text-gray-900",children:a.name}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-3xl font-semibold text-gray-900",children:N(le)}),G&&e.jsx("span",{className:"text-gray-400 line-through",children:N(a.price)}),T&&e.jsxs("span",{className:"text-sm px-3 py-1 bg-red-100 text-red-600 rounded-full",children:["-",T,"%"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 text-xs text-gray-600",children:[e.jsx("span",{className:"px-3 py-1 rounded-full bg-emerald-50 text-emerald-700 border border-emerald-100",children:"Delivery in 4-7 days"}),e.jsx("span",{className:"px-3 py-1 rounded-full bg-indigo-50 text-indigo-700 border border-indigo-100",children:"Free returns within 7 days"}),e.jsx("span",{className:"px-3 py-1 rounded-full bg-amber-50 text-amber-700 border border-amber-100",children:"COD & UPI available"})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:ie,className:"px-4 py-2 rounded-full border border-[var(--border)] bg-white text-[var(--ink)] text-sm font-semibold shadow-sm hover:-translate-y-0.5 transition",children:"Share link"}),e.jsx("a",{href:`https://wa.me/?text=${encodeURIComponent(`${a.name||"Check this saree"} - ${typeof window<"u"?window.location.href:""}`)}`,target:"_blank",rel:"noreferrer",className:"px-4 py-2 rounded-full bg-[#25D366] text-white text-sm font-semibold shadow-sm hover:-translate-y-0.5 transition",children:"Share on WhatsApp"})]}),Z.length>0&&e.jsx("div",{className:"flex flex-wrap gap-3 pt-2",children:Z.map(t=>e.jsxs("a",{href:t.href,target:"_blank",rel:"noreferrer",className:"flex items-center gap-2 px-3 py-2 rounded-full text-sm font-semibold shadow-sm hover:-translate-y-0.5 transition",style:{background:t.bg,color:t.text},children:[e.jsx("img",{src:t.logo,alt:`${t.label} logo`,className:"h-6 w-auto object-contain",loading:"lazy",onError:l=>{l.currentTarget.style.display="none"}}),e.jsx("span",{className:"text-white tracking-tight",children:t.label})]},t.label))})]}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-700 bg-white rounded-3xl p-4 shadow",children:[a.description&&e.jsx("p",{className:"text-gray-600",children:a.description}),a.fabric&&e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Fabric:"})," ",a.fabric]}),e.jsx("p",{className:"font-semibold",children:"Colors:"}),v(a).length>0&&e.jsx("div",{className:"space-y-1",children:e.jsx("div",{className:"flex flex-wrap gap-3",children:v(a).map(t=>e.jsxs("button",{type:"button",onClick:()=>S(t),className:`px-3 py-2 rounded-full border text-sm flex items-center gap-2 shadow-sm transition ${w===t?"border-[var(--primary)] ring-2 ring-[var(--primary)]/20 bg-white":"border-gray-200 bg-[#fdfbf8]"}`,style:{minWidth:88},children:[e.jsx("span",{className:"inline-block w-5 h-5 rounded-full border",style:{background:ue(t),borderColor:"rgba(0,0,0,0.2)",boxShadow:"inset 0 0 0 1px rgba(255,255,255,0.45)"},title:t}),e.jsx("span",{className:"font-semibold capitalize truncate",children:t})]},t))})}),k(a).length>0&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"font-semibold",children:"Sizes:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:k(a).map(t=>e.jsx("button",{type:"button",onClick:()=>z(t),className:`px-3 py-1 rounded-full border text-xs font-semibold transition ${W===t?"bg-indigo-600 text-white border-indigo-600":"bg-indigo-50 text-indigo-800 border-indigo-100"}`,children:t},t))})]}),e.jsxs("p",{className:"font-semibold",children:["Stock:"," ",e.jsx("span",{className:x?"text-gray-700 font-normal":"text-red-600 font-semibold",children:x?a.stock:"Out of stock"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:()=>U(!1),className:"w-full bg-gray-900 text-white py-3 rounded-full font-semibold disabled:opacity-60",disabled:p||!x,children:p?"Adding...":x?"Add to cart":"Out of stock"}),e.jsx("button",{onClick:()=>U(!0),className:"w-full bg-gradient-to-r from-[var(--primary)] to-[var(--accent)] text-white py-3 rounded-full font-semibold disabled:opacity-60",disabled:p||!x,children:p?"Please wait...":x?"Buy now":"Out of stock"}),!n&&e.jsx("p",{className:"text-xs text-gray-500 text-center",children:"You will be asked to log in before checkout."})]})]})]}),e.jsxs("div",{className:"bg-white rounded-3xl shadow p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"Customer reviews"}),e.jsxs("div",{className:"flex items-center gap-2 text-lg font-semibold text-gray-900",children:[e.jsxs("span",{children:["★ ",re.toFixed(1)]}),e.jsxs("span",{className:"text-sm text-gray-500",children:["(",j.length,")"]})]})]}),e.jsx("button",{className:"px-4 py-2 rounded-full border border-gray-200 text-sm text-gray-700",children:"Write a review"})]}),e.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:j.slice(0,4).map((t,l)=>e.jsxs("div",{className:"border border-gray-100 rounded-2xl p-4 shadow-sm bg-[#fefbfe]",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-1 text-amber-500 text-sm",children:["★★★★★".slice(0,Math.max(1,Math.min(5,t.rating||5)))," "]}),e.jsx("span",{className:"text-xs text-gray-400",children:t.date?new Date(t.date).toLocaleDateString():""})]}),e.jsx("p",{className:"font-semibold text-gray-900 mt-2",children:t.author||"Customer"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t.comment})]},l))})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"You may also like"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Similar sarees"})]}),P.length>4&&e.jsx("button",{className:"text-sm text-pink-600 font-semibold",onClick:()=>i("/products"),children:"View all"})]}),P.length===0?e.jsx("p",{className:"text-sm text-gray-500",children:"More sarees will appear here soon."}):e.jsx("div",{className:"related-rail",children:P.map(t=>{const l=t.discountPrice||t.price,o=t.discountPrice&&t.price?Math.round((t.price-t.discountPrice)/t.price*100):null;return e.jsxs("article",{className:"related-card",onClick:()=>i(`/product/${t._id}`),children:[e.jsxs("div",{className:"related-card__image",children:[e.jsx("img",{src:V(t),alt:t.name,className:"w-full h-full object-cover",loading:"lazy",decoding:"async"}),o?e.jsxs("span",{className:"related-card__badge",children:["-",o,"%"]}):null]}),e.jsxs("div",{className:"related-card__body",children:[e.jsx("p",{className:"related-card__eyebrow",children:t.category||a.category}),e.jsx("h3",{className:"related-card__title line-clamp-2",children:t.name}),e.jsxs("div",{className:"related-card__price",children:[e.jsx("span",{className:"text-lg font-semibold text-gray-900",children:N(l)}),t.discountPrice&&e.jsx("span",{className:"text-gray-400 line-through",children:N(t.price)})]}),e.jsx("button",{type:"button",onClick:c=>{c.stopPropagation(),r(t._id)},className:"inline-flex items-center justify-center w-full mt-1 bg-gray-900 text-white text-sm font-semibold rounded-full px-4 py-2",children:"Add to cart"})]})]},t._id)})})]})]})}),te&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black/70 backdrop-blur-sm flex items-center justify-center px-4 py-6",onClick:()=>y(!1),children:e.jsxs("div",{className:"bg-white/5 border border-white/15 shadow-2xl rounded-2xl max-w-6xl w-full max-h-[90vh] flex flex-col",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-3 text-white/80 text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Zoom preview"}),e.jsx("span",{className:"text-xs opacity-80",children:"Click - / + or scroll to zoom"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"px-3 py-2 rounded-full bg-white/10 text-white hover:bg-white/20",onClick:()=>h(t=>Math.max(1,Number((t-.2).toFixed(1)))),children:"−"}),e.jsx("button",{className:"px-3 py-2 rounded-full bg-white/10 text-white hover:bg-white/20",onClick:()=>h(t=>Math.min(4,Number((t+.2).toFixed(1)))),children:"+"}),e.jsx("button",{className:"ml-2 px-3 py-2 rounded-full bg-white/15 text-white hover:bg-white/25",onClick:()=>{h(1.4),y(!1)},children:"Close"})]})]}),e.jsx("div",{className:"flex-1 overflow-auto px-4 py-4 bg-[#0b0a0a]/30",onWheel:t=>{t.preventDefault();const l=t.deltaY<0?.2:-.2;h(o=>{const c=o+l;return Math.min(4,Math.max(1,Number(c.toFixed(1))))})},children:F?e.jsx("img",{src:F,alt:"Zoomed",className:"block mx-auto rounded-xl shadow-2xl",style:{width:`${R*100}%`,maxWidth:`${R*100}%`,minWidth:"60%",transformOrigin:"center center"},onDoubleClick:()=>h(1.4),loading:"lazy",decoding:"async"}):null})]})})]})}const ge=[{label:"Red",swatch:"#e53935"},{label:"Pink",swatch:"#f06292"},{label:"Magenta",swatch:"#d81b60"},{label:"Maroon",swatch:"#7b1fa2"},{label:"Yellow",swatch:"#fbc02d"},{label:"Mustard",swatch:"#d3a518"},{label:"Orange",swatch:"#ff7043"},{label:"Peach",swatch:"#f8b195"},{label:"Green",swatch:"#43a047"},{label:"Olive",swatch:"#708238"},{label:"Mint",swatch:"#7bdcb5"},{label:"Sea Green",swatch:"#2e8b57"},{label:"Teal",swatch:"#009688"},{label:"Blue",swatch:"#1e88e5"},{label:"Navy",swatch:"#1b3b6f"},{label:"Purple",swatch:"#9c27b0"},{label:"Lavender",swatch:"#c6a5d8"},{label:"Brown",swatch:"#8d6e63"},{label:"Beige",swatch:"#d9c4a1"},{label:"Cream",swatch:"#f6e7c1"},{label:"Grey",swatch:"#9e9e9e"},{label:"Black",swatch:"#212121"},{label:"White",swatch:"#f5f5f5"},{label:"Gold",swatch:"#d4af37"},{label:"Silver",swatch:"#c0c0c0"},{label:"Multi",swatch:"linear-gradient(120deg, #e53935, #fbc02d, #43a047, #1e88e5, #9c27b0)"}],ue=s=>{const r=ge.find(n=>n.label.toLowerCase()===(s||"").toLowerCase());return(r==null?void 0:r.swatch)||"linear-gradient(135deg, #fdfcfb, #e2d1c3)"},be=s=>{var n,i;return[(s==null?void 0:s.name)||"",(s==null?void 0:s.category)||"",((n=s==null?void 0:s.categoryRef)==null?void 0:n.name)||"",((i=s==null?void 0:s.categoryRef)==null?void 0:i.slug)||"",..._(s==null?void 0:s.collections).map(a=>(a==null?void 0:a.title)||(a==null?void 0:a.slug)||"")].join(" ").toLowerCase().includes("suit")},v=s=>s?Array.isArray(s.colors)&&s.colors.length?s.colors.filter(Boolean):s.color?s.color.split(/[,\\n]/).map(r=>r.trim()).filter(Boolean):[]:[],k=s=>s?Array.isArray(s.sizes)&&s.sizes.length?s.sizes.filter(Boolean):be(s)?["XS","S","M","L","XL"]:[]:[];function _(s){return Array.isArray(s)?s:[]}const pe=(s,r)=>{if(!s)return[];const n=ye(s,r);return n.length?n.map(i=>C(i)):Array.isArray(s.images)&&s.images.length?s.images.map(i=>C(i)):[]},ye=(s,r)=>{const n=(r||"").toLowerCase();if(!n)return[];const a=we(s==null?void 0:s.colorImages).find(b=>(b.color||"").toLowerCase()===n);return(a==null?void 0:a.images)||[]},we=s=>Array.isArray(s)?s.map(r=>{if(!r)return null;const n=(r.color||"").trim(),i=X(r.images);return!n||!i.length?null:{color:n,images:i}}).filter(Boolean):s&&typeof s=="object"?Object.entries(s).map(([r,n])=>{const i=(r||"").trim(),a=X(n);return!i||!a.length?null:{color:i,images:a}}).filter(Boolean):[],X=s=>s?Array.isArray(s)?s.filter(Boolean):typeof s=="string"?s.split(/[,\\n]/).map(r=>r.trim()).filter(Boolean):[]:[];export{ve as default};
