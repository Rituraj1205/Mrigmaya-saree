import{r as p,A as Zt,u as es,z as i,i as u,j as e,N as ts,b as ss,a as as}from"./index-a1a7f1c8.js";const W=n=>ss(n,""),Xe="data:image/gif;base64,R0lGODlhAQABAAD/ACw=",rs=n=>as(n,Xe),Ge=(n="")=>{const f=n.split("?")[0].toLowerCase();return/\.(mp4|webm|ogg)$/.test(f)},Je=n=>n?Array.isArray(n.colors)&&n.colors.length?n.colors.join(", "):n.color||"":"",Ke=n=>{const f=Ye.find(C=>C.label.toLowerCase()===(n||"").toLowerCase());return(f==null?void 0:f.swatch)||"linear-gradient(135deg, #fdfcfb, #e2d1c3)"},ls=n=>{if(!(n!=null&&n.startsWith("#"))||n.length!==7&&n.length!==4)return!1;const f=n.length===4?`#${n[1]}${n[1]}${n[2]}${n[2]}${n[3]}${n[3]}`:n,C=parseInt(f.slice(1),16),_=C>>16&255,h=C>>8&255,b=C&255;return(_*299+h*587+b*114)/1e3>180},je={name:"",productCode:"",description:"",category:"",categoryRef:"",fabric:"",color:"",colors:[],sizes:[],amazonLink:"",flipkartLink:"",price:"",discountPrice:"",stock:"",images:"",colorImages:[],video:"",collectionIds:[]},Qe={title:"",slug:"",subtitle:"",description:"",ctaLabel:"",heroImage:"",accentColor:"#c1275a",displayOnHome:!0,priority:999},ns=[{value:"processing",label:"Processing"},{value:"packed",label:"Packed"},{value:"shipped",label:"Shipped"},{value:"delivered",label:"Delivered"},{value:"cancelled",label:"Cancelled"}],Ye=[{label:"Red",swatch:"#e53935"},{label:"Pink",swatch:"#f06292"},{label:"Magenta",swatch:"#d81b60"},{label:"Maroon",swatch:"#7b1fa2"},{label:"Yellow",swatch:"#fbc02d"},{label:"Mustard",swatch:"#d3a518"},{label:"Orange",swatch:"#ff7043"},{label:"Peach",swatch:"#f8b195"},{label:"Green",swatch:"#43a047"},{label:"Olive",swatch:"#708238"},{label:"Mint",swatch:"#7bdcb5"},{label:"Sea Green",swatch:"#2e8b57"},{label:"Teal",swatch:"#009688"},{label:"Blue",swatch:"#1e88e5"},{label:"Navy",swatch:"#1b3b6f"},{label:"Purple",swatch:"#9c27b0"},{label:"Lavender",swatch:"#c6a5d8"},{label:"Brown",swatch:"#8d6e63"},{label:"Beige",swatch:"#d9c4a1"},{label:"Cream",swatch:"#f6e7c1"},{label:"Grey",swatch:"#9e9e9e"},{label:"Black",swatch:"#212121"},{label:"White",swatch:"#f5f5f5"},{label:"Gold",swatch:"#d4af37"},{label:"Silver",swatch:"#c0c0c0"},{label:"Multi",swatch:"linear-gradient(120deg, #e53935, #fbc02d, #43a047, #1e88e5, #9c27b0)"}],os=["XS","S","M","L","XL"],cs=[{value:"cod_pending",label:"Awaiting COD"},{value:"awaiting_upi",label:"Awaiting UPI"},{value:"awaiting_gateway",label:"Awaiting gateway"},{value:"paid",label:"Paid"},{value:"cancelled",label:"Cancelled"}];function fs(){const{token:n,user:f,logout:C}=p.useContext(Zt),_=es(),[h,b]=p.useState([]),[y,U]=p.useState([]),[N,$]=p.useState([]),[o,c]=p.useState(je),m=p.useRef(null),[A,B]=p.useState(""),[z,R]=p.useState([]),[k,w]=p.useState([]),[ee,Q]=p.useState(""),[X,G]=p.useState(!1),[oe,Y]=p.useState(!1),[H,me]=p.useState(null),[I,E]=p.useState(Qe),[q,Ze]=p.useState([]),[Ne,ve]=p.useState([{_id:null,title:"",subtitle:"",image:""},{_id:null,title:"",subtitle:"",image:""}]),[we,et]=p.useState([]),[j,V]=p.useState({code:"",discountType:"flat",value:"",maxDiscount:"",maxRedemptions:1,expiresAt:"",minOrderValue:"",active:!0}),[he,Ce]=p.useState(""),[tt,ce]=p.useState(!1),[st,ke]=p.useState(!1),[Se,ge]=p.useState(!0),[_e,Ie]=p.useState(!1),[M,O]=p.useState({title:"",subtitle:"",tag:"",ctaLabel:"",ctaLink:"/products",image:"",order:1,active:!0,productIds:[]}),[te,Le]=p.useState(null),[at,ie]=p.useState(!1),[Ae,rt]=p.useState([]),[de,lt]=p.useState([]),De=p.useMemo(()=>de.filter(t=>t.returnRequested||t.returnStatus&&t.returnStatus!=="none"),[de]),se=p.useMemo(()=>(o.images||"").split(/[\n,]/).map(t=>t.trim()).filter(Boolean),[o.images]),J=p.useMemo(()=>N.find(t=>t._id===o.categoryRef),[N,o.categoryRef]),fe=p.useMemo(()=>`${(J==null?void 0:J.name)||""} ${(J==null?void 0:J.slug)||""} ${o.category||""}`.toLowerCase().trim(),[o.category,J]).includes("suit"),[F,nt]=p.useState("collections"),ot=[{id:"collections",label:"Collections"},{id:"products",label:"Products"},{id:"coupons",label:"Coupons"},{id:"homepage",label:"Homepage Slider"},{id:"usp",label:"Offers Rail"},{id:"orders",label:"Orders"},{id:"returns",label:"Returns"},{id:"login-visuals",label:"Login visuals"}],g=p.useMemo(()=>({headers:{Authorization:`Bearer ${n||localStorage.getItem("token")||""}`}}),[n]),K=t=>{rt(s=>[{message:t,ts:new Date().toISOString()},...s].slice(0,15))},Pe=(t,s=2)=>{var r;if(!t)return!1;if(!((r=t.type)!=null&&r.startsWith("image/")))return i.error("Please upload an image file"),!1;const a=s*1024*1024;return t.size>a?(i.error(`Image too large. Max ${s}MB allowed.`),!1):!0},ct=(t,s=50)=>{var x,d;if(!t)return!1;const a=(x=t.type)==null?void 0:x.startsWith("image/"),r=(d=t.type)==null?void 0:d.startsWith("video/");if(!a&&!r)return i.error("Upload an image or video"),!1;const l=s*1024*1024;return t.size>l?(i.error(`File too large. Max ${s}MB allowed.`),!1):!0},ye=t=>{c(s=>{const a=s.colors||[],l=a.includes(t)?a.filter(x=>x!==t):[...a,t];return{...s,colors:l,color:l[0]||""}}),setTimeout(()=>{var s;B(t),(s=m.current)==null||s.click()},0)},it=(t,s=[])=>{!t||!s.length||c(a=>{const r=[...a.colorImages||[]],l=r.findIndex(x=>(x.color||"").toLowerCase()===t.toLowerCase());if(l>=0){const x=r[l].images||[];r[l]={...r[l],color:t,images:[...x,...s]}}else r.push({color:t,images:s});return{...a,colorImages:r}})},dt=async t=>{if(!A||!(t!=null&&t.length))return;const s=[];for(const a of Array.from(t)){const r=await Be(a);r&&s.push(r)}s.length&&it(A,s),B(""),m.current&&(m.current.value="")},Ue=()=>{const t=ee.trim();t&&(ye(t),Q(""))},xt=t=>{c(s=>{const a=s.sizes||[],l=a.includes(t)?a.filter(x=>x!==t):[...a,t];return{...s,sizes:l}})},$e=fe||X||(o.sizes||[]).length>0,ut=t=>{const s=(t==null?void 0:t.shippingAddress)||{},a=[s.name,s.phone||t.customerContact,s.line1,s.line2,[s.city,s.state].filter(Boolean).join(", "),s.pincode].filter(Boolean);return a.length===0?"No address":a.join(" | ")};p.useEffect(()=>{if(!n){_("/admin/login");return}(f==null?void 0:f.role)!=="admin"&&(i.error("Admin access only"),_("/"))},[n,f,_]),p.useEffect(()=>{n&&(ae(),Z(),v(),pt(),xe(),ue(),Vt())},[n]),p.useEffect(()=>{v()},[]);const ae=async()=>{try{const t=await u.get("/products?includeInactive=true");b(t.data)}catch(t){console.error(t)}},Z=async()=>{try{const t=await u.get("/collections?includeProducts=true");U(t.data)}catch(t){console.error(t)}},pt=async()=>{if(n)try{const t=await u.get("/categories/all",g);$(t.data||[])}catch(t){console.error(t)}},xe=async()=>{if(n)try{const t=await u.get("/coupons",g);et(t.data||[])}catch(t){console.error(t)}},ue=async()=>{if(n)try{const s=(await u.get("/orders",g)).data||{};lt(Array.isArray(s.orders)?s.orders:Array.isArray(s)?s:[])}catch(t){console.error(t)}},mt=async t=>{try{const s=await u.get(`/orders/${t}/invoice`,{...g,responseType:"blob"}),a=new Blob([s.data],{type:"application/pdf"}),r=window.URL.createObjectURL(a),l=document.createElement("a");l.href=r,l.download=`invoice-${t.slice(-6)}.pdf`,document.body.appendChild(l),l.click(),l.remove(),window.URL.revokeObjectURL(r)}catch(s){console.error(s),i.error("Could not download invoice")}},v=async()=>{var t;try{const s=await u.get("/home-sections?includeInactive=true");Ze(s.data)}catch(s){console.error("Home sections fetch failed",((t=s==null?void 0:s.response)==null?void 0:t.data)||s.message),i.error("Could not load homepage cards")}},L=p.useMemo(()=>[...q.filter(t=>t.group==="hero")].sort((t,s)=>(t.order??0)-(s.order??0)),[q]),Me=p.useMemo(()=>L.length?Math.max(...L.map(t=>t.order??0)):0,[L]);p.useEffect(()=>{const t=[...q.filter(a=>{var r;return a.group==="custom"&&((r=a.meta)==null?void 0:r.loginSlot)!==void 0})].sort((a,r)=>{var l,x;return(((l=a.meta)==null?void 0:l.loginSlot)??0)-(((x=r.meta)==null?void 0:x.loginSlot)??0)}),s=[0,1].map(a=>{const r=t.find(l=>{var x;return Number((x=l.meta)==null?void 0:x.loginSlot)===a});return{_id:(r==null?void 0:r._id)||null,title:(r==null?void 0:r.title)||"",subtitle:(r==null?void 0:r.subtitle)||"",image:(r==null?void 0:r.image)||""}});ve(s)},[q]);const pe=(t,s,a)=>{ve(r=>{const l=[...r];return l[t]={...l[t],[s]:a},l})},ht=async()=>{try{await Promise.all(Ne.map(async(s,a)=>{const r={group:"custom",title:s.title,subtitle:s.subtitle,image:s.image,order:a,active:!0,meta:{...s.meta||{},loginSlot:a}};if(s._id){if(!s.image){await u.delete(`/home-sections/${s._id}`,g);return}await u.put(`/home-sections/${s._id}`,r,g)}else s.image&&await u.post("/home-sections",r,g)}))&&(i.success("Login visuals saved"),v())}catch(t){console.error(t),i.error("Could not save visuals")}},gt=async(t,s)=>{var r;if(!((r=t.title)!=null&&r.trim())){i.error("Enter a title for the offer");return}const a={...t,group:"usp",order:Number(t.order)||Re.length+1};try{s?(await u.put(`/home-sections/${s}`,a,g),i.success("Offer updated")):(await u.post("/home-sections",a,g),i.success("Offer added")),v()}catch(l){console.error(l),i.error("Could not save offer")}},ft=async t=>{if(window.confirm("Delete this offer?"))try{await u.delete(`/home-sections/${t}`,g),i.success("Deleted"),v()}catch(s){console.error(s),i.error("Could not delete offer")}},yt=async(t,s)=>{if(Pe(t)&&t){ke(!0);try{const a=new FormData;a.append("file",t);const l=(await u.post("/uploads",a,{headers:{...g.headers,"Content-Type":"multipart/form-data"}})).data.url;pe(s,"image",l),i.success("Image uploaded")}catch(a){console.error(a),i.error("Upload failed")}finally{ke(!1)}}},S=p.useMemo(()=>[...q.filter(t=>t.group==="category")].sort((t,s)=>(t.order??0)-(s.order??0)),[q]),Re=p.useMemo(()=>[...q.filter(t=>t.group==="usp")].sort((t,s)=>(t.order??0)-(s.order??0)),[q]);p.useEffect(()=>{if(!H){R([]);return}const t=h.find(a=>a._id===H);if(!t)return;const s=S.filter(a=>{var l;return(((l=a.meta)==null?void 0:l.products)||a.productIds||[]).includes(t._id)}).map(a=>a._id);R(s)},[H,h,S]);const Oe=async t=>{if(!Pe(t))return null;const s=new FormData;return s.append("file",t),(await u.post("/uploads",s,{headers:{Authorization:`Bearer ${n}`,"Content-Type":"multipart/form-data"}})).data.url},bt=async t=>{if(!ct(t,25))return null;const s=new FormData;return s.append("file",t),(await u.post("/uploads",s,{headers:{Authorization:`Bearer ${n}`,"Content-Type":"multipart/form-data"}})).data.url},be=()=>{O({title:"",subtitle:"",tag:"",ctaLabel:"",ctaLink:"/products",image:"",order:1,active:!0,productIds:[]}),Le(null)},ze=async(t,s)=>{await u.post("/home-sections",{group:"hero",...t,order:s,active:!0},g)},jt=async()=>{if(!M.title.trim()){i.error("Enter a title");return}if(!M.image.trim()){i.error("Add an image");return}const t={...M,order:Number(M.order)||S.length+1,group:"category"};t.meta={...t.meta||{},products:M.productIds||[]};try{te?(await u.put(`/home-sections/${te}`,t,g),i.success("Card updated")):(await u.post("/home-sections",t,g),i.success("Card added")),be(),v()}catch(s){console.error(s),i.error("Could not save card")}},Nt=t=>{var s;Le(t._id),O({title:t.title||"",subtitle:t.subtitle||"",tag:t.tag||"",ctaLabel:t.ctaLabel||"",ctaLink:t.ctaLink||"/products",image:t.image||"",order:t.order??1,active:t.active!==!1,productIds:((s=t.meta)==null?void 0:s.products)||t.productIds||[]})},vt=async t=>{if(window.confirm("Delete this card?"))try{await u.delete(`/home-sections/${t}`,g),i.success("Card deleted"),te===t&&be(),v()}catch(s){console.error(s),i.error("Could not delete card")}},Ee=async(t,s)=>{const a=S.findIndex(d=>d._id===t);if(a===-1)return;const r=s==="up"?a-1:a+1;if(r<0||r>=S.length)return;const l=S[a],x=S[r];try{await Promise.all([u.put(`/home-sections/${l._id}`,{order:x.order??r},g),u.put(`/home-sections/${x._id}`,{order:l.order??a},g)]),v()}catch(d){console.error(d),i.error("Could not reorder cards")}},wt=async t=>{if(t)try{ie(!0);const s=await Oe(t);O(a=>({...a,image:s})),i.success("Image uploaded")}catch(s){console.error(s),i.error("Upload failed")}finally{ie(!1)}},Ct=async(t,s)=>{var l;if(!s)return;const a=S.find(x=>x._id===t),r=((l=a==null?void 0:a.meta)==null?void 0:l.products)||(a==null?void 0:a.productIds)||[];if(!r.includes(s))try{await u.put(`/home-sections/${t}`,{meta:{...a.meta||{},products:[...r,s]}},g),v()}catch(x){console.error(x),i.error("Could not attach product")}},Fe=()=>{V({code:"",discountType:"flat",value:"",maxDiscount:"",maxRedemptions:1,expiresAt:"",active:!0})},kt=async()=>{var t,s;if(!j.code.trim()||!j.value){i.error("Code and value are required");return}try{await u.post("/coupons",{...j,code:j.code.trim().toUpperCase(),value:Number(j.value),maxDiscount:j.maxDiscount?Number(j.maxDiscount):void 0,maxRedemptions:j.maxRedemptions?Number(j.maxRedemptions):1},g),i.success("Coupon saved"),Fe(),xe()}catch(a){i.error(((s=(t=a.response)==null?void 0:t.data)==null?void 0:s.msg)||"Could not save coupon")}},St=async(t,s)=>{var He,Ve,We,qe;const a=S.find(T=>T._id===t),r=Array.isArray(s.images)&&s.images.length?s.images:[s.image||""],l=new FormData;l.append("name",s.name||"Custom item"),l.append("description",`Custom product for ${(a==null?void 0:a.title)||"edit"}`),l.append("category",(a==null?void 0:a.title)||"Custom"),l.append("price",Number(s.mrp||s.price||0));const x=Number(s.price||0),d=Number(s.mrp||0);d>x&&x>0&&(l.append("discountPrice",x),l.append("price",d)),l.append("stock",50),l.append("images",r.filter(Boolean).join(`
`));let P=s.productId;try{P=((He=(await u.post("/products",l,{headers:{Authorization:`Bearer ${n}`,"Content-Type":"multipart/form-data"}})).data)==null?void 0:He._id)||P,i.success("Product created & attached"),ae()}catch(T){console.error("Custom product creation failed",T),i.error("Could not create product for this item");return}const ne=((Ve=a==null?void 0:a.meta)==null?void 0:Ve.products)||(a==null?void 0:a.productIds)||[],Yt=[...(((We=a==null?void 0:a.meta)==null?void 0:We.productsDetails)||[]).filter(T=>(T==null?void 0:T._id)!==P),{_id:P,name:s.name||"Custom item"}];try{await u.put(`/home-sections/${t}`,{meta:{...a.meta||{},products:[...new Set([...ne,P])],productsDetails:Yt,customProducts:((qe=a==null?void 0:a.meta)==null?void 0:qe.customProducts)||[]}},g),v()}catch(T){console.error(T),i.error("Could not attach product to this card")}},_t=async(t,s)=>{var x;const a=S.find(d=>d._id===t),l=(((x=a==null?void 0:a.meta)==null?void 0:x.customProducts)||[]).filter((d,D)=>D!==s);try{await u.put(`/home-sections/${t}`,{meta:{...a.meta||{},customProducts:l}},g),v()}catch(d){console.error(d),i.error("Could not remove product")}},It=async t=>{if(!t)return"";try{return ie(!0),await Oe(t)}catch(s){return console.error(s),i.error("Upload failed"),""}finally{ie(!1)}},Lt=async(t,s)=>{var x;const a=S.find(d=>d._id===t),l=(((x=a==null?void 0:a.meta)==null?void 0:x.products)||(a==null?void 0:a.productIds)||[]).filter(d=>d!==s);try{await u.put(`/home-sections/${t}`,{meta:{...a.meta||{},products:l}},g),v()}catch(d){console.error(d),i.error("Could not remove product")}},At=async t=>{var s,a,r;if(t!=null&&t.length){ce(!0);try{let l=Me+1;for(const x of Array.from(t)){const d=await bt(x);if(!d)continue;const D=(s=x.type)!=null&&s.startsWith("video/")||Ge(d)?{video:d}:{image:d};await ze(D,l),l+=1}i.success("Slides added"),K("Added hero slides via upload"),v()}catch(l){console.error(l),i.error(((r=(a=l.response)==null?void 0:a.data)==null?void 0:r.msg)||"Could not upload slides")}finally{ce(!1)}}},Dt=async()=>{if(he.trim()){ce(!0);try{const t=he.trim(),s=Ge(t)?{video:t}:{image:t};await ze(s,Me+1),Ce(""),i.success("Slide added"),K("Added hero slide via link"),v()}catch(t){console.error(t),i.error("Could not save slide")}finally{ce(!1)}}},Pt=async(t,s)=>{try{await u.put(`/home-sections/${t}`,{active:s},g),K(`Slide ${s?"enabled":"disabled"}`),v()}catch(a){console.error(a),i.error("Could not update slide")}},Ut=async(t,s)=>{const a=L.find(l=>l._id===t),r={...(a==null?void 0:a.meta)||{},showOnMobile:s};try{await u.put(`/home-sections/${t}`,{meta:r},g),K(`Slide ${s?"shown":"hidden"} on mobile`),v()}catch(l){console.error(l),i.error("Could not update mobile visibility")}},$t=async t=>{if(window.confirm("Delete this slide?"))try{await u.delete(`/home-sections/${t}`,g),i.success("Slide removed"),K("Removed a hero slide"),v()}catch(s){console.error(s),i.error("Could not delete slide")}},Te=async(t,s)=>{const a=L.findIndex(d=>d._id===t);if(a===-1)return;const r=s==="up"?a-1:a+1;if(r<0||r>=L.length)return;const l=L[a],x=L[r];try{await Promise.all([u.put(`/home-sections/${l._id}`,{order:x.order??r},g),u.put(`/home-sections/${x._id}`,{order:l.order??a},g)]),K("Reordered hero slides"),v()}catch(d){console.error(d),i.error("Could not reorder slides")}},Mt=async(t,s)=>{if(!t||!s||t===s)return;const a=L.findIndex(d=>d._id===t),r=L.findIndex(d=>d._id===s);if(a===-1||r===-1)return;const l=L[a],x=L[r];try{await Promise.all([u.put(`/home-sections/${l._id}`,{order:x.order??r},g),u.put(`/home-sections/${x._id}`,{order:l.order??a},g)]),K("Reordered hero slides (drag)"),v()}catch(d){console.error(d),i.error("Could not reorder slides")}},Rt=async(t,s=[])=>{const a=[];S.forEach(r=>{var D;const l=((D=r.meta)==null?void 0:D.products)||r.productIds||[],x=l.includes(t),d=s.includes(r._id);if(d&&!x&&a.push(u.put(`/home-sections/${r._id}`,{meta:{...r.meta||{},products:[...l,t]}},g)),!d&&x){const P=l.filter(ne=>ne!==t);a.push(u.put(`/home-sections/${r._id}`,{meta:{...r.meta||{},products:P}},g))}}),a.length&&(await Promise.all(a),v())},Ot=async()=>{var t,s,a,r;try{if($e&&(o.sizes||[]).length===0){i.error("Select at least one size for suits");return}const l=new FormData;l.append("name",o.name),o.productCode&&l.append("productCode",o.productCode.trim()),l.append("description",o.description),l.append("category",o.category),o.categoryRef&&l.append("categoryRef",o.categoryRef),l.append("fabric",o.fabric);const x=(o.colors||[]).join(",").trim();l.append("color",x||o.color||""),l.append("colors",(o.colors||[]).join(",")),l.append("sizes",(o.sizes||[]).join(",")),l.append("price",o.price||0),o.discountPrice&&l.append("discountPrice",o.discountPrice),l.append("stock",o.stock||0),o.amazonLink&&l.append("amazonLink",o.amazonLink.trim()),o.flipkartLink&&l.append("flipkartLink",o.flipkartLink.trim()),l.append("images",o.images),(t=o.colorImages)!=null&&t.length&&l.append("colorImages",JSON.stringify(o.colorImages)),o.video&&l.append("video",o.video),l.append("collections",o.collectionIds.join(",")),k.forEach(P=>l.append("images",P));const d={headers:{Authorization:`Bearer ${n}`,"Content-Type":"multipart/form-data"}};let D=H;H?(await u.put(`/products/${H}`,l,d),i.success("Product updated")):(D=((s=(await u.post("/products",l,d)).data)==null?void 0:s._id)||D,i.success("Product created")),D&&await Rt(D,z),c(je),R([]),w([]),me(null),ae(),Z()}catch(l){console.error(l),i.error(((r=(a=l.response)==null?void 0:a.data)==null?void 0:r.msg)||"Failed to save product")}},zt=t=>{var a,r,l,x;me(t._id),w([]),G(((a=t.sizes)==null?void 0:a.length)>0),c({name:t.name||"",productCode:t.productCode||"",description:t.description||"",category:t.category||"",categoryRef:((r=t.categoryRef)==null?void 0:r._id)||t.categoryRef||"",fabric:t.fabric||"",color:t.color||((l=t.colors)==null?void 0:l[0])||"",colors:Array.isArray(t.colors)&&t.colors.length?t.colors:t.color?t.color.split(/[,\\n]/).map(d=>d.trim()).filter(Boolean):[],sizes:t.sizes||[],amazonLink:t.amazonLink||"",flipkartLink:t.flipkartLink||"",price:t.price||"",discountPrice:t.discountPrice||"",stock:t.stock||"",images:(t.images||[]).join(`
`),colorImages:t.colorImages||[],video:t.video||"",collectionIds:((x=t.collections)==null?void 0:x.map(d=>d._id||d))||[]});const s=S.filter(d=>{var P;return(((P=d.meta)==null?void 0:P.products)||d.productIds||[]).includes(t._id)}).map(d=>d._id);R(s)},Et=()=>{c(je),R([]),w([]),Q(""),G(!1),me(null)},Ft=async t=>{if(window.confirm("Delete this product?"))try{await u.delete(`/products/${t}`,g),i.success("Deleted"),ae(),Z()}catch{i.error("Failed to delete")}},Tt=async()=>{var t,s;try{await u.post("/collections",I,g),i.success("Collection created"),E(Qe),Z()}catch(a){i.error(((s=(t=a.response)==null?void 0:t.data)==null?void 0:s.msg)||"Failed to create collection")}},re=async(t,s)=>{try{await u.put(`/collections/${t}`,s,g),i.success("Collection updated"),Z()}catch{i.error("Update failed")}},Bt=async t=>{if(window.confirm("Delete this collection?"))try{await u.delete(`/collections/${t}`,g),i.success("Collection removed"),Z(),ae()}catch{i.error("Could not delete")}},Ht=async(t,s)=>{if(s)try{const a=new FormData;a.append("file",s);const r=await u.post("/uploads",a,{headers:{Authorization:`Bearer ${n}`,"Content-Type":"multipart/form-data"}});await re(t,{heroImage:r.data.url}),i.success("Image uploaded")}catch(a){console.error(a),i.error("Upload failed")}},Vt=async()=>{var t;if(n)try{const s=await u.get("/settings",g);typeof((t=s.data)==null?void 0:t.codEnabled)=="boolean"&&ge(s.data.codEnabled)}catch(s){console.error(s)}},Wt=async()=>{var t;if(n){Ie(!0);try{const s=await u.put("/settings",{codEnabled:Se},g);typeof((t=s.data)==null?void 0:t.codEnabled)=="boolean"&&ge(s.data.codEnabled),i.success("Payment settings updated")}catch(s){console.error(s),i.error("Could not update payment settings")}finally{Ie(!1)}}},qt=async(t,s)=>{var l,x;if(!s)return;const a=await Be(s);if(!a)return;const r=((x=(l=y.find(d=>d._id===t))==null?void 0:l.heroImages)==null?void 0:x.filter(Boolean))||[];await re(t,{heroImages:[...r,a]})},Gt=async(t,s)=>{var l,x;const r=(((x=(l=y.find(d=>d._id===t))==null?void 0:l.heroImages)==null?void 0:x.filter(Boolean))||[]).filter(d=>d!==s);await re(t,{heroImages:r})},Jt=async t=>{if(t)try{Y(!0);const s=new FormData;s.append("file",t);const a=await u.post("/uploads",s,{headers:{Authorization:`Bearer ${n}`,"Content-Type":"multipart/form-data"}});c(r=>({...r,video:a.data.url})),i.success("Video uploaded")}catch(s){console.error(s),i.error("Video upload failed")}finally{Y(!1)}},Be=async t=>{var s,a;if(!t)return"";try{const r=new FormData;r.append("file",t);const l=await u.post("/uploads",r,{headers:{Authorization:`Bearer ${n}`,"Content-Type":"multipart/form-data"}});return i.success("Image uploaded"),l.data.url}catch(r){console.error(r);const l=((a=(s=r==null?void 0:r.response)==null?void 0:s.data)==null?void 0:a.msg)||"Upload failed";return i.error(l),""}},le=async(t,s)=>{var a,r;try{await u.patch(`/orders/${t}`,s,g),i.success("Order updated"),ue()}catch(l){console.error(l),i.error(((r=(a=l.response)==null?void 0:a.data)==null?void 0:r.msg)||"Could not update order")}},Kt=(t=[])=>t.map(s=>{var a;return(a=y.find(r=>r._id===s))==null?void 0:a.title}).filter(Boolean).join(", "),Qt=p.useMemo(()=>{const t={};return S.forEach(s=>{var r;(((r=s.meta)==null?void 0:r.products)||s.productIds||[]).forEach(l=>{t[l]||(t[l]=[]),t[l].push(s.title||"Mood")})}),t},[S]),Xt=t=>(Qt[t]||[]).join(", ");return!n||(f==null?void 0:f.role)!=="admin"?e.jsx(ts,{to:"/admin/login",replace:!0}):e.jsxs("div",{className:"admin-page min-h-screen bg-[var(--bg)]",children:[e.jsx("header",{className:"sticky top-0 z-30 bg-gradient-to-b from-[var(--surface)]/95 to-[var(--surface-muted)]/88 backdrop-blur border-b border-[var(--border)] shadow-[0_12px_40px_rgba(24,16,10,0.08)]",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-6 py-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-[var(--muted)]",children:"Admin"}),e.jsx("h1",{className:"text-xl font-semibold text-[var(--ink)]",children:"Mrigmaya Control Room"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-sm text-[var(--muted)]",children:["Logged in as ",f==null?void 0:f.mobile]}),e.jsx("button",{onClick:()=>{C(),_("/admin/login")},className:"pill-button secondary hover:-translate-y-0.5",children:"Logout"})]})]})}),e.jsxs("main",{className:"max-w-6xl mx-auto px-6 py-8 space-y-10 admin-main",children:[e.jsxs("section",{className:"card-shell p-6 admin-card admin-grid",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"Quick sections"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"What would you like to manage?"}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Pick a section below. Each panel only shows the tools needed for that part of the store."}),e.jsx("div",{className:"flex flex-wrap gap-3 mt-4",children:ot.map(t=>e.jsx("button",{onClick:()=>nt(t.id),className:`admin-tab px-4 py-2 rounded-full text-sm font-semibold border transition ${F===t.id?"bg-[var(--primary)] text-white border-[var(--primary)] shadow-sm":"border-[var(--border)] text-[var(--muted)] hover:border-[var(--primary)] hover:text-[var(--ink)]"}`,children:t.label},t.id))})]}),F==="coupons"&&e.jsxs("section",{className:"card-shell p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"Promotions"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Coupon generator"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Create one-time or limited-use coupon codes with flat or percent discounts."})]})}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Code"}),e.jsx("input",{value:j.code,onChange:t=>V({...j,code:t.target.value}),placeholder:"FIRST123",className:"border rounded-xl px-4 py-3 w-full"}),e.jsx("label",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Discount type"}),e.jsxs("select",{value:j.discountType,onChange:t=>V({...j,discountType:t.target.value}),className:"border rounded-xl px-4 py-3 w-full",children:[e.jsx("option",{value:"flat",children:"Flat amount (₹)"}),e.jsx("option",{value:"percent",children:"Percent (%)"})]}),e.jsx("label",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Value"}),e.jsx("input",{type:"number",min:"1",value:j.value,onChange:t=>V({...j,value:t.target.value}),placeholder:"e.g. 500 or 10",className:"border rounded-xl px-4 py-3 w-full"}),e.jsx("label",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Max discount (optional, for %)"}),e.jsx("input",{type:"number",min:"0",value:j.maxDiscount,onChange:t=>V({...j,maxDiscount:t.target.value}),placeholder:"Cap for percent coupons",className:"border rounded-xl px-4 py-3 w-full"}),e.jsx("label",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Min order value (optional)"}),e.jsx("input",{type:"number",min:"0",value:j.minOrderValue,onChange:t=>V({...j,minOrderValue:t.target.value}),placeholder:"Apply only above this amount",className:"border rounded-xl px-4 py-3 w-full"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Max redemptions (overall)"}),e.jsx("input",{type:"number",min:"1",value:j.maxRedemptions,onChange:t=>V({...j,maxRedemptions:t.target.value}),className:"border rounded-xl px-4 py-3 w-full"}),e.jsx("label",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Expires at (optional)"}),e.jsx("input",{type:"datetime-local",value:j.expiresAt,onChange:t=>V({...j,expiresAt:t.target.value}),className:"border rounded-xl px-4 py-3 w-full"}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx("input",{type:"checkbox",checked:j.active,onChange:t=>V({...j,active:t.target.checked})}),"Active"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:kt,className:"bg-pink-600 text-white px-6 py-3 rounded-full",children:"Save coupon"}),e.jsx("button",{onClick:Fe,className:"border border-gray-200 text-gray-600 px-4 py-3 rounded-full",children:"Clear"})]})]})]}),e.jsx("div",{className:"mt-8 overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-500",children:[e.jsx("th",{className:"py-2",children:"Code"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Value"}),e.jsx("th",{children:"Min"}),e.jsx("th",{children:"Used"}),e.jsx("th",{children:"Expires"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsxs("tbody",{children:[we.map(t=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"py-2 font-semibold text-gray-900",children:t.code}),e.jsx("td",{children:t.discountType}),e.jsxs("td",{children:[t.discountType==="percent"?`${t.value}%`:`₹${t.value}`,t.maxDiscount?` (cap ₹${t.maxDiscount})`:""]}),e.jsxs("td",{children:["₹",t.minOrderValue||0]}),e.jsxs("td",{children:[t.redemptions||0," / ",t.maxRedemptions||1]}),e.jsx("td",{children:t.expiresAt?new Date(t.expiresAt).toLocaleString():"No expiry"}),e.jsx("td",{children:t.active?"Active":"Inactive"}),e.jsxs("td",{className:"space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>u.patch(`/coupons/${t._id}`,{active:!t.active},g).then(xe).catch(()=>i.error("Update failed")),className:"text-xs text-pink-600",children:t.active?"Disable":"Enable"}),e.jsx("button",{type:"button",onClick:()=>window.confirm("Delete coupon?")&&u.delete(`/coupons/${t._id}`,g).then(xe).catch(()=>i.error("Delete failed")),className:"text-xs text-red-500",children:"Delete"})]})]},t._id)),we.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"py-4 text-center text-gray-400",children:"No coupons yet"})})]})]})})]}),F==="payments"&&e.jsxs("section",{className:"card-shell p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"Payments"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Payment options"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Turn payment methods on/off for checkout."})]})}),e.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl p-5 space-y-4",children:[e.jsxs("label",{className:"flex items-center gap-3 text-sm text-gray-600",children:[e.jsx("input",{type:"checkbox",checked:Se,onChange:t=>ge(t.target.checked)}),"Enable Cash on Delivery (COD)"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"When off, COD will be hidden at checkout and blocked on the backend."}),e.jsx("button",{type:"button",onClick:Wt,disabled:_e,className:"bg-gray-900 text-white px-5 py-2 rounded-full text-sm font-semibold disabled:opacity-70",children:_e?"Saving...":"Save changes"})]})]}),F==="orders"&&e.jsxs("section",{className:"bg-white rounded-3xl shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"Orders"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Recent orders"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Update payment or delivery status from one place."})]}),e.jsx("button",{onClick:ue,className:"text-sm text-gray-500 underline",children:"Refresh"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-500",children:[e.jsx("th",{className:"py-2",children:"Order"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Shipping"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Payment"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Tracking"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[de.map(t=>{var s,a;return e.jsxs("tr",{className:"border-t",children:[e.jsxs("td",{className:"py-2",children:[e.jsxs("p",{className:"font-semibold text-gray-900",children:["#",t._id.slice(-6).toUpperCase()]}),e.jsx("p",{className:"text-xs text-gray-400",children:new Date(t.createdAt).toLocaleString()}),e.jsxs("p",{className:"text-xs text-gray-500",children:[t.items.length," item(s)"]}),e.jsx("div",{className:"text-[11px] text-gray-500 space-y-1 mt-1",children:t.items.map((r,l)=>{var x,d,D,P;return e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[e.jsx("img",{src:rs(r.product),alt:((x=r.product)==null?void 0:x.name)||"Item",className:"w-7 h-7 rounded-md border border-gray-200 object-cover bg-white",onError:ne=>{ne.currentTarget.src=Xe}}),e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-gray-100 text-gray-800 border border-gray-200",children:((d=r.product)==null?void 0:d.name)||"Item"}),(((D=r.product)==null?void 0:D.productCode)||r.productCode)&&e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-blue-50 text-blue-800 border border-blue-100",children:((P=r.product)==null?void 0:P.productCode)||r.productCode}),r.selectedColor&&e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-amber-50 text-amber-800 border border-amber-100",children:r.selectedColor}),r.selectedSize&&e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-indigo-50 text-indigo-800 border border-indigo-100",children:r.selectedSize}),e.jsxs("span",{className:"text-gray-400",children:["x",r.quantity]})]},`${r.product}-${l}`)})})]}),e.jsx("td",{className:"text-xs text-gray-600",children:((s=t.user)==null?void 0:s.mobile)||t.customerContact||"NA"}),e.jsxs("td",{className:"text-xs text-gray-600 max-w-xs",children:[e.jsx("p",{className:"font-semibold text-gray-900",children:((a=t.shippingAddress)==null?void 0:a.name)||"—"}),e.jsx("p",{className:"text-gray-500",children:ut(t)}),t.customerNote&&e.jsxs("p",{className:"text-[11px] text-gray-400 mt-1",children:["Note: ",t.customerNote]})]}),e.jsxs("td",{className:"font-semibold text-gray-900",children:["₹",new Intl.NumberFormat("en-IN").format(t.amount||0)]}),e.jsx("td",{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("span",{className:"text-xs uppercase tracking-wide text-gray-500",children:t.paymentMethod}),e.jsx("select",{className:"border rounded-lg px-2 py-1 text-xs",value:t.paymentStatus,onChange:r=>le(t._id,{paymentStatus:r.target.value}),children:cs.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))})]})}),e.jsx("td",{children:e.jsx("select",{className:"border rounded-lg px-2 py-1 text-xs",value:t.status,onChange:r=>le(t._id,{status:r.target.value}),children:ns.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))})}),e.jsx("td",{className:"text-xs text-gray-600",children:e.jsxs("div",{className:"space-y-1",children:[(t.trackingLink||t.trackingNumber)&&e.jsx("a",{href:(t.trackingLink||t.trackingNumber||"").startsWith("http")?t.trackingLink||t.trackingNumber:void 0,target:"_blank",rel:"noreferrer",className:"text-[11px] text-pink-600 underline",children:"Open tracking"}),e.jsx("input",{type:"text",className:"border rounded-lg px-2 py-1 w-full",placeholder:"Paste tracking URL",defaultValue:t.trackingLink||"",onBlur:r=>le(t._id,{trackingLink:r.target.value.trim()})}),!t.trackingLink&&t.trackingNumber&&e.jsxs("p",{className:"text-[11px] text-gray-500",children:["Current: ",t.trackingNumber]})]})}),e.jsxs("td",{className:"text-right space-y-2",children:[t.paymentMethod==="UPI"&&t.upiIntent&&e.jsx("a",{href:t.upiIntent,target:"_blank",rel:"noreferrer",className:"text-xs text-pink-600",children:"UPI link"}),e.jsx("button",{type:"button",onClick:()=>mt(t._id),className:"block text-xs text-pink-600 underline",children:"Download bill"})]})]},t._id)}),de.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"py-6 text-center text-gray-400",children:"No orders yet"})})]})]})})]}),F==="returns"&&e.jsxs("section",{className:"bg-white rounded-3xl shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"Returns"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Return requests"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Approve/reject and view photos sent by customers."})]}),e.jsx("button",{onClick:ue,className:"text-sm text-gray-500 underline",children:"Refresh"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-500",children:[e.jsx("th",{className:"py-2",children:"Order"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Reason"}),e.jsx("th",{children:"Photos"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Note"})]})}),e.jsxs("tbody",{children:[De.map(t=>{var s,a,r;return e.jsxs("tr",{className:"border-t",children:[e.jsxs("td",{className:"py-2",children:[e.jsxs("p",{className:"font-semibold text-gray-900",children:["#",t._id.slice(-6).toUpperCase()]}),e.jsx("p",{className:"text-xs text-gray-400",children:new Date(t.createdAt).toLocaleString()}),e.jsxs("p",{className:"text-xs text-gray-500",children:[t.items.length," item(s)"]})]}),e.jsxs("td",{className:"text-xs text-gray-600",children:[((s=t.user)==null?void 0:s.mobile)||t.customerContact||"NA",e.jsxs("div",{className:"text-gray-500",children:[(a=t.shippingAddress)==null?void 0:a.name," ",(r=t.shippingAddress)==null?void 0:r.phone]})]}),e.jsxs("td",{className:"text-xs text-gray-600 max-w-xs",children:[e.jsx("p",{className:"font-semibold text-gray-900",children:t.returnReason||"No reason"}),t.returnNote&&e.jsxs("p",{className:"text-gray-500",children:["Note: ",t.returnNote]})]}),e.jsx("td",{className:"text-xs text-gray-600",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[(t.returnImages||[]).map((l,x)=>{const d=W(l);return e.jsx("a",{href:d,target:"_blank",rel:"noreferrer",className:"block w-16 h-16 rounded-lg overflow-hidden border border-gray-200",children:e.jsx("img",{src:d,alt:"return",className:"w-full h-full object-cover"})},x)}),(t.returnImages||[]).length===0&&e.jsx("span",{children:"None"})]})}),e.jsx("td",{children:e.jsx("select",{className:"border rounded-lg px-2 py-1 text-xs",value:t.returnStatus||"none",onChange:l=>le(t._id,{returnStatus:l.target.value}),children:["requested","approved","rejected","received","refunded"].map(l=>e.jsx("option",{value:l,children:l},l))})}),e.jsx("td",{className:"text-xs",children:e.jsx("textarea",{className:"border rounded-lg px-2 py-1 text-xs w-full",placeholder:"Return note",defaultValue:t.returnNote||"",onBlur:l=>le(t._id,{returnNote:l.target.value})})})]},t._id)}),De.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"py-6 text-center text-gray-400",children:"No return requests yet"})})]})]})})]}),F==="products"&&e.jsxs(e.Fragment,{children:[e.jsxs("section",{className:"bg-white rounded-3xl shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"Catalog"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:H?"Edit product":"Create product"})]}),H&&e.jsx("button",{onClick:Et,className:"text-sm text-gray-500 underline",children:"Cancel edit"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mt-6",children:[e.jsx("input",{value:o.name,onChange:t=>c({...o,name:t.target.value}),placeholder:"Product name",className:"border rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-pink-100"}),e.jsx("input",{value:o.productCode,onChange:t=>c({...o,productCode:t.target.value}),placeholder:"Internal product ID (for stock)",className:"border rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-pink-100"}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500",children:"Assign category"}),e.jsxs("select",{value:o.categoryRef,onChange:t=>c({...o,categoryRef:t.target.value}),className:"border rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-pink-100 w-full",children:[e.jsx("option",{value:"",children:"Select category"}),N.map(t=>e.jsx("option",{value:t._id,children:t.name},t._id))]})]}),e.jsx("input",{value:o.category,onChange:t=>c({...o,category:t.target.value}),placeholder:"Display label (ex. Banarasi, Poshaak)",className:"border rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-pink-100"}),e.jsx("input",{value:o.fabric,onChange:t=>c({...o,fabric:t.target.value}),placeholder:"Fabric",className:"border rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-pink-100"}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm text-gray-500",children:"Available colors (Saree / Suit)"}),o.colors.length>0&&e.jsxs("span",{className:"text-xs text-gray-400",children:[o.colors.length," selected"]})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-500 mt-2",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:X,onChange:t=>G(t.target.checked)}),"Suit product? Show size picker"]}),e.jsxs("span",{className:"text-[11px]",children:["Detected category: ",fe?"Suit":"Other"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:Ye.map(t=>{const s=o.colors.includes(t.label),a=Ke(t.label),r=typeof a=="string"&&a.startsWith("#")&&ls(a)?"#1f2937":"#ffffff";return e.jsx("button",{type:"button",onClick:()=>ye(t.label),title:t.label,className:`px-3 py-2 rounded-full text-xs border transition shadow-sm ${s?"ring-2 ring-pink-200 border-pink-200":"border-gray-200"}`,style:{background:a,color:s?r:"#ffffff",minWidth:64,boxShadow:s?"0 4px 12px rgba(0,0,0,0.12)":"0 2px 6px rgba(0,0,0,0.06)"},children:t.label},t.label)})}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsx("input",{value:ee,onChange:t=>Q(t.target.value),onKeyDown:t=>{t.key==="Enter"&&(t.preventDefault(),Ue())},placeholder:"Add custom color (press Enter)",className:"border rounded-xl px-4 py-3 flex-1 focus:outline-none focus:ring-2 focus:ring-pink-100"}),e.jsx("button",{type:"button",onClick:Ue,className:"px-4 py-3 rounded-xl bg-gray-900 text-white text-sm",children:"Add"})]}),e.jsx("input",{type:"file",multiple:!0,accept:"image/*",ref:m,className:"hidden",onChange:t=>dt(t.target.files)}),o.colors.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-3",children:o.colors.map(t=>e.jsxs("span",{className:"px-3 py-1 rounded-full border text-xs text-gray-700 flex items-center gap-2 shadow-sm",style:{background:Ke(t),borderColor:"rgba(0,0,0,0.08)",color:"#1f2937"},children:[t,e.jsx("button",{type:"button",className:"text-gray-400",onClick:()=>ye(t),children:"×"})]},t))})]}),$e&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm text-gray-500",children:"Available sizes (Suit)"}),o.sizes.length===0&&e.jsx("span",{className:"text-xs text-red-500",children:"Select sizes for suits"})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-500 mb-2",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:X,onChange:t=>G(t.target.checked)}),"Force show sizes (for suit products without “suit” in category name)"]}),e.jsxs("span",{children:["Detected: ",fe?"Suit category":"Other"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:os.map(t=>{const s=o.sizes.includes(t);return e.jsx("button",{type:"button",onClick:()=>xt(t),className:`px-3 py-2 rounded-full text-xs border transition ${s?"bg-indigo-100 border-indigo-300 text-indigo-700":"bg-white border-gray-200 text-gray-600 hover:border-indigo-200"}`,children:t},t)})})]}),e.jsx("input",{value:o.amazonLink,onChange:t=>c({...o,amazonLink:t.target.value}),placeholder:"Amazon product link (optional)",className:"border rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-pink-100",type:"url"}),e.jsx("input",{value:o.flipkartLink,onChange:t=>c({...o,flipkartLink:t.target.value}),placeholder:"Flipkart product link (optional)",className:"border rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-pink-100",type:"url"}),e.jsx("input",{value:o.price,onChange:t=>c({...o,price:t.target.value}),placeholder:"Price (MRP)",className:"border rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-pink-100",type:"number"}),e.jsx("input",{value:o.discountPrice,onChange:t=>c({...o,discountPrice:t.target.value}),placeholder:"Selling price",className:"border rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-pink-100",type:"number"}),e.jsx("input",{value:o.stock,onChange:t=>c({...o,stock:t.target.value}),placeholder:"Stock",className:"border rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-pink-100",type:"number"})]}),e.jsx("textarea",{value:o.description,onChange:t=>c({...o,description:t.target.value}),placeholder:"Description / story",className:"border rounded-2xl px-4 py-3 w-full mt-4 focus:outline-none focus:ring-2 focus:ring-pink-100",rows:3}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mt-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500",children:"Existing image URLs (one per line)"}),e.jsx("textarea",{value:o.images,onChange:t=>c({...o,images:t.target.value}),className:"border rounded-2xl px-4 py-3 w-full focus:outline-none focus:ring-2 focus:ring-pink-100",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500",children:"Upload new images (select multiple)"}),e.jsx("input",{type:"file",multiple:!0,onChange:t=>w(Array.from(t.target.files)),className:"border rounded-xl px-4 py-3 w-full"}),k.length>0&&e.jsxs("div",{className:"text-xs text-gray-500 mt-2 space-y-1",children:[e.jsxs("p",{children:[k.length," new file(s) selected"]}),e.jsxs("ul",{className:"list-disc list-inside space-y-0.5",children:[k.slice(0,4).map(t=>e.jsx("li",{children:t.name},t.name)),k.length>4&&e.jsxs("li",{children:["+",k.length-4," more"]})]})]}),se.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsxs("p",{className:"text-xs text-gray-500",children:["Currently attached (",se.length,")"]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[se.slice(0,8).map((t,s)=>e.jsx("div",{className:"w-12 h-12 rounded-lg overflow-hidden border border-gray-200 bg-gray-50",children:e.jsx("img",{src:W(t),alt:"",className:"w-full h-full object-cover"})},`${t}-${s}`)),se.length>8&&e.jsxs("span",{className:"text-xs text-gray-400",children:["+",se.length-8," more"]})]})]})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"text-sm text-gray-500",children:"Attach to homepage collections (Sarees / Suits / Gold / Best Seller)"}),e.jsx("select",{multiple:!0,value:o.collectionIds,onChange:t=>c({...o,collectionIds:Array.from(t.target.selectedOptions,s=>s.value)}),className:"border rounded-xl px-4 py-3 w-full focus:outline-none focus:ring-2 focus:ring-pink-100 h-40",children:y.map(t=>e.jsx("option",{value:t._id,children:t.title},t._id))}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2 text-xs",children:[y.map(t=>e.jsxs("button",{type:"button",className:"px-3 py-1 border border-gray-200 rounded-full",onClick:()=>c(s=>s.collectionIds.includes(t._id)?s:{...s,collectionIds:[...s.collectionIds,t._id]}),children:["Add to ",t.title]},`quick-${t._id}`)),o.collectionIds.length>0&&e.jsx("button",{type:"button",className:"px-3 py-1 border border-gray-200 rounded-full text-gray-500",onClick:()=>c(t=>({...t,collectionIds:[]})),children:"Clear selections"})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"text-sm text-gray-500",children:"Attach to mood cards (home tiles)"}),e.jsx("select",{multiple:!0,value:z,onChange:t=>R(Array.from(t.target.selectedOptions,s=>s.value)),className:"border rounded-xl px-4 py-3 w-full focus:outline-none focus:ring-2 focus:ring-pink-100 h-32",children:S.map(t=>e.jsxs("option",{value:t._id,children:[t.title||"Untitled"," ",t.tag?`(${t.tag})`:""]},t._id))}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2 text-xs",children:[S.map(t=>e.jsxs("button",{type:"button",className:"px-3 py-1 border border-gray-200 rounded-full",onClick:()=>R(s=>s.includes(t._id)?s:[...s,t._id]),children:["Add to ",t.title||"Mood"]},`quick-mood-${t._id}`)),z.length>0&&e.jsx("button",{type:"button",className:"px-3 py-1 border border-gray-200 rounded-full text-gray-500",onClick:()=>R([]),children:"Clear mood selection"})]})]}),e.jsx("div",{className:"grid md:grid-cols-2 gap-4 mt-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500",children:"Product video URL (optional)"}),e.jsx("input",{value:o.video,onChange:t=>c({...o,video:t.target.value}),placeholder:"https://... (mp4 / hosted link)",className:"border rounded-xl px-4 py-3 w-full focus:outline-none focus:ring-2 focus:ring-pink-100"}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("input",{type:"file",accept:"video/*",className:"text-sm",onChange:t=>{var s;return Jt((s=t.target.files)==null?void 0:s[0])}}),oe&&e.jsx("span",{className:"text-xs text-gray-400",children:"Uploading..."})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Paste a hosted link or upload to store on server."})]})}),e.jsx("button",{onClick:Ot,className:"mt-6 bg-pink-600 text-white px-6 py-3 rounded-full",children:H?"Update product":"Create product"})]}),e.jsxs("section",{className:"bg-white rounded-3xl shadow p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"Live catalog"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Products"})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-500",children:[e.jsx("th",{className:"py-2",children:"Name"}),e.jsx("th",{children:"Price"}),e.jsx("th",{children:"Collections"}),e.jsx("th",{children:"Moods"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:h.map(t=>{var s;return e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"py-2",children:t.name}),e.jsx("td",{children:t.discountPrice||t.price}),e.jsx("td",{className:"text-xs text-gray-500",children:Kt((s=t.collections)==null?void 0:s.map(a=>a._id||a))}),e.jsx("td",{className:"text-xs text-gray-500",children:Xt(t._id)||"—"}),e.jsxs("td",{className:"text-right space-x-3",children:[e.jsx("button",{className:"text-pink-600",onClick:()=>zt(t),children:"Edit"}),e.jsx("button",{className:"text-gray-400",onClick:()=>Ft(t._id),children:"Delete"})]})]},t._id)})})]})})]})]}),F==="usp"&&e.jsxs("section",{className:"bg-white rounded-3xl shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"Offers rail"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Homepage offers"}),e.jsx("p",{className:"text-sm text-gray-500",children:"These cards show in the scrolling rail. Set order to control their position."})]}),e.jsx("button",{onClick:v,className:"text-sm text-gray-500 underline",children:"Refresh"})]}),e.jsx(xs,{items:Re,onSave:gt,onDelete:ft})]}),F==="collections"&&e.jsxs("section",{className:"bg-white rounded-3xl shadow p-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"Homepage sections"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Collection studio"})]})}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mt-6",children:[e.jsx("input",{value:I.title,onChange:t=>E({...I,title:t.target.value}),placeholder:"Title",className:"border rounded-xl px-4 py-3"}),e.jsx("input",{value:I.slug,onChange:t=>E({...I,slug:t.target.value}),placeholder:"Slug (unique)",className:"border rounded-xl px-4 py-3"}),e.jsx("input",{value:I.subtitle,onChange:t=>E({...I,subtitle:t.target.value}),placeholder:"Subtitle",className:"border rounded-xl px-4 py-3"}),e.jsx("input",{value:I.ctaLabel,onChange:t=>E({...I,ctaLabel:t.target.value}),placeholder:"CTA Label",className:"border rounded-xl px-4 py-3"}),e.jsx("input",{value:I.heroImage,onChange:t=>E({...I,heroImage:t.target.value}),placeholder:"Hero image URL",className:"border rounded-xl px-4 py-3"}),e.jsx("input",{value:I.accentColor,onChange:t=>E({...I,accentColor:t.target.value}),placeholder:"Accent color",className:"border rounded-xl px-4 py-3"}),e.jsx("input",{value:I.priority,type:"number",onChange:t=>E({...I,priority:Number(t.target.value)}),placeholder:"Priority (lower first)",className:"border rounded-xl px-4 py-3"}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx("input",{type:"checkbox",checked:I.displayOnHome,onChange:t=>E({...I,displayOnHome:t.target.checked})}),"Display on homepage"]})]}),e.jsx("textarea",{value:I.description,onChange:t=>E({...I,description:t.target.value}),placeholder:"Description",className:"border rounded-2xl px-4 py-3 w-full mt-4",rows:3}),e.jsx("button",{onClick:Tt,className:"mt-4 bg-gray-900 text-white px-6 py-3 rounded-full",children:"Create collection"}),e.jsxs("div",{className:"mt-10 space-y-10 admin-collections",children:[y.length===0&&e.jsx("p",{className:"text-sm text-gray-500",children:"Create a collection to start building your home tiles."}),y.map(t=>e.jsxs("div",{className:"admin-collection-row",children:[e.jsx(us,{collection:t,onSave:s=>re(t._id,s),onDelete:()=>Bt(t._id),onHeroUpload:s=>Ht(t._id,s),onGalleryUpload:s=>qt(t._id,s),onGalleryDelete:s=>Gt(t._id,s)}),e.jsx(ps,{collection:t,products:h,onUpdate:s=>re(t._id,{products:s})})]},t._id))]})]}),F==="homepage"&&e.jsxs("section",{className:"bg-white rounded-3xl shadow p-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"Homepage slider"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Hero image manager"}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Upload multiple hero images at once and they will rotate on the storefront automatically."})]}),e.jsxs("div",{className:"mt-6 border border-gray-100 rounded-2xl p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:"Upload photos / videos"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Select one or more images or MP4/WebM clips."}),e.jsx("input",{type:"file",multiple:!0,accept:"image/*,video/*",className:"mt-3 text-sm",onChange:t=>{At(t.target.files),t.target.value=""}})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:"Or paste an image / video link"}),e.jsxs("div",{className:"flex flex-col gap-2 md:flex-row mt-2",children:[e.jsx("input",{value:he,onChange:t=>Ce(t.target.value),placeholder:"https://example.com/hero.jpg or https://example.com/hero.mp4",className:"border rounded-xl px-4 py-2 text-sm flex-1"}),e.jsx("button",{onClick:Dt,className:"px-4 py-2 rounded-xl bg-gray-900 text-white text-sm",children:"Add slide"})]})]}),tt&&e.jsx("p",{className:"text-xs text-gray-400",children:"Uploading..."})]}),e.jsxs("div",{className:"mt-8",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"Slides"}),e.jsxs("h3",{className:"text-xl font-semibold text-gray-900",children:[L.length," slide",L.length===1?"":"s"]})]})}),L.length===0?e.jsx("p",{className:"text-sm text-gray-500 mt-4",children:"No slides yet. Upload images to get started."}):e.jsx("div",{className:"grid md:grid-cols-2 gap-4 mt-4",children:L.map((t,s)=>e.jsx(is,{slide:t,index:s,isLast:s===L.length-1,onToggle:a=>Pt(t._id,a),onMobileToggle:a=>Ut(t._id,a),onDelete:()=>$t(t._id),onMoveUp:()=>Te(t._id,"up"),onMoveDown:()=>Te(t._id,"down"),onReorder:a=>Mt(a,t._id)},t._id))})]}),Ae.length>0&&e.jsxs("div",{className:"mt-6 bg-white border border-gray-100 rounded-2xl p-4 space-y-2",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Recent changes"}),e.jsx("ul",{className:"space-y-1 text-sm text-gray-700",children:Ae.map((t,s)=>e.jsxs("li",{children:[e.jsx("span",{className:"text-gray-500 text-xs",children:new Date(t.ts).toLocaleTimeString()})," ",t.message]},`${t.ts}-${s}`))})]}),e.jsxs("div",{className:"mt-10 border-t pt-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"Featured edits"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Mood cards (home tiles)"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Add tiles like Saree / Suit / Jewellery. Set title, badge, link, and image."})]}),te&&e.jsx("button",{onClick:be,className:"text-sm text-gray-500 underline",children:"Cancel edit"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mt-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Title"}),e.jsx("input",{value:M.title,onChange:t=>O(s=>({...s,title:t.target.value})),className:"border rounded-xl px-3 py-2 w-full",placeholder:"Saree"}),e.jsx("label",{className:"text-sm text-gray-600",children:"Subtitle"}),e.jsx("input",{value:M.subtitle,onChange:t=>O(s=>({...s,subtitle:t.target.value})),className:"border rounded-xl px-3 py-2 w-full",placeholder:"Pure zari woven"}),e.jsx("label",{className:"text-sm text-gray-600",children:"Badge / tag"}),e.jsx("input",{value:M.tag,onChange:t=>O(s=>({...s,tag:t.target.value})),className:"border rounded-xl px-3 py-2 w-full",placeholder:"Bestseller / New"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm text-gray-600",children:"CTA label"}),e.jsx("input",{value:M.ctaLabel,onChange:t=>O(s=>({...s,ctaLabel:t.target.value})),className:"border rounded-xl px-3 py-2 w-full",placeholder:"Shop sarees >"}),e.jsx("label",{className:"text-sm text-gray-600",children:"CTA link"}),e.jsx("input",{value:M.ctaLink,onChange:t=>O(s=>({...s,ctaLink:t.target.value})),className:"border rounded-xl px-3 py-2 w-full",placeholder:"/products or /collection/sarees"}),e.jsx("label",{className:"text-sm text-gray-600",children:"Display order"}),e.jsx("input",{type:"number",value:M.order,onChange:t=>O(s=>({...s,order:Number(t.target.value)})),className:"border rounded-xl px-3 py-2 w-full"})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mt-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Image URL"}),e.jsx("input",{value:M.image,onChange:t=>O(s=>({...s,image:t.target.value})),className:"border rounded-xl px-3 py-2 w-full",placeholder:"https://..."}),e.jsx("input",{type:"file",accept:"image/*",className:"mt-2 text-sm",onChange:t=>{var s;return wt((s=t.target.files)==null?void 0:s[0])}}),at&&e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Uploading..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Attach products"}),e.jsxs("div",{className:"flex gap-2 mt-1",children:[e.jsxs("select",{className:"border rounded-xl px-3 py-2 text-sm flex-1",value:"",onChange:t=>{const s=t.target.value;s&&O(a=>a.productIds.includes(s)?a:{...a,productIds:[...a.productIds,s]})},children:[e.jsx("option",{value:"",children:"Choose product"}),h.map(t=>e.jsx("option",{value:t._id,children:t.name},t._id))]}),e.jsx("span",{className:"text-xs text-gray-500 self-center",children:"Pick items to show when opening this edit."})]}),M.productIds.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:M.productIds.map(t=>{const s=h.find(a=>a._id===t);return e.jsxs("span",{className:"px-3 py-1 rounded-full bg-gray-100 text-xs text-gray-700 flex items-center gap-2",children:[(s==null?void 0:s.name)||"Product",e.jsx("button",{type:"button",className:"text-gray-500",onClick:()=>O(a=>({...a,productIds:a.productIds.filter(r=>r!==t)})),children:"×"})]},t)})})]})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-6",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-700",children:[e.jsx("input",{type:"checkbox",checked:M.active,onChange:t=>O(s=>({...s,active:t.target.checked}))}),"Active"]}),e.jsx("button",{onClick:jt,className:"px-5 py-3 bg-pink-600 text-white rounded-full text-sm font-semibold",children:te?"Update card":"Save card"})]}),e.jsxs("div",{className:"mt-6 grid md:grid-cols-3 gap-3",children:[S.map((t,s)=>e.jsx(ds,{card:{...t,allProducts:h},index:s,isLast:s===S.length-1,onEdit:()=>Nt(t),onDelete:()=>vt(t._id),onToggle:a=>u.put(`/home-sections/${t._id}`,{active:a},g).then(v).catch(()=>i.error("Could not update card")),onMoveUp:()=>Ee(t._id,"up"),onMoveDown:()=>Ee(t._id,"down"),onAddProduct:a=>Ct(t._id,a),onDeleteProduct:a=>Lt(t._id,a),allProducts:h,onAddCustom:a=>St(t._id,a),onDeleteCustom:a=>_t(t._id,a),onUploadCustom:It},t._id)),S.length===0&&e.jsx("p",{className:"text-sm text-gray-500",children:"No mood cards yet. Add up to 3 tiles."})]})]})]}),F==="login-visuals"&&e.jsxs("section",{className:"bg-white rounded-3xl shadow p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"Login page"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Side visuals"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Update the left and right images shown on the login screen. Leave blank to hide."})]})}),e.jsx("div",{className:"grid md:grid-cols-2 gap-4 mt-4",children:Ne.map((t,s)=>e.jsxs("div",{className:"border border-gray-100 rounded-2xl p-4 space-y-3",children:[e.jsxs("p",{className:"text-sm font-semibold text-gray-800",children:["Visual ",s===0?"Left":"Right"]}),e.jsx("label",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Title"}),e.jsx("input",{value:t.title,onChange:a=>pe(s,"title",a.target.value),className:"border rounded-xl px-3 py-2 w-full",placeholder:"Sequin night"}),e.jsx("label",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Subtitle"}),e.jsx("input",{value:t.subtitle,onChange:a=>pe(s,"subtitle",a.target.value),className:"border rounded-xl px-3 py-2 w-full",placeholder:"Cocktail sarees"}),e.jsx("label",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Image URL"}),e.jsx("input",{value:t.image,onChange:a=>pe(s,"image",a.target.value),className:"border rounded-xl px-3 py-2 w-full",placeholder:"https://..."}),e.jsx("input",{type:"file",accept:"image/*",className:"text-sm",onChange:a=>{var l;const r=(l=a.target.files)==null?void 0:l[0];yt(r,s),a.target.value=""}}),st&&e.jsx("p",{className:"text-xs text-gray-400",children:"Uploading..."}),t.image&&e.jsx("div",{className:"mt-2 rounded-xl overflow-hidden h-32 bg-gray-100",children:e.jsx("img",{src:W(t.image),alt:t.title,className:"w-full h-full object-cover"})})]},s))}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx("button",{onClick:ht,className:"px-5 py-3 bg-pink-600 text-white rounded-full text-sm font-semibold",children:"Save visuals"})})]})]})]})}function is({slide:n,index:f,isLast:C,onToggle:_,onMobileToggle:h,onDelete:b,onMoveUp:y,onMoveDown:U,onReorder:N}){var z,R;const $=W(n.video||n.heroVideo||((z=n.meta)==null?void 0:z.video)||""),o=W(n.image||n.heroImage||(Array.isArray(n.images)?n.images[0]:"")),c=$||o,m=n.active!==!1,A=((R=n==null?void 0:n.meta)==null?void 0:R.showOnMobile)===!0,B=!!$;return e.jsxs("div",{className:"border border-gray-200 rounded-2xl p-4 space-y-3 bg-white",draggable:!0,onDragStart:k=>k.dataTransfer.setData("text/plain",n._id),onDragOver:k=>k.preventDefault(),onDrop:k=>{k.preventDefault();const w=k.dataTransfer.getData("text/plain");w&&(N==null||N(w,n._id))},children:[e.jsx("div",{className:"rounded-xl overflow-hidden bg-gray-100 aspect-[16/9]",children:c?B?e.jsx("video",{src:c,poster:o||void 0,className:"w-full h-full object-cover",muted:!0,loop:!0,playsInline:!0,preload:"metadata"}):e.jsx("img",{src:c,alt:n.title||`Slide ${f+1}`,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-xs text-gray-400",children:"No media"})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:["Slide ",f+1]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Order ",n.order??f+1]})]}),c&&e.jsx("a",{href:c,target:"_blank",rel:"noreferrer",className:"text-xs text-pink-600",children:"View"})]}),B&&e.jsx("span",{className:"inline-block text-[11px] text-indigo-600 font-semibold",children:"Video slide"}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx("input",{type:"checkbox",checked:m,onChange:k=>_(k.target.checked)}),"Show on homepage"]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx("input",{type:"checkbox",checked:A,onChange:k=>h==null?void 0:h(k.target.checked)}),"Show on mobile only"]}),(n.title||n.description)&&e.jsxs("div",{className:"text-xs text-gray-500",children:[n.title&&e.jsx("p",{className:"font-semibold",children:n.title}),n.description&&e.jsx("p",{children:n.description})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 text-sm",children:[e.jsx("button",{type:"button",onClick:y,disabled:f===0,className:`px-3 py-2 rounded-xl border ${f===0?"text-gray-300 border-gray-200 cursor-not-allowed":"text-gray-700 border-gray-300"}`,children:"Move up"}),e.jsx("button",{type:"button",onClick:U,disabled:C,className:`px-3 py-2 rounded-xl border ${C?"text-gray-300 border-gray-200 cursor-not-allowed":"text-gray-700 border-gray-300"}`,children:"Move down"}),e.jsx("button",{type:"button",onClick:b,className:"px-3 py-2 rounded-xl border border-red-200 text-red-600",children:"Delete"})]})]})}function ds({card:n,index:f,isLast:C,onEdit:_,onDelete:h,onToggle:b,onMoveUp:y,onMoveDown:U,onAddProduct:N,onDeleteProduct:$,onAddCustom:o,onDeleteCustom:c,onUploadCustom:m,allProducts:A}){var R,k;p.useState({name:"",price:"",mrp:"",image:"",images:[]});const B=n.active!==!1,z=((R=n.meta)==null?void 0:R.products)||n.productIds||[];return(k=n.meta)!=null&&k.customProducts,e.jsxs("div",{className:"border border-gray-200 rounded-2xl p-3 space-y-2 bg-white shadow-sm",children:[e.jsx("div",{className:"rounded-xl overflow-hidden bg-gray-100 aspect-[4/5]",children:n.image?e.jsx("img",{src:W(n.image),alt:n.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-xs text-gray-400",children:"No image"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs uppercase tracking-[0.3em] text-gray-400 flex items-center gap-2",children:[n.tag||"Mood"," ",e.jsx("span",{className:"text-gray-300",children:"·"})," Order ",n.order??f+1]}),e.jsx("p",{className:"text-base font-semibold text-gray-900",children:n.title||"Untitled"}),n.subtitle&&e.jsx("p",{className:"text-sm text-gray-500",children:n.subtitle}),z.length>0&&e.jsxs("p",{className:"text-[11px] text-gray-500",children:[z.length," product",z.length===1?"":"s"]}),n.ctaLabel&&e.jsxs("p",{className:"text-[11px] text-pink-600 mt-1",children:[n.ctaLabel," → ",n.ctaLink||"/products"]})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx("input",{type:"checkbox",checked:B,onChange:w=>b(w.target.checked)}),"Active"]}),e.jsxs("div",{className:"flex flex-wrap gap-2 text-sm",children:[e.jsx("button",{onClick:_,className:"px-3 py-2 rounded-xl border border-gray-300 text-gray-700",children:"Edit"}),e.jsx("button",{onClick:y,disabled:f===0,className:`px-3 py-2 rounded-xl border ${f===0?"text-gray-300 border-gray-200 cursor-not-allowed":"text-gray-700 border-gray-300"}`,children:"Up"}),e.jsx("button",{onClick:U,disabled:C,className:`px-3 py-2 rounded-xl border ${C?"text-gray-300 border-gray-200 cursor-not-allowed":"text-gray-700 border-gray-300"}`,children:"Down"}),e.jsx("button",{onClick:h,className:"px-3 py-2 rounded-xl border border-red-200 text-red-600",children:"Delete"})]}),e.jsxs("div",{className:"space-y-2 text-xs text-gray-600",children:[e.jsx("p",{className:"font-semibold",children:"Attached products"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[z.length===0&&e.jsx("span",{className:"text-gray-400",children:"None"}),z.map(w=>{var ee,Q,X,G,oe;return e.jsxs("span",{className:"px-3 py-1 rounded-full bg-gray-100 text-gray-700 flex items-center gap-2",children:[((Q=(ee=n.products)==null?void 0:ee.find(Y=>Y._id===w))==null?void 0:Q.name)||((oe=(G=(X=n.meta)==null?void 0:X.productsDetails)==null?void 0:G.find(Y=>Y._id===w))==null?void 0:oe.name)||w,e.jsx("button",{type:"button",className:"text-gray-500",onClick:()=>$(w),children:"×"})]},w)})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("select",{className:"border rounded-xl px-2 py-1 flex-1",value:"",onChange:w=>N(w.target.value),children:[e.jsx("option",{value:"",children:"Add product"}),(A||[]).map(w=>e.jsx("option",{value:w._id,children:w.name},w._id))]})})]})]})}function xs({items:n,onSave:f,onDelete:C}){const _={title:"",subtitle:"",tag:"",badge:"",ctaLabel:"",ctaLink:"/products",order:1,active:!0},[h,b]=p.useState(_),[y,U]=p.useState(null),N=c=>{U(c._id),b({title:c.title||"",subtitle:c.subtitle||"",tag:c.tag||"",badge:c.badge||"",ctaLabel:c.ctaLabel||"",ctaLink:c.ctaLink||"/products",order:c.order??1,active:c.active!==!1})},$=()=>{U(null),b(_)},o=()=>{f(h,y),$()};return e.jsxs("div",{className:"grid md:grid-cols-[1.1fr,0.9fr] gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{value:h.title,onChange:c=>b({...h,title:c.target.value}),placeholder:"Title (e.g. Flat 10% off)",className:"border rounded-xl px-3 py-2 w-full"}),e.jsx("input",{value:h.subtitle,onChange:c=>b({...h,subtitle:c.target.value}),placeholder:"Subtitle (e.g. Use code FEST10)",className:"border rounded-xl px-3 py-2 w-full"}),e.jsxs("div",{className:"grid sm:grid-cols-2 gap-3",children:[e.jsx("input",{value:h.tag,onChange:c=>b({...h,tag:c.target.value}),placeholder:"Tag (e.g. Limited)",className:"border rounded-xl px-3 py-2 w-full"}),e.jsx("input",{value:h.badge,onChange:c=>b({...h,badge:c.target.value}),placeholder:"Badge (e.g. Ends Sunday)",className:"border rounded-xl px-3 py-2 w-full"})]}),e.jsxs("div",{className:"grid sm:grid-cols-2 gap-3",children:[e.jsx("input",{value:h.ctaLabel,onChange:c=>b({...h,ctaLabel:c.target.value}),placeholder:"CTA label (e.g. Shop now)",className:"border rounded-xl px-3 py-2 w-full"}),e.jsx("input",{value:h.ctaLink,onChange:c=>b({...h,ctaLink:c.target.value}),placeholder:"CTA link (e.g. /products)",className:"border rounded-xl px-3 py-2 w-full"})]}),e.jsxs("div",{className:"grid sm:grid-cols-2 gap-3",children:[e.jsx("input",{type:"number",value:h.order,onChange:c=>b({...h,order:Number(c.target.value)}),placeholder:"Order (lower shows first)",className:"border rounded-xl px-3 py-2 w-full"}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx("input",{type:"checkbox",checked:h.active,onChange:c=>b({...h,active:c.target.checked})}),"Active"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:o,className:"px-4 py-2 bg-gray-900 text-white rounded-full",children:y?"Update offer":"Add offer"}),y&&e.jsx("button",{onClick:$,className:"text-sm text-gray-500 underline",children:"Cancel edit"})]})]}),e.jsxs("div",{className:"space-y-3",children:[n.map(c=>e.jsxs("div",{className:"border border-gray-200 rounded-2xl p-3 bg-white shadow-sm flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:[c.title," ",c.tag&&e.jsxs("span",{className:"text-xs text-gray-500",children:["• ",c.tag]})]}),c.subtitle&&e.jsx("p",{className:"text-xs text-gray-600",children:c.subtitle}),e.jsxs("div",{className:"flex gap-2 text-[11px] text-gray-500",children:[e.jsxs("span",{children:["Order ",c.order??0]}),e.jsx("span",{children:"•"}),e.jsx("span",{children:c.active===!1?"Hidden":"Active"})]}),(c.ctaLabel||c.ctaLink)&&e.jsxs("p",{className:"text-xs text-pink-600",children:[c.ctaLabel||"CTA"," → ",c.ctaLink||"/products"]})]}),e.jsxs("div",{className:"flex flex-col gap-1 text-xs",children:[e.jsx("button",{onClick:()=>N(c),className:"text-pink-600",children:"Edit"}),e.jsx("button",{onClick:()=>C(c._id),className:"text-red-500",children:"Delete"})]})]},c._id)),n.length===0&&e.jsx("p",{className:"text-sm text-gray-400",children:"No offers yet."})]})]})}function us({collection:n,onSave:f,onDelete:C,onHeroUpload:_,onGalleryUpload:h,onGalleryDelete:b}){var $;const[y,U]=p.useState({title:n.title||"",slug:n.slug||"",subtitle:n.subtitle||"",description:n.description||"",ctaLabel:n.ctaLabel||"",heroImage:n.heroImage||"",tag:n.tag||"",order:n.order||0,active:n.active!==!1,displayOnHome:n.displayOnHome!==!1});p.useEffect(()=>{U({title:n.title||"",slug:n.slug||"",subtitle:n.subtitle||"",description:n.description||"",ctaLabel:n.ctaLabel||"",heroImage:n.heroImage||"",tag:n.tag||"",order:n.order||0,active:n.active!==!1,displayOnHome:n.displayOnHome!==!1})},[n]);const N=(o,c)=>U(m=>({...m,[o]:c}));return e.jsxs("div",{className:"admin-card bg-white border border-gray-100 rounded-2xl p-4 space-y-3 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-gray-400",children:"Collection"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:y.title||"Untitled"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>f(y),className:"px-3 py-2 rounded-xl bg-gray-900 text-white text-xs font-semibold",children:"Save"}),e.jsx("button",{onClick:()=>window.confirm("Delete this collection?")&&C(),className:"px-3 py-2 rounded-xl border border-red-200 text-red-600 text-xs",children:"Delete"})]})]}),e.jsxs("div",{className:"grid md:grid-cols-[1.3fr,1fr] gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"rounded-xl overflow-hidden bg-gray-100 aspect-[16/9]",children:y.heroImage?e.jsx("img",{src:W(y.heroImage),alt:y.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-xs text-gray-400",children:"No hero image"})}),e.jsxs("div",{className:"flex gap-2 text-xs text-gray-600",children:[e.jsxs("label",{className:"px-3 py-2 rounded-xl border border-gray-200 cursor-pointer bg-white",children:["Upload hero",e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:o=>{var m;const c=(m=o.target.files)==null?void 0:m[0];c&&_&&_(c),o.target.value=""}})]}),e.jsxs("label",{className:"px-3 py-2 rounded-xl border border-gray-200 cursor-pointer bg-white",children:["Upload gallery",e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:o=>{var m;const c=(m=o.target.files)==null?void 0:m[0];c&&h&&h(c),o.target.value=""}})]})]}),(($=n.heroImages)==null?void 0:$.length)>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.28em] text-gray-400",children:"Gallery images"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:n.heroImages.map(o=>e.jsxs("div",{className:"relative w-20 h-14 rounded-lg overflow-hidden border border-gray-200 bg-gray-50",children:[e.jsx("img",{src:W(o),alt:"",className:"w-full h-full object-cover"}),b&&e.jsx("button",{type:"button",className:"absolute -top-2 -right-2 w-6 h-6 rounded-full bg-white border text-[10px] shadow",onClick:()=>b(o),"aria-label":"Remove gallery image",children:"×"})]},o))})]})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsx("input",{value:y.title,onChange:o=>N("title",o.target.value),placeholder:"Title",className:"border rounded-xl px-3 py-2 w-full"}),e.jsx("input",{value:y.slug,onChange:o=>N("slug",o.target.value),placeholder:"Slug (unique)",className:"border rounded-xl px-3 py-2 w-full"}),e.jsx("input",{value:y.subtitle,onChange:o=>N("subtitle",o.target.value),placeholder:"Subtitle",className:"border rounded-xl px-3 py-2 w-full"}),e.jsx("input",{value:y.ctaLabel,onChange:o=>N("ctaLabel",o.target.value),placeholder:"CTA label",className:"border rounded-xl px-3 py-2 w-full"}),e.jsx("textarea",{value:y.description,onChange:o=>N("description",o.target.value),placeholder:"Description",className:"border rounded-xl px-3 py-2 w-full",rows:3}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsxs("label",{className:"flex items-center gap-2 text-xs text-gray-600",children:[e.jsx("input",{type:"checkbox",checked:y.active,onChange:o=>N("active",o.target.checked)}),"Active"]}),e.jsxs("label",{className:"flex items-center gap-2 text-xs text-gray-600",children:[e.jsx("input",{type:"checkbox",checked:y.displayOnHome,onChange:o=>N("displayOnHome",o.target.checked)}),"Show on home"]}),e.jsx("input",{type:"number",value:y.order,onChange:o=>N("order",Number(o.target.value)||0),className:"border rounded-xl px-2 py-1 text-xs w-24",placeholder:"Order"})]})]})]})]})}function ps({collection:n,products:f,onUpdate:C}){const[_,h]=p.useState(""),[b,y]=p.useState(""),U=(n.products||[]).map(m=>typeof m=="string"?f.find(A=>A._id===m):m).filter(Boolean),N=U.map(m=>m._id),$=f.filter(m=>!N.includes(m._id)).filter(m=>{var A;return(A=m.name)==null?void 0:A.toLowerCase().includes(_.toLowerCase())});p.useEffect(()=>{h(""),y("")},[n==null?void 0:n._id]);const o=m=>{const A=N.filter(B=>B!==m);C(A)},c=()=>{if(!b)return;const m=[...N,b];C(m),y(""),h("")};return e.jsxs("div",{className:"border border-gray-100 rounded-3xl p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Linked products"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Attach items to this collection. They will appear on the homepage rail exactly in this order."}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"Add product"}),e.jsxs("div",{className:"flex flex-col gap-2 mt-2",children:[e.jsx("input",{value:_,onChange:m=>h(m.target.value),placeholder:"Search products",className:"border rounded-xl px-3 py-2 text-sm"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:b,onChange:m=>y(m.target.value),className:"border rounded-xl px-3 py-2 text-sm flex-1",children:[e.jsx("option",{value:"",children:"Choose product"}),$.slice(0,30).map(m=>e.jsx("option",{value:m._id,children:m.name},m._id))]}),e.jsx("button",{onClick:c,className:"px-4 py-2 rounded-xl bg-gray-900 text-white text-sm",children:"Add"})]}),$.length===0&&e.jsx("p",{className:"text-xs text-gray-400",children:"No more products match this search."})]})]}),e.jsxs("div",{className:"mt-6 space-y-3 max-h-[420px] overflow-y-auto pr-2",children:[U.length===0&&e.jsx("p",{className:"text-sm text-gray-400",children:"No products linked yet."}),U.map(m=>{var A;return e.jsxs("div",{className:"border border-gray-100 rounded-2xl p-3 flex items-center gap-3 bg-white",children:[e.jsx("div",{className:"w-16 h-16 rounded-xl overflow-hidden bg-gray-100 flex-shrink-0",children:e.jsx("img",{src:W((A=m.images)==null?void 0:A[0]),alt:m.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:m.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[(Je(m)||m.category)&&e.jsxs("span",{children:[Je(m)||m.category," • "]}),"Rs."," ",new Intl.NumberFormat("en-IN").format(m.discountPrice||m.price||0)]})]}),e.jsx("button",{onClick:()=>o(m._id),className:"text-xs text-gray-500",children:"Remove"})]},m._id)})]})]})}export{fs as default};
